<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Jonny">
<title>Go Lang Starter</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Go Lang Starter</h1>
<div class="details">
<span id="author" class="author">Jonny</span><br>
<span id="revdate">Saturday, 10 July, 2021</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Content</div>
<ul class="sectlevel1">
<li><a href="#_golang">1. Golang</a></li>
<li><a href="#_setup_development_environment_for_mac">2. Setup Development Environment For Mac</a>
<ul class="sectlevel2">
<li><a href="#_install_golang">2.1. Install Golang</a>
<ul class="sectlevel3">
<li><a href="#_environment_setting">2.1.1. Environment Setting</a></li>
</ul>
</li>
<li><a href="#_configure_vs_code">2.2. Configure VS CODE</a></li>
<li><a href="#_configure_intelij_ultimate">2.3. Configure InteliJ Ultimate</a></li>
</ul>
</li>
<li><a href="#_variable">3. Variable</a>
<ul class="sectlevel2">
<li><a href="#_declaration">3.1. Declaration</a></li>
<li><a href="#_redeclaration_shadowing">3.2. Redeclaration &amp; Shadowing</a></li>
<li><a href="#_visibilty">3.3. Visibilty</a></li>
<li><a href="#_naming_convention">3.4. Naming Convention</a></li>
<li><a href="#_type_conversion">3.5. Type Conversion</a></li>
</ul>
</li>
<li><a href="#_primitive_type">4. Primitive Type</a></li>
<li><a href="#_constants">5. CONSTANTS</a></li>
<li><a href="#_collections">6. Collections</a>
<ul class="sectlevel2">
<li><a href="#_array">6.1. ARRAY</a></li>
<li><a href="#_slice">6.2. SLICE</a></li>
<li><a href="#_using_make_to_create_slice">6.3. Using <strong>Make</strong> To Create Slice</a></li>
<li><a href="#_concatenate_slice">6.4. Concatenate Slice</a></li>
<li><a href="#_removing_slice">6.5. Removing Slice</a></li>
</ul>
</li>
<li><a href="#_maps_struct">7. MAPS &amp; STRUCT</a>
<ul class="sectlevel2">
<li><a href="#_maps">7.1. MAPS</a></li>
<li><a href="#_struct">7.2. Struct</a>
<ul class="sectlevel3">
<li><a href="#_embedded">7.2.1. EMBEDDED</a></li>
<li><a href="#_tags">7.2.2. TAGS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_control_flow">8. Control FLOW</a>
<ul class="sectlevel2">
<li><a href="#_if">8.1. IF</a></li>
<li><a href="#_switch">8.2. Switch</a>
<ul class="sectlevel3">
<li><a href="#_tag_less_switch">8.2.1. TAG-LESS SWITCH</a></li>
<li><a href="#_type_switch">8.2.2. TYPE SWITCH</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_looping">9. LOOPING</a>
<ul class="sectlevel2">
<li><a href="#_collection_for_loop">9.1. Collection For Loop</a></li>
</ul>
</li>
<li><a href="#_control_flow_defer_panic_and_recovery">10. Control Flow (Defer, Panic and Recovery)</a>
<ul class="sectlevel2">
<li><a href="#_defer">10.1. DEFER</a></li>
<li><a href="#_panic">10.2. Panic</a></li>
<li><a href="#_recover">10.3. Recover</a></li>
</ul>
</li>
<li><a href="#_pointer">11. Pointer</a></li>
<li><a href="#_functions">12. Functions</a>
<ul class="sectlevel2">
<li><a href="#_return_value">12.1. Return Value</a></li>
<li><a href="#_return_as_pointer">12.2. Return as Pointer</a></li>
<li><a href="#_using_named_return">12.3. Using Named return</a></li>
<li><a href="#_return_multiple_value">12.4. Return multiple value</a></li>
<li><a href="#_function_in_go_are_can_be_a_type_can_be_use_at_variable_parameters">12.5. Function in Go are can be a type, can be use at variable, parameters,</a>
<ul class="sectlevel3">
<li><a href="#_function_as_variable">12.5.1. Function as variable</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_method">13. Method</a></li>
<li><a href="#_interfaces">14. Interfaces</a>
<ul class="sectlevel2">
<li><a href="#_compose_interface_together">14.1. COMPOSE INTERFACE TOGETHER</a></li>
<li><a href="#_type_conversion_2">14.2. Type Conversion</a>
<ul class="sectlevel3">
<li><a href="#_conversion_using_empty_interface">14.2.1. Conversion using Empty Interface</a></li>
</ul>
</li>
<li><a href="#_best_practice_how_to_use_interface_in_your_go_application">14.3. BEST PRACTICE HOW TO USE INTERFACE IN YOUR GO APPLICATION</a></li>
</ul>
</li>
<li><a href="#_goroutines">15. GOROUTINES</a></li>
<li><a href="#_go_race_command">16. GO RACE COMMAND</a></li>
<li><a href="#_channels">17. CHANNELS</a>
<ul class="sectlevel2">
<li><a href="#_buffered_channels">17.1. BUFFERED CHANNELS</a></li>
</ul>
</li>
<li><a href="#_select_statement">18. SELECT STATEMENT</a></li>
<li><a href="#_go_second_tutor">19. GO SECOND TUTOR</a>
<ul class="sectlevel2">
<li><a href="#_variable_2">19.1. Variable</a></li>
<li><a href="#_struct_2">19.2. Struct</a></li>
<li><a href="#_pointer_pass_by_value">19.3. Pointer (Pass By Value)</a></li>
<li><a href="#_constant">19.4. Constant</a></li>
<li><a href="#_array_2">19.5. Array</a></li>
<li><a href="#_slices">19.6. SLICES</a></li>
<li><a href="#_slice_with_capacity_greater_than_len">19.7. SLICE WITH CAPACITY GREATER THAN LEN</a></li>
<li><a href="#_appending_slice">19.8. APPENDING SLICE</a></li>
<li><a href="#_taking_slice_of_slices">19.9. Taking Slice Of Slices</a></li>
<li><a href="#_slice_and_references">19.10. Slice and references</a></li>
<li><a href="#_string_slice">19.11. String &amp; Slice</a></li>
</ul>
</li>
<li><a href="#_maps_2">20. MAPS</a></li>
<li><a href="#_decoupling">21. DECOUPLING</a>
<ul class="sectlevel2">
<li><a href="#_when_to_use_value_semantic_when_to_use_pointer_semantic">21.1. WHEN TO USE VALUE SEMANTIC &amp; WHEN TO USE POINTER SEMANTIC</a></li>
<li><a href="#_important_semantic_show_case">21.2. @IMPORTANT SEMANTIC SHOW CASE</a>
<ul class="sectlevel3">
<li><a href="#_method_should_not_exist_by_default">21.2.1. METHOD Should not exist by default.</a></li>
</ul>
</li>
<li><a href="#_interface_polymorphism">21.3. INTERFACE (Polymorphism)</a>
<ul class="sectlevel3">
<li><a href="#_method_sets_address_of_value">21.3.1. METHOD Sets &amp; Address of Value</a></li>
<li><a href="#_storage_by_value">21.3.2. Storage by value</a></li>
</ul>
</li>
<li><a href="#_embedding">21.4. EMBEDDING</a></li>
<li><a href="#_exporting">21.5. Exporting</a></li>
<li><a href="#_composition_design_time">21.6. Composition (Design Time)</a>
<ul class="sectlevel3">
<li><a href="#_grouping_type">21.6.1. Grouping Type</a></li>
</ul>
</li>
<li><a href="#_how_composition_work_on_go">21.7. How Composition Work on GO</a></li>
<li><a href="#_design_api">21.8. Design API</a>
<ul class="sectlevel3">
<li><a href="#_practice">21.8.1. Practice</a></li>
</ul>
</li>
<li><a href="#_conversion_assertion">21.9. Conversion &amp; Assertion</a>
<ul class="sectlevel3">
<li><a href="#_interface_pollution">21.9.1. Interface Pollution</a></li>
<li><a href="#_mocking">21.9.2. Mocking</a></li>
</ul>
</li>
<li><a href="#_design_guideline">21.10. Design Guideline</a></li>
<li><a href="#_error_handling">21.11. Error Handling</a>
<ul class="sectlevel3">
<li><a href="#_default_error_values">21.11.1. Default Error Values</a></li>
<li><a href="#_error_values">21.11.2. Error Values</a></li>
<li><a href="#_type_as_context">21.11.3. Type as Context</a></li>
<li><a href="#_behavior_as_context">21.11.4. Behavior as Context</a></li>
<li><a href="#_find_a_bug">21.11.5. Find a <strong>Bug</strong></a></li>
<li><a href="#_wrapping_error">21.11.6. Wrapping Error</a></li>
</ul>
</li>
<li><a href="#_packaging">21.12. Packaging</a></li>
<li><a href="#_design_guideline_2">21.13. Design Guideline</a></li>
<li><a href="#_package_oriented_design">21.14. Package Oriented Design</a>
<ul class="sectlevel3">
<li><a href="#_kit_project">21.14.1. Kit project</a></li>
<li><a href="#_application">21.14.2. Application</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_go_routines">22. GO ROUTINES</a>
<ul class="sectlevel2">
<li><a href="#_synchronization_and_orchestration">22.1. Synchronization and Orchestration</a>
<ul class="sectlevel3">
<li><a href="#_waitgroup">22.1.1. Waitgroup</a></li>
</ul>
</li>
<li><a href="#_data_races">22.2. Data Races</a>
<ul class="sectlevel3">
<li><a href="#_cache_coherency_and_false_sharing">22.2.1. Cache Coherency and False Sharing</a></li>
<li><a href="#_synchronization_with_atomic_function">22.2.2. Synchronization with Atomic Function</a>
<ul class="sectlevel4">
<li><a href="#_solution_1_using_atomic_instruction">Solution 1 , Using atomic instruction</a></li>
<li><a href="#_solution21_using_mutex">Solution21 , Using Mutex</a></li>
<li><a href="#_readwrite_mutex">ReadWrite Mutex</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_race_detection">22.3. Race Detection</a>
<ul class="sectlevel3">
<li><a href="#_map_data_race">22.3.1. MAP DATA RACE</a></li>
<li><a href="#_interface_base_data_race">22.3.2. Interface base Data RACE</a></li>
</ul>
</li>
<li><a href="#_channel">22.4. Channel</a>
<ul class="sectlevel3">
<li><a href="#_channel_semantic_behavior">22.4.1. Channel Semantic / Behavior</a></li>
<li><a href="#_chanel_state">22.4.2. Chanel State</a></li>
<li><a href="#_basic_channel_pattern">22.4.3. Basic Channel Pattern</a>
<ul class="sectlevel4">
<li><a href="#_wait_for_task">Wait For Task</a></li>
<li><a href="#_wait_for_result">Wait For Result</a></li>
<li><a href="#_wait_for_finished">Wait For Finished</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_pooling_pattern">22.5. Pooling Pattern</a></li>
<li><a href="#_fan_out_pattern">22.6. Fan out pattern</a></li>
<li><a href="#_fan_out_pattern_fan_out_semaphore">22.7. Fan out pattern (Fan out semaphore)</a>
<ul class="sectlevel3">
<li><a href="#_drop_pattern">22.7.1. Drop Pattern</a></li>
<li><a href="#_cancellation_pattern">22.7.2. Cancellation Pattern</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_starting_concurrency">23. Starting Concurrency</a>
<ul class="sectlevel2">
<li><a href="#_context">23.1. Context</a>
<ul class="sectlevel3">
<li><a href="#_context_with_value">23.1.1. Context With Value</a>
<ul class="sectlevel4">
<li><a href="#_value_back_context">Value Back Context</a></li>
<li><a href="#_withtimeout">WithTimeOut</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_context_real_case_of_use">23.2. Context Real Case of Use</a>
<ul class="sectlevel3">
<li><a href="#_failure_detection">23.2.1. Failure Detection</a></li>
</ul>
</li>
<li><a href="#_testing">23.3. TESTING</a>
<ul class="sectlevel3">
<li><a href="#_basic_unit_test">23.3.1. Basic Unit Test</a></li>
<li><a href="#_go_test_tool">23.3.2. Go Test Tool</a></li>
<li><a href="#_table_unit_testing">23.3.3. Table Unit Testing</a></li>
<li><a href="#_mocking_2">23.3.4. Mocking</a></li>
<li><a href="#_testing_internal_endpoint">23.3.5. Testing Internal Endpoint</a></li>
</ul>
</li>
<li><a href="#_example_test">23.4. Example Test</a>
<ul class="sectlevel3">
<li><a href="#_sub_tests">23.4.1. Sub Tests</a></li>
<li><a href="#_test_subtest_run_in_paralel">23.4.2. Test subtest run in paralel</a></li>
<li><a href="#_code_coverage">23.4.3. Code Coverage</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_benchmarking">24. Benchmarking</a>
<ul class="sectlevel2">
<li><a href="#_cpu_and_memory_for_performance">24.1. CPU and Memory for performance</a></li>
<li><a href="#_create_sub_benchmark">24.2. Create Sub Benchmark</a></li>
</ul>
</li>
<li><a href="#_profiling_and_tracing">25. Profiling and Tracing</a>
<ul class="sectlevel2">
<li><a href="#_profiling_guideline">25.1. Profiling Guideline</a></li>
<li><a href="#_stack_trace">25.2. Stack Trace</a></li>
<li><a href="#_dump_the_go_routine">25.3. dump the go routine</a></li>
<li><a href="#_micro_level_optimization">25.4. Micro Level Optimization</a>
<ul class="sectlevel3">
<li><a href="#_memcpu">25.4.1. MemCpu</a></li>
</ul>
</li>
<li><a href="#_macro_level_optimization_godebug_tracing">25.5. Macro Level Optimization : GODEBUG Tracing</a>
<ul class="sectlevel3">
<li><a href="#_get_the_gc_trace_garbage_collection_trace">25.5.1. GET the GC Trace, garbage collection trace</a></li>
</ul>
</li>
<li><a href="#_macro_level_optimize_memory_performance">25.6. Macro Level Optimize memory performance</a></li>
</ul>
</li>
<li><a href="#_benchmarking_go">26. Benchmarking Go</a></li>
<li><a href="#_go_tutorial">27. GO Tutorial</a></li>
<li><a href="#_linux_less_command">28. LINUX LESS COMMAND</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-24">
<h2 id="_golang">1. Golang</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-26">
<p><span class="image"><img src="image/1.jpeg" alt="1"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-28">
<p><a href="https://golang.org">Golang</a></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-30">
<p><a href="https://play.golang.org">Golang Play Ground</a></p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-34">
<h2 id="_setup_development_environment_for_mac">2. Setup Development Environment For Mac</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-37">
<h3 id="_install_golang">2.1. Install Golang</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-40">
<p>Download the tar.gz file</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-42">
<p>Extract the downloaded file and move into /usr/local/go</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-44">
<div class="content">
<pre>sudo mkdir /usr/local/go
tar -xvf go1.16.linux-amd64.tar.gz
sudo mv go /usr/local</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-48">
<p><span class="image"><img src="image/2.jpeg" alt="2"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-50">
<p><span class="image"><img src="image/3.jpeg" alt="3"></span></p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-52">
<h4 id="_environment_setting">2.1.1. Environment Setting</h4>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-54">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-54">
<p>GOROOT</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-56">
<div class="content">
<pre>Beware setting GOROOT has been shown to cause problem as you move through differetn versions Go.
Especially if you have got multiple version of the language on your system.</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-59">
<div class="content">
<pre>you can follow this link for setup.
https://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-62">
<div class="content">
<pre>If you able to install the go instalation at its default localtion /usr/local/go</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-64">
<div class="content">
<pre>if you able to do that, then please avoid to setup any GOROOT.</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-66">
<div class="content">
<pre>We only need to setup the path variable to GOROOT bin directory.</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-68">
<div class="content">
<pre>but in case you really need to set follow this :</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-70">
<p>open your bashprofile</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-72">
<div class="content">
<pre>export GOROOT=/usr/local/go
export PATH=$PATH:$GOROOT/bin</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-75">
<p>Above we tell where is the environment is installed</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-77">
<p>We also will downloading a lot of packages while on development (this is same as .m2 folder)</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-79">
<p>GOPATH is your development project, but by setting this is kind like a monolithic development.
refer to other way to setup this, for now just use GOPATH</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-82">
<div class="content">
<pre>mkdir /Users/jonny/GOLANG/golib</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-84">
<div class="content">
<pre>export GOPATH=/Users/jonny/GOLANG/golib
export PATH=$PATH:$GOPATH/bin</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-87">
<p>to use example:</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-89">
<p>Get GO Auto Complete Code.</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-91">
<div class="content">
<pre>go get github.com/nsf/gocode</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-93">
<p>this will download the source code of library into /Users/jonny/GOLANG/golib</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-95">
<div class="content">
<pre>/Users/jonny/GOLANG/golib
ls -l</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-98">
<div class="content">
<pre>drwxr-xr-x  3 jonny  staff   96 Jul 10 14:53 bin
drwxr-xr-x  4 jonny  staff  128 Jul 10 14:52 pkg</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-101">
<p>The downloaded source code will in folder :</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-103">
<div class="content">
<pre>gocode@v0.0.0-20190302080247-5bee97b48836 jonny$ pwd</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-105">
<div class="content">
<pre>/Users/jonny/GOLANG/golib/pkg/mod/github.com/nsf/gocode@v0.0.0-20190302080247-5bee97b48836</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-107">
<div class="content">
<pre>ls -l</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-109">
<div class="content">
<pre>total 520
-r--r--r--   1 jonny  staff   1073 Jul 10 14:52 LICENSE
-r--r--r--   1 jonny  staff  10070 Jul 10 14:52 README.md
dr-xr-xr-x   3 jonny  staff     96 Jul 10 14:52 _gccgo
dr-xr-xr-x   3 jonny  staff     96 Jul 10 14:52 _goremote
dr-xr-xr-x  71 jonny  staff   2272 Jul 10 14:52 _testing
-r--r--r--   1 jonny  staff  20869 Jul 10 14:52 autocompletecontext.go
-r--r--r--   1 jonny  staff   9896 Jul 10 14:52 autocompletefile.go
-r--r--r--   1 jonny  staff   3683 Jul 10 14:52 client.go
-r--r--r--   1 jonny  staff   7807 Jul 10 14:52 config.go
-r--r--r--   1 jonny  staff  16923 Jul 10 14:52 cursorcontext.go
dr-xr-xr-x  10 jonny  staff    320 Jul 10 14:52 debian
-r--r--r--   1 jonny  staff  33687 Jul 10 14:52 decl.go
-r--r--r--   1 jonny  staff  14870 Jul 10 14:52 declcache.go
dr-xr-xr-x   4 jonny  staff    128 Jul 10 14:52 docs
dr-xr-xr-x   3 jonny  staff     96 Jul 10 14:52 emacs
dr-xr-xr-x   4 jonny  staff    128 Jul 10 14:52 emacs-company
-r--r--r--   1 jonny  staff   4905 Jul 10 14:52 formatters.go
-r--r--r--   1 jonny  staff   2369 Jul 10 14:52 gocode.go
dr-xr-xr-x   7 jonny  staff    224 Jul 10 14:52 nvim
-r--r--r--   1 jonny  staff    863 Jul 10 14:52 os_posix.go
-r--r--r--   1 jonny  staff   1331 Jul 10 14:52 os_windows.go
-r--r--r--   1 jonny  staff   5952 Jul 10 14:52 package.go
-r--r--r--   1 jonny  staff  19702 Jul 10 14:52 package_bin.go
-r--r--r--   1 jonny  staff  14906 Jul 10 14:52 package_ibin.go
-r--r--r--   1 jonny  staff  16424 Jul 10 14:52 package_text.go
-r--r--r--   1 jonny  staff    115 Jul 10 14:52 pre_go17.go
-r--r--r--   1 jonny  staff   2849 Jul 10 14:52 ripper.go
-r--r--r--   1 jonny  staff   3245 Jul 10 14:52 rpc.go
-r--r--r--   1 jonny  staff   1510 Jul 10 14:52 scope.go
-r--r--r--   1 jonny  staff   6195 Jul 10 14:52 server.go
dr-xr-xr-x   5 jonny  staff    160 Jul 10 14:52 subl3
-r--r--r--   1 jonny  staff    264 Jul 10 14:52 type_alias_build_hack_18.go
-r--r--r--   1 jonny  staff    287 Jul 10 14:52 type_alias_build_hack_19.go
-r--r--r--   1 jonny  staff   6985 Jul 10 14:52 utils.go
dr-xr-xr-x   7 jonny  staff    224 Jul 10 14:52 vim</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-146">
<p><strong>The problem with this GOPATH approach is tends to drive toward monolithic repository</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-148">
<p><strong>Which all libraries, you code will all pun into this directory.</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-150">
<p><strong>To Solve this</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-152">
<p>open the bash_profile</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-154">
<p>We need to create a compound GoPath, to separate from our code and the library we wanted to use</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-156">
<p>this is our workspace locaction</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-158">
<div class="content">
<pre>mkdir /Users/jonny/GOLANG/code/src
mkdir /Users/jonny/GOLANG/code/bin
mkdir /Users/jonny/GOLANG/code/pkg</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-162">
<div class="content">
<pre>export GOPATH=$GOPATH:/Users/jonny/GOLANG/code</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-164">
<p><strong>COMPLETE SETUP ENVI</strong></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-167">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">#GOLANG
export GOROOT=/usr/local/go
export PATH=$PATH:$GOROOT/bin

#Depedencies library
export GOPATH=/Users/jonny/GOLANG/golib
export PATH=$PATH:$GOPATH/bin

#OUR WORKSPACE, REMEMBER at code folder need to have src, bin, pkg directory
export GOPATH=$GOPATH:/Users/jonny/GOLANG/code</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-181">
<h3 id="_configure_vs_code">2.2. Configure VS CODE</h3>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-183">
<div class="content">
<pre>cd /code
code .</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-186">
<p>search plugin go by Go Team at Google</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-188">
<p>under src folder create your repository folder and the project name</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-190">
<p><span class="image"><img src="image/4.jpeg" alt="4"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-192">
<p>To RUN</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-194">
<div class="content">
<pre>go run src/github.com/jonnyGit81/gofirstapp/Main.go</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-196">
<p>To Build</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-198">
<div class="content">
<pre>go build github.com/jonnyGit81/gofirstapp</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-200">
<p>This will generated a binary file into you root project</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-202">
<p>To be able to generate in bin folder use go install instead</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-204">
<div class="content">
<pre>go install github.com/jonnyGit81/gofirstapp</pre>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-206">
<h3 id="_configure_intelij_ultimate">2.3. Configure InteliJ Ultimate</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-208">
<p>Search for plugins :</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-210">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-210">
<p>Go Language</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-211">
<p>Go Template</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-213">
<p>Install File Watchers</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-215">
<p>File Watchers is a plugin that allows you to automatically run a command when you change or save a file. This is used to run linters in the IDE.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-217">
<p><a href="https://betterprogramming.pub/how-to-improve-code-quality-with-an-automatic-check-in-go-d18a5eb85f09" class="bare">https://betterprogramming.pub/how-to-improve-code-quality-with-an-automatic-check-in-go-d18a5eb85f09</a></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-220">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-220">
<p>Enabling Go mod</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-222">
<p>At the root of the project type :</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-224">
<div class="content">
<pre>go mod init
go mod tidy</pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-228">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-228">
<p>ENABLE DEBUG</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-230">
<p><span class="image"><img src="image/5.jpeg" alt="5"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-232">
<p><span class="image"><img src="image/6.jpeg" alt="6"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-235">
<h2 id="_variable">3. Variable</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-237">
<h3 id="_declaration">3.1. Declaration</h3>

</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-239">
<h3 id="_redeclaration_shadowing">3.2. Redeclaration &amp; Shadowing</h3>

</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-241">
<h3 id="_visibilty">3.3. Visibilty</h3>

</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-243">
<h3 id="_naming_convention">3.4. Naming Convention</h3>

</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-245">
<h3 id="_type_conversion">3.5. Type Conversion</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-247">
<p>Summary</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-249">
<p><span class="image"><img src="image/7.jpeg" alt="7"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-251">
<p><span class="image"><img src="image/8.jpeg" alt="8"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-254">
<h2 id="_primitive_type">4. Primitive Type</h2>
<div class="sectionbody">
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-256">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-256">
<p>Boolean default value is false</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-258">
<div class="content">
<pre>var isOk bool = true</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-260">
<p>Numeric default value is 0</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-262">
<div class="content">
<pre>Integers</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-264">
<p><span class="image"><img src="image/9.jpeg" alt="9"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-266">
<p><span class="image"><img src="image/10.jpeg" alt="10"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-268">
<p><span class="image"><img src="image/11.jpeg" alt="11"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-270">
<p><span class="image"><img src="image/12.jpeg" alt="12"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-273">
<div class="title">bitwise</div>
<p><span class="image"><img src="image/13.jpeg" alt="13"></span></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-275">
<div class="content">
<pre>Floating Point</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-277">
<p><span class="image"><img src="image/14.jpeg" alt="14"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-279">
<p><span class="image"><img src="image/15.jpeg" alt="15"></span></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-281">
<div class="content">
<pre>Complex Numbers</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-283">
<p><span class="image"><img src="image/16.jpeg" alt="16"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-285">
<p><span class="image"><img src="image/17.jpeg" alt="17"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-288">
<p>2i = float32 + float32 or float64 + float64</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-290">
<p><span class="image"><img src="image/18.jpeg" alt="18"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-292">
<p><span class="image"><img src="image/19.jpeg" alt="19"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-294">
<p><span class="image"><img src="image/20.jpeg" alt="20"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-299">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-299">
<p>Text Type</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-301">
<p><span class="image"><img src="image/21.jpeg" alt="21"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-303">
<p><span class="image"><img src="image/22.jpeg" alt="22"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-306">
<p><span class="image"><img src="image/23.jpeg" alt="23"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-309">
<div class="title">once response a file can use as byte.</div>
<p><span class="image"><img src="image/24.jpeg" alt="24"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-311">
<p>runes is utf32</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-313">
<p><span class="image"><img src="image/25.jpeg" alt="25"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-317">
<p><span class="image"><img src="image/26.jpeg" alt="26"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-319">
<p><span class="image"><img src="image/27.jpeg" alt="27"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-321">
<p><span class="image"><img src="image/28.jpeg" alt="28"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-323">
<p><span class="image"><img src="image/29.jpeg" alt="29"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-325">
<p><span class="image"><img src="image/30.jpeg" alt="30"></span></p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-327">
<h2 id="_constants">5. CONSTANTS</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-329">
<p><span class="image"><img src="image/31.jpeg" alt="31"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-331">
<p><span class="image"><img src="image/32.jpeg" alt="32"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-334">
<div class="title">constant cannot be assigned at runtime</div>
<p><span class="image"><img src="image/33.jpeg" alt="33"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-336">
<p><span class="image"><img src="image/34.jpeg" alt="34"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-338">
<p><span class="image"><img src="image/35.jpeg" alt="35"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-340">
<p><span class="image"><img src="image/36.jpeg" alt="36"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-342">
<p>ENUMERATED CONSTANT</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-346">
<div class="title">iota is a enumerated value int start from 0</div>
<p><span class="image"><img src="image/37.jpeg" alt="37"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-349">
<div class="title">even like this compiler auto assign to iota. because is in constant block</div>
<p><span class="image"><img src="image/38.jpeg" alt="38"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-351">
<p><span class="image"><img src="image/39.jpeg" alt="39"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-354">
<div class="title">to solve</div>
<p><span class="image"><img src="image/40.jpeg" alt="40"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-356">
<p><span class="image"><img src="image/41.jpeg" alt="41"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-359">
<div class="title">use ghost variable</div>
<p><span class="image"><img src="image/42.jpeg" alt="42"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-361">
<p><span class="image"><img src="image/43.jpeg" alt="43"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-363">
<p><span class="image"><img src="image/44.jpeg" alt="44"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-365">
<p><span class="image"><img src="image/45.jpeg" alt="45"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-367">
<p><span class="image"><img src="image/46.jpeg" alt="46"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-370">
<p><strong>SEE THE POWER</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-372">
<p>BY USING BYTE TO THE ENUMERATIC</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-374">
<p>variable role is a byte</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-378">
<p><span class="image"><img src="image/47.jpeg" alt="47"></span></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-380">
<div class="content">
<pre>isAdmin =         1  // 1 x 2 ^ 0 = 1
canSeeFinancial = 4  // 1 x 2 ^ 2 = 4
canSeeErurope   = 32 // 1 x 2 ^ 5 = 32</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-384">
<div class="content">
<pre>isAdmin =         0000 0001
canSeeFinancial = 0000 0100
canSeeErurope   = 0010 0000
                  ================ |
                  0010 0101</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-390">
<div class="content">
<pre>isAdmin &amp; roles
                  0000 0001
                  0010 0101
                  ================ &amp;
                  0000 0001 = 1</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-396">
<div class="content">
<pre>isAdmin &amp; roles = isAdmin = true</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-398">
<div class="content">
<pre>canSeeFinancial &amp; roles
                  0000 0100
                  0010 0101
                  ================ &amp;
                  0000 0100 = 4</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-404">
<div class="content">
<pre>isAdmin &amp; roles = canSeeFinancial = true</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-406">
<p><span class="image"><img src="image/48.jpeg" alt="48"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-408">
<p><span class="image"><img src="image/49.jpeg" alt="49"></span></p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-410">
<h2 id="_collections">6. Collections</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-412">
<h3 id="_array">6.1. ARRAY</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-414">
<p><span class="image"><img src="image/50.jpeg" alt="50"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-416">
<p><span class="image"><img src="image/51.jpeg" alt="51"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-418">
<p>Dynamic Array</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-421">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;fmt&quot;
)



func main() {
        arr := [...]int{19, 28, 17}
        fmt.Printf(&quot;%v, %T&quot;, arr, arr)
}

[19 28 17], [3]int</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-439">
<p>EMPTY ARRAY</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-442">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;fmt&quot;
)



func main() {
        // create empty array
        var students [3]string

        students[0] = &quot;A&quot;
        students[1] = &quot;B&quot;
        students[2] = &quot;C&quot;

        fmt.Printf(&quot;%v, %T\n&quot;, students[1], students[1])
        fmt.Printf(&quot;Total Student: %v, %T\n&quot;, len(students), students)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-464">
<p>ARRAY MULTI DIMENSION</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-467">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;fmt&quot;
)



func main() {
        // Multi Dimension Array
        var matrix [3][3]int = [3][3]int { [3]int {1,0,0} , [3]int {0,1,0} , [3]int {0,0,1} }

        fmt.Printf(&quot;%v\n, %T&quot;, matrix, matrix)

}

[[1 0 0] [0 1 0] [0 0 1]], [3][3]int</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-488">
<p>ARRAY IN GO IS A BIT DIFFERENT FROM OTHER LANGUAGE</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-490">
<p>SEE AT LINE HERE THE ASSIGN TO B is not the pointer, but is a copy</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-492">
<p><strong>BE WARE OF THIS IF PASSING ARRAY TO FUNCTION, IF IS A BIG ARRAY WILL BE ISSUE, BECAUSE NEED TO CREATE THE COPY OF THE ARRAY. TO AVOID THIS PLEASE REFER TO PASSING BY REFERENCE ARRAY</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-494">
<p><span class="image"><img src="image/52.jpeg" alt="52"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-496">
<p>E.G WE ASSIGN B with the Address (<strong>&amp;</strong>) of A</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-498">
<p><span class="image"><img src="image/53.jpeg" alt="53"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-500">
<h3 id="_slice">6.2. SLICE</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-502">
<p><span class="image"><img src="image/54.jpeg" alt="54"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-504">
<p><span class="image"><img src="image/55.jpeg" alt="55"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-506">
<p><span class="image"><img src="image/56.jpeg" alt="56"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-508">
<p><span class="image"><img src="image/57.jpeg" alt="57"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-510">
<p><span class="image"><img src="image/58.jpeg" alt="58"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-512">
<p><span class="image"><img src="image/59.jpeg" alt="59"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-514">
<h3 id="_using_make_to_create_slice">6.3. Using <strong>Make</strong> To Create Slice</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-516">
<p><span class="image"><img src="image/60.jpeg" alt="60"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-518">
<p><strong>Keep In Mind For Slice</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-520">
<p>Append to a slice with syntax :</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-522">
<div class="content">
<pre>append(sourceToAppend, varags)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-524">
<div class="content">
<pre>a := []int{}</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-526">
<div class="content">
<pre>//length 0, cap = 0</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-528">
<div class="content">
<pre>a = append(a, 1)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-530">
<div class="content">
<pre>//length 1, cap = 2</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-533">
<div class="content">
<pre>a = append(a, 2, 3, 4, 5)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-535">
<div class="content">
<pre>//length 5, cap = 8</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-537">
<div class="content">
<pre>*how it does, is go will increase the capity by double the previous capacity.
after appended. this is expensive for larger data.</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-541">
<p><span class="image"><img src="image/61.jpeg" alt="61"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-543">
<p><span class="image"><img src="image/62.jpeg" alt="62"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-545">
<p><span class="image"><img src="image/63.jpeg" alt="63"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-547">
<p><span class="image"><img src="image/64.jpeg" alt="64"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-549">
<p><span class="image"><img src="image/65.jpeg" alt="65"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-552">
<h3 id="_concatenate_slice">6.4. Concatenate Slice</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-554">
<p><span class="image"><img src="image/66.jpeg" alt="66"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-556">
<h3 id="_removing_slice">6.5. Removing Slice</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-558">
<p><strong>IMPORTANT</strong></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-561">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;fmt&quot;
)



func main() {

        a := []int{1, 2, 3, 4, 5, 6}


        fmt.Printf(&quot;Slice A, Before Operation = %v , Length: %v , Capacity : %v\n&quot;, a, len(a), cap(a))

        b := a[1:]

        fmt.Printf(&quot;Slice B, Removed 1 = %v , Length: %v , Capacity : %v\n&quot;, b, len(b), cap(b))

        fmt.Printf(&quot;Slice A, After Operation B = %v , Length: %v , Capacity : %v\n&quot;, a, len(a), cap(a))


        fmt.Printf(&quot;Slice A, Before Operation = %v , Length: %v , Capacity : %v\n&quot;, a, len(a), cap(a))

        c := a[:len(a)-1]

        fmt.Printf(&quot;Slice C, Removed 6 = %v , Length: %v , Capacity : %v\n&quot;, c, len(c), cap(c))

        fmt.Printf(&quot;Slice A, After Operation C = %v , Length: %v , Capacity : %v\n&quot;, a, len(a), cap(a))


        fmt.Printf(&quot;\nBE AWARE \n\n&quot;)


        fmt.Printf(&quot;Slice A, Before Operation = %v , Length: %v , Capacity : %v\n&quot;, a, len(a), cap(a))

        d := append(a[:2], a[3:]...) // remove 3 (index = 2)


        fmt.Printf(&quot;Removed 3 at index 2 %v , Length: %v , Capacity : %v\n&quot;, d, len(d), cap(d))

        //&gt;&gt;Beware a is modified as well since slice is referenced

        fmt.Printf(&quot;&gt;&gt;&gt;&gt; Slice A, After Operation D = %v , Length: %v , Capacity : %v\n&quot;, a, len(a), cap(a))

}


Slice A, Before Operation = [1 2 3 4 5 6] , Length: 6 , Capacity : 6
Slice B, Removed 1 = [2 3 4 5 6] , Length: 5 , Capacity : 5
Slice A, After Operation B = [1 2 3 4 5 6] , Length: 6 , Capacity : 6
Slice A, Before Operation = [1 2 3 4 5 6] , Length: 6 , Capacity : 6
Slice C, Removed 6 = [1 2 3 4 5] , Length: 5 , Capacity : 6
Slice A, After Operation C = [1 2 3 4 5 6] , Length: 6 , Capacity : 6

BE AWARE

Slice A, Before Operation = [1 2 3 4 5 6] , Length: 6 , Capacity : 6
Removed 3 at index 2 [1 2 4 5 6] , Length: 5 , Capacity : 6
&gt;&gt;&gt;&gt; Slice A, After Operation D = [1 2 4 5 6 6] , Length: 6 , Capacity : 6

MAKE SURE  Slice &quot;a&quot; is not used to any other referenced place.</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-626">
<p><span class="image"><img src="image/67.jpeg" alt="67"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-628">
<p><span class="image"><img src="image/68.jpeg" alt="68"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-630">
<h2 id="_maps_struct">7. MAPS &amp; STRUCT</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-632">
<p><span class="image"><img src="image/69.jpeg" alt="69"></span></p>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-634">
<h3 id="_maps">7.1. MAPS</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-636">
<p><span class="image"><img src="image/70.jpeg" alt="70"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-638">
<p><span class="image"><img src="image/71.jpeg" alt="71"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-640">
<p><span class="image"><img src="image/72.jpeg" alt="72"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-642">
<p><span class="image"><img src="image/73.jpeg" alt="73"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-644">
<p><span class="image"><img src="image/74.jpeg" alt="74"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-646">
<p><span class="image"><img src="image/75.jpeg" alt="75"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-648">
<p><span class="image"><img src="image/76.jpeg" alt="76"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-650">
<p>To Prevent Above. Check using 2nd parameter</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-652">
<p><span class="image"><img src="image/77.jpeg" alt="77"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-654">
<p><span class="image"><img src="image/78.jpeg" alt="78"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-656">
<p><strong>REMEMBER Map is passing by reference / same as slice</strong></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-659">
<h3 id="_struct">7.2. Struct</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-661">
<p><span class="image"><img src="image/79.jpeg" alt="79"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-663">
<p><span class="image"><img src="image/80.jpeg" alt="80"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-666">
<p><strong>Anonymous Struct</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-668">
<p><span class="image"><img src="image/81.jpeg" alt="81"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-671">
<p><strong>REMEMBER STRUCT IS COPIED BY VALUE WHEN ASSIGN, LIKE ARRAY</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-673">
<p><span class="image"><img src="image/82.jpeg" alt="82"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-675">
<p>To be able as a reference, then when assign need to use the address just like array</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-677">
<p><span class="image"><img src="image/83.jpeg" alt="83"></span></p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-679">
<h4 id="_embedded">7.2.1. EMBEDDED</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-681">
<p>GO Doesn&#8217;t have inheritance. this is to replace inheritance.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-683">
<p>Go prefer composition.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-685">
<p><span class="image"><img src="image/84.jpeg" alt="84"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-687">
<p><span class="image"><img src="image/85.jpeg" alt="85"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-689">
<p><span class="image"><img src="image/86.jpeg" alt="86"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-691">
<p><span class="image"><img src="image/87.jpeg" alt="87"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-693">
<p><span class="image"><img src="image/88.jpeg" alt="88"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-695">
<p><strong>So When is Best place to use Embedding?</strong></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-697">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-697">
<p>If it is modeling behaviour, embedding is not a right choice to use.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-699">
<p>Generally is better to use interfaces if is common behaviour.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-701">
<p>So the one of embedding good idea is :</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-703">
<p>Example you have develop a web application with Base Controller.
then you might want to the consumer of your library to embedded that
Base Controller into the Custom Controller so it can get use full functionality
out of it, which not any polymorphism and not any ability to interchangeable object.
you just get some basic behaviour into the custom controller.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-710">
<h4 id="_tags">7.2.2. TAGS</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-712">
<p><span class="image"><img src="image/89.jpeg" alt="89"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-714">
<p><span class="image"><img src="image/90.jpeg" alt="90"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-716">
<p><span class="image"><img src="image/91.jpeg" alt="91"></span></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-719">
<h2 id="_control_flow">8. Control FLOW</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-721">
<p><span class="image"><img src="image/92.jpeg" alt="92"></span></p>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-723">
<h3 id="_if">8.1. IF</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-725">
<p><span class="image"><img src="image/93.jpeg" alt="93"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-728">
<div class="title">number compare operator</div>
<p><span class="image"><img src="image/94.jpeg" alt="94"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-730">
<p><strong>BEWARE OF COMPARING FLOATING POINT / DECIMAL</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-732">
<p><span class="image"><img src="image/95.jpeg" alt="95"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-734">
<p><span class="image"><img src="image/96.jpeg" alt="96"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-736">
<p>To Resolve :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-738">
<p><span class="image"><img src="image/97.jpeg" alt="97"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-741">
<h3 id="_switch">8.2. Switch</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-743">
<p><span class="image"><img src="image/98.jpeg" alt="98"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-745">
<p><span class="image"><img src="image/99.jpeg" alt="99"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-747">
<p><span class="image"><img src="image/100.jpeg" alt="100"></span></p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-749">
<h4 id="_tag_less_switch">8.2.1. TAG-LESS SWITCH</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-751">
<p>The power of this can have overlap, &#8656;10 and &#8656;20
<span class="image"><img src="image/101.jpeg" alt="101"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-754">
<p>Beware of using fallthrough</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-756">
<p><span class="image"><img src="image/102.jpeg" alt="102"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-758">
<p><span class="image"><img src="image/103.jpeg" alt="103"></span></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-760">
<h4 id="_type_switch">8.2.2. TYPE SWITCH</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-762">
<p><span class="image"><img src="image/104.jpeg" alt="104"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-764">
<p><span class="image"><img src="image/105.jpeg" alt="105"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-767">
<p><strong>be careful OF ARRAY</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-769">
<p><span class="image"><img src="image/106.jpeg" alt="106"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-772">
<p><span class="image"><img src="image/107.jpeg" alt="107"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-774">
<p><span class="image"><img src="image/108.jpeg" alt="108"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-776">
<p><span class="image"><img src="image/109.jpeg" alt="109"></span></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-779">
<h2 id="_looping">9. LOOPING</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-781">
<p><span class="image"><img src="image/110.jpeg" alt="110"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-784">
<div class="title">basic</div>
<p><span class="image"><img src="image/111.jpeg" alt="111"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-786">
<p><span class="image"><img src="image/112.jpeg" alt="112"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-789">
<p><span class="image"><img src="image/113.jpeg" alt="113"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-791">
<p><span class="image"><img src="image/114.jpeg" alt="114"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-793">
<p><span class="image"><img src="image/115.jpeg" alt="115"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-795">
<p><span class="image"><img src="image/116.jpeg" alt="116"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-797">
<p><span class="image"><img src="image/117.jpeg" alt="117"></span></p>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-799">
<h3 id="_collection_for_loop">9.1. Collection For Loop</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-801">
<p><span class="image"><img src="image/118.jpeg" alt="118"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-803">
<p><span class="image"><img src="image/119.jpeg" alt="119"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-805">
<p><span class="image"><img src="image/120.jpeg" alt="120"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-807">
<p><span class="image"><img src="image/121.jpeg" alt="121"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-809">
<p><span class="image"><img src="image/122.jpeg" alt="122"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-812">
<h2 id="_control_flow_defer_panic_and_recovery">10. Control Flow (Defer, Panic and Recovery)</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-814">
<h3 id="_defer">10.1. DEFER</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-816">
<p>Invoke a function but delay some execution for some future point on time</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-818">
<p><span class="image"><img src="image/123.jpeg" alt="123"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-820">
<p><span class="image"><img src="image/124.jpeg" alt="124"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-823">
<p><strong>USE CASE CLOSE RESOURCE</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-825">
<p><strong>FROM</strong>
<span class="image"><img src="image/125.jpeg" alt="125"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-828">
<p><strong>TO</strong>
<span class="image"><img src="image/126.jpeg" alt="126"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-832">
<p><strong>BEWARE OF THIS</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-834">
<p>Defer is get the var at the time you use defer keyword.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-836">
<p><span class="image"><img src="image/127.jpeg" alt="127"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-838">
<h3 id="_panic">10.2. Panic</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-840">
<p>Go Application can have a state to no longer to run and how go runtime can trigger that
and how we can triggered that on our own.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-844">
<p><strong>IN GO DOESN&#8217;T HAVE EXCEPTION</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-846">
<p>GO use the term is <strong>PANIC</strong> for any error cannot continue the function</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-848">
<p><span class="image"><img src="image/128.jpeg" alt="128"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-850">
<p><span class="image"><img src="image/129.jpeg" alt="129"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-853">
<p><span class="image"><img src="image/130.jpeg" alt="130"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-855">
<p><span class="image"><img src="image/130_1.jpeg" alt="130 1"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-857">
<p><span class="image"><img src="image/131.jpeg" alt="131"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-860">
<p><strong>IMPORTANT</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-862">
<p>Panic is executed after defer.
because any defer need to finished first before panic</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-865">
<p><span class="image"><img src="image/132.jpeg" alt="132"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-867">
<p><span class="image"><img src="image/133.jpeg" alt="133"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-869">
<h3 id="_recover">10.3. Recover</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-871">
<p>If application enter to panic, ideally you have some way to save the program
so it doesn&#8217;t fail out completely.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-874">
<p><span class="image"><img src="image/134_0.jpeg" alt="134 0"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-876">
<p>We Doing Recover using anonymous function</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-879">
<p><span class="image"><img src="image/134.jpeg" alt="134"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-881">
<p><span class="image"><img src="image/135.jpeg" alt="135"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-883">
<p><span class="image"><img src="image/136.jpeg" alt="136"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-885">
<p><span class="image"><img src="image/137.jpeg" alt="137"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-887">
<p><span class="image"><img src="image/138.jpeg" alt="138"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-889">
<p><span class="image"><img src="image/139.jpeg" alt="139"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-892">
<h2 id="_pointer">11. Pointer</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-894">
<p><span class="image"><img src="image/140.jpeg" alt="140"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-896">
<p><span class="image"><img src="image/141.jpeg" alt="141"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-899">
<div class="title">b is become address of a (not the value)</div>
<p><span class="image"><img src="image/142.jpeg" alt="142"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-901">
<p><span class="image"><img src="image/143.jpeg" alt="143"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-903">
<p><span class="image"><img src="image/144.jpeg" alt="144"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-906">
<p><span class="image"><img src="image/145.jpeg" alt="145"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-908">
<p><span class="image"><img src="image/146.jpeg" alt="146"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-910">
<p><span class="image"><img src="image/147.jpeg" alt="147"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-913">
<p><span class="image"><img src="image/148.jpeg" alt="148"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-915">
<p><span class="image"><img src="image/149.jpeg" alt="149"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-917">
<p><span class="image"><img src="image/150.jpeg" alt="150"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-919">
<p><span class="image"><img src="image/151.jpeg" alt="151"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-921">
<p><span class="image"><img src="image/152.jpeg" alt="152"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-923">
<p><span class="image"><img src="image/153.jpeg" alt="153"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-925">
<p><span class="image"><img src="image/154.jpeg" alt="154"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-927">
<p><span class="image"><img src="image/155.jpeg" alt="155"></span></p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-931">
<h2 id="_functions">12. Functions</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-933">
<p><span class="image"><img src="image/156.jpeg" alt="156"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-935">
<p><span class="image"><img src="image/157.jpeg" alt="157"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-937">
<p><span class="image"><img src="image/158.jpeg" alt="158"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-939">
<p><span class="image"><img src="image/159.jpeg" alt="159"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-942">
<p><span class="image"><img src="image/160.jpeg" alt="160"></span></p>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-945">
<h3 id="_return_value">12.1. Return Value</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-947">
<p><span class="image"><img src="image/161.jpeg" alt="161"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-950">
<h3 id="_return_as_pointer">12.2. Return as Pointer</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-952">
<p><span class="image"><img src="image/162.jpeg" alt="162"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-955">
<h3 id="_using_named_return">12.3. Using Named return</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-957">
<p><span class="image"><img src="image/163.jpeg" alt="163"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-959">
<h3 id="_return_multiple_value">12.4. Return multiple value</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-961">
<p><span class="image"><img src="image/164.jpeg" alt="164"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-963">
<p><span class="image"><img src="image/165.jpeg" alt="165"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-966">
<h3 id="_function_in_go_are_can_be_a_type_can_be_use_at_variable_parameters">12.5. Function in Go are can be a type, can be use at variable, parameters,</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-969">
<div class="title">Anonymous Function</div>
<p><span class="image"><img src="image/166.jpeg" alt="166"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-971">
<p><span class="image"><img src="image/168.jpeg" alt="168"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-973">
<p>to fixed this we make sure to pass in the i into the anynomous func</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-975">
<p><span class="image"><img src="image/169.jpeg" alt="169"></span></p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-978">
<h4 id="_function_as_variable">12.5.1. Function as variable</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-981">
<p><span class="image"><img src="image/170.jpeg" alt="170"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-985">
<div class="title">verbose declaration, the type is func()</div>
<p><span class="image"><img src="image/171.jpeg" alt="171"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-989">
<div class="title">the func definition type is without parameter name, we only need to specified the type of parameters.</div>
<p><span class="image"><img src="image/172.jpeg" alt="172"></span></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-992">
<h2 id="_method">13. Method</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-994">
<p><strong>Method In GO</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-996">
<p>We call the method just like we called a single field, but need parenthesis field() and we can pass in parameters</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-998">
<p>Method is basically is a function and executed in unknown context,</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1000">
<p>what mean of unknown context in go is any type.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1002">
<p>u can use struct to create method, or any type, example :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1004">
<p>type counter int &#8594; we can add method into counter type.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1006">
<p>when we create the method we accessing the type in the function</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1008">
<p>Example Method with Non-Struct Type Receiver :</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1011">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">// Go program to illustrate the method
// with non-struct type receiver
package main

import &quot;fmt&quot;

// Type definition
type data int

// Defining a method with
// non-struct type receiver
func (d1 data) multiply(d2 data) data {
    return d1 * d2
}

/*
// if you try to run this code,
// then compiler will throw an error
func(d1 int)multiply(d2 int)int{
return d1 * d2
}
*/

// Main function
func main() {
    value1 := data(23)
    value2 := data(20)
    res := value1.multiply(value2)
    fmt.Println(&quot;Final result: &quot;, res)
}
Output:

Final result:  460</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1047">
<p><span class="image"><img src="image/173.jpeg" alt="173"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1049">
<p><span class="image"><img src="image/174.jpeg" alt="174"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1051">
<p><span class="image"><img src="image/175.jpeg" alt="175"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1054">
<p><span class="image"><img src="image/176.jpeg" alt="176"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1056">
<p><span class="image"><img src="image/177.jpeg" alt="177"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1059">
<p><strong>Difference Between Method and Function</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1061">
<p><strong>Method</strong></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1063">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1063">
<p>It contain receiver.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1064">
<p>It can accept both pointer and value.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1066">
<p>Methods of the same name
but different types can be defined
in the program.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1070">
<p><strong>Function</strong></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1072">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1072">
<p>It does not contain receiver.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1074">
<p>It cannot accept both pointer and value.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1076">
<p>Functions of the same name but different type are not
allowed to define in the program.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1079">
<p><span class="image"><img src="image/178.jpeg" alt="178"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1081">
<p><span class="image"><img src="image/179.jpeg" alt="179"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1083">
<p><span class="image"><img src="image/180.jpeg" alt="180"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1085">
<p><span class="image"><img src="image/181.jpeg" alt="181"></span></p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1088">
<h2 id="_interfaces">14. Interfaces</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1090">
<p><span class="image"><img src="image/182.jpeg" alt="182"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1092">
<p><span class="image"><img src="image/183.jpeg" alt="183"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1094">
<p><span class="image"><img src="image/184.jpeg" alt="184"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1098">
<p>Interface is powerful.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1100">
<p>We can create an interface and implement a concrete class</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1102">
<p>or other way arround. why not?</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1104">
<p>Example :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1106">
<p>in go package database sql / all package is a concrete class.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1108">
<p>then how we can test ? without need a database?</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1110">
<p>The way we can test without a db is create an interface that
replicate the concrete class method signature and the db object from sql package
will automatically implement it.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1114">
<p>so you don&#8217;t have to worried about creating interface at design time,
if we don&#8217;t need by our-self because consumer of who using our library
can create interface by them self later, and this interface can be shape
exactly what they need for their application</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1120">
<p>normal naming convention interface in go</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1123">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">func main() {
    var w Writer =  ConsoleWriter{}
    w.Write(&quot;Hello Go!&quot;)
}
type Writer interface {
    Write([]byte) (int, error)
}

type ConsoleWriter struct {}

Writer(cw ConsoleWriter) Write(data []byte)(int, error) {
 n, err := fmt.Println(string(data))
 return n, err
}

Naming convention method interface Write then interface name is Writer</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1145">
<p>INTERFACE no need to be always struct, it can be any type</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1148">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;fmt&quot;
)

/**
int is cannot be modified, but we can create an interface
and adding a method to it.
**/
func main() {
        myInt := IntCounter(0) //casting int 0 to IntCounter type

        var inc Incrementer = &amp;myInt

        for i := 0; i &lt;= 10; i++ {
                fmt.Println(inc.Increment())
                fmt.Println(myInt)
        }
}

type Incrementer interface {
        Increment() int
}

type IntCounter int

func (iCtr *IntCounter) Increment() int {

        // remember this
        // var a int = 10
        // var b *int = &amp;a
        // *b++

        *iCtr++
        return int(*iCtr)

}</code></pre>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1190">
<h3 id="_compose_interface_together">14.1. COMPOSE INTERFACE TOGETHER</h3>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1194">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;bytes&quot;
        &quot;fmt&quot;
)

func main() {
 var wc WriterCloser = NewBufferedWriterCloser()
 wc.Write([]byte(&quot;Hello Youtube Listeners, this is a test&quot;))
 wc.Close()
}

type Writer interface {
        Write([]byte) (int, error)
}

type Closer interface {
        Close() error
}

//compose interface
type WriterCloser interface {
        Writer
        Closer
}

type BufferWriterCloser struct {
        buffer *bytes.Buffer
}

func (bwc BufferWriterCloser) Write(data []byte)  (int, error) {
        n, err := bwc.buffer.Write(data)
        if err != nil {
                return 0, err
        }

        v := make([]byte, 8)
        for bwc.buffer.Len() &gt; 8 {
                _, err := bwc.buffer.Read(v)
                if err != nil {
                        return 0, err
                }
                _, err = fmt.Println(string(v))
                if err != nil {
                        return 0, err
                }
        }
        return n, nil
}

func (bwc BufferWriterCloser) Close() error {
        for bwc.buffer.Len() &gt; 0 {
                data := bwc.buffer.Next(8)
                _, err := fmt.Println(string(data))
                if err != nil {
                        return err
                }
        }
        return nil
}

// constructor
func NewBufferedWriterCloser() *BufferWriterCloser {
        return &amp;BufferWriterCloser{
                buffer: bytes.NewBuffer([]byte{}),
        }
}</code></pre>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1266">
<h3 id="_type_conversion_2">14.2. Type Conversion</h3>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1269">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;bytes&quot;
        &quot;fmt&quot;
)

func main() {
        var wc WriterCloser = NewBufferedWriterCloser()
        wc.Write([]byte(&quot;Hello Youtube Listeners, this is a test&quot;))
        wc.Close()

        // Type conversion
        // w := wc.(*Writer) Writer does not implement WriterCloser
        bwc := wc.(*BufferWriterCloser)
        bwc.Write([]byte(&quot;abcdeefghij&quot;))
        //fmt.Println(bwc.buffer)
        bwc.Close()

}

type Writer interface {
        Write([]byte) (int, error)
}

type Closer interface {
        Close() error
}

type WriterCloser interface {
        Writer
        Closer
}

type BufferWriterCloser struct {
        buffer *bytes.Buffer
}

func (bwc *BufferWriterCloser) Write(data []byte)  (int, error) {
        n, err := bwc.buffer.Write(data)
        if err != nil {
                return 0, err
        }

        v := make([]byte, 8)
        for bwc.buffer.Len() &gt; 8 {
                _, err := bwc.buffer.Read(v)
                if err != nil {
                        return 0, err
                }
                _, err = fmt.Println(string(v))
                if err != nil {
                        return 0, err
                }
        }
        return n, nil
}

func (bwc *BufferWriterCloser) Close() error {
        for bwc.buffer.Len() &gt; 0 {
                data := bwc.buffer.Next(8)
                _, err := fmt.Println(string(data))
                if err != nil {
                        return err
                }
        }
        return nil
}

// constructor
func NewBufferedWriterCloser() *BufferWriterCloser {
        return &amp;BufferWriterCloser{
                buffer: bytes.NewBuffer([]byte{}),
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1349">
<p><span class="image"><img src="image/185.jpeg" alt="185"></span></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1354">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;bytes&quot;
        &quot;fmt&quot;
)

func main() {
        var wc WriterCloser = NewBufferedWriterCloser()
        wc.Write([]byte(&quot;Hello Youtube Listeners, this is a test&quot;))
        wc.Close()

        // Type conversion
        // w := wc.(*Writer) Writer does not implement WriterCloser
        bwc := wc.(*BufferWriterCloser) // BufferWriterCloser is struct
        bwc.buffer.Write([]byte(&quot;write text from BufferWriterCloser directly into buffer field&quot;))
        fmt.Println(bwc.buffer)
        bwc.Close()

}

type Writer interface {
        Write([]byte) (int, error)
}

type Closer interface {
        Close() error
}

type WriterCloser interface {
        Writer
        Closer
}

type BufferWriterCloser struct {
        buffer *bytes.Buffer
}

func (bwc *BufferWriterCloser) Write(data []byte)  (int, error) {
        n, err := bwc.buffer.Write(data)
        if err != nil {
                return 0, err
        }

        v := make([]byte, 8)
        for bwc.buffer.Len() &gt; 8 {
                _, err := bwc.buffer.Read(v)
                if err != nil {
                        return 0, err
                }
                _, err = fmt.Println(string(v))
                if err != nil {
                        return 0, err
                }
        }
        return n, nil
}

func (bwc *BufferWriterCloser) Close() error {
        for bwc.buffer.Len() &gt; 0 {
                data := bwc.buffer.Next(8)
                _, err := fmt.Println(string(data))
                if err != nil {
                        return err
                }
        }
        return nil
}

// constructor
func NewBufferedWriterCloser() *BufferWriterCloser {
        return &amp;BufferWriterCloser{
                buffer: bytes.NewBuffer([]byte{}),
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1433">
<p><span class="image"><img src="image/186.jpeg" alt="186"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1436">
<div class="title">using this way, si the app doesn&#8217;t crash</div>
<p><span class="image"><img src="image/187.jpeg" alt="187"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1439">
<p><span class="image"><img src="image/188.jpeg" alt="188"></span></p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1442">
<h4 id="_conversion_using_empty_interface">14.2.1. Conversion using Empty Interface</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1445">
<p><span class="image"><img src="image/189.jpeg" alt="189"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1447">
<p>The Empty interface is very common,
but keep in mind it almost in intermediate state,
you need to define a variable of type empty interface
and you have to figure it out exactly what you receive
before you can do something useful with it</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1454">
<p><span class="image"><img src="image/190.jpeg" alt="190"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1458">
<p>Thing to Remember.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1460">
<p>When we define type and we assign method to them each one of those
type have to has called method set</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1463">
<p>When you working with the type directly the method set is all the method
regardless is receiver type assossiated with that type <strong>THIS IS TYPE, NOT INTERFACE</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1466">
<p>With Interfaces however things change a little bit,
when implementing an interface with the concrete value</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1469">
<div class="content">
<pre>// WriterCloser is interface
// myWriterCloser struct</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1472">
<div class="content">
<pre>var wc WriterCloser = myWriterCloser{}</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1474">
<p>so at here wc is holding value of myWriterCloser.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1476">
<p>when you use method set for value using pointer</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1478">
<div class="content">
<pre>func (wc *myWriterCloser) Write(data []byte) (int, error) {
       return 0, nil
}</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1482">
<p>this will not gonna work, because your use value at</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1484">
<div class="content">
<pre>var wc WriterCloser = myWriterCloser{}</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1486">
<p>and the set method is pointer</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1488">
<div class="content">
<pre>func (wc *myWriterCloser) Write(data []byte) (int, error) {
       return 0, nil
}</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1492">
<p>unless you use address on</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1494">
<div class="content">
<pre>var wc WriterCloser = &amp;myWriterCloser{}</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1497">
<p>Conclusion</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1499">
<div class="content">
<pre>IF I IMPLEMENTED INTERFACE USING VALUE TYPE THEN ALL SET METHOD RECEIVER MUST BE VALUE TYPE</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1501">
<div class="content">
<pre>IF I IMPLEMENTED INTERFACE USING POINTER THEN THE SET METHOD RECEIVER IS CAN BE WHAT EVER /
REGARDLESS IS A POINTER TYPE OR A VALUE TYPE,</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1504">
<div class="content">
<pre>IF I IMPLEMENTED INTERFACE USING POINTER,
THE METHOD SET FOR VALUE TYPE RECEIVER IS THE SET METHOD OF VALUE RECEIVER</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1507">
<div class="content">
<pre>BUT THE METHOD SET FOR POINTER TYPE IS ALL THE METHOD HAS VALUE RECEIVER AND ALL METHOD
HAVE POINTER RECEIVER</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1510">
<p>you can use :</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1512">
<div class="content">
<pre>var wc WriterCloser = &amp;myWriterCloser{}</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1514">
<div class="content">
<pre>func (wc myWriterCloser) Write(data []byte) (int, error) {
       return 0, nil
}</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1518">
<div class="content">
<pre>func (wc myWriterCloser) Close() (error) {
       return nil
}</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1522">
<p>This important at the above method is value</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1524">
<div class="content">
<pre>var wc WriterCloser = &amp;myWriterCloser{}</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1526">
<div class="content">
<pre>func (wc *myWriterCloser) Write(data []byte) (int, error) {
       return 0, nil
}</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1530">
<div class="content">
<pre>func (wc myWriterCloser) Close() (error) {
       return nil
}</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1534">
<p>then above the Write method receiver is pointer. close is a value.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1536">
<p>THIS IS IMPORTANT CONCEPT</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1538">
<h3 id="_best_practice_how_to_use_interface_in_your_go_application">14.3. BEST PRACTICE HOW TO USE INTERFACE IN YOUR GO APPLICATION</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1540">
<p><span class="image"><img src="image/191.jpeg" alt="191"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1545">
<div class="title">YOUR Interface don&#8217;t need to have all method from db object, you only need method that u used for testing mockup</div>
<p><span class="image"><img src="image/192.jpeg" alt="192"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1549">
<p><span class="image"><img src="image/193.jpeg" alt="193"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1551">
<p>Do Export interface for type your will be using.
so you gonna pull value in go head and accepting interface instead of concrete type if all posibble</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1554">
<p>so this is kindly backawrd from Java or C#</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1556">
<p>because GO is implicit implement interface / interface can create later.
other languaage is explicit interface.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1560">
<p><span class="image"><img src="image/194.jpeg" alt="194"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1562">
<p>if your creating a library that other ppl are gonna consume.
you can define the interfaces that you accept, and they can provide
what ever implementation they want and if your library have reasonable default
then you can export those concrete type as well but make sure you can accept the
interface whenever possible.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1568">
<p><strong>SUMMARY</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1570">
<p><span class="image"><img src="image/195.jpeg" alt="195"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1572">
<p><span class="image"><img src="image/196.jpeg" alt="196"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1574">
<p><span class="image"><img src="image/197.jpeg" alt="197"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1576">
<p><span class="image"><img src="image/198.jpeg" alt="198"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1578">
<p><span class="image"><img src="image/199.jpeg" alt="199"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1580">
<p><span class="image"><img src="image/200.jpeg" alt="200"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1585">
<h2 id="_goroutines">15. GOROUTINES</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1587">
<p><span class="image"><img src="image/201.jpeg" alt="201"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1589">
<p><span class="image"><img src="image/202.jpeg" alt="202"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1591">
<p><span class="image"><img src="image/203.jpeg" alt="203"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1593">
<p><span class="image"><img src="image/204.jpeg" alt="204"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1595">
<p><span class="image"><img src="image/205.jpeg" alt="205"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1598">
<div class="title"><strong>REMEMBER</strong> The number is to tell how many go routines you created.</div>
<p><span class="image"><img src="image/206.jpeg" alt="206"></span></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1603">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;fmt&quot;
        &quot;runtime&quot;
        &quot;sync&quot;
)

var wg = sync.WaitGroup{}

var counter = 0

var rwm = sync.RWMutex{} // what is this? Read Write Mutex


//Simple Mutex is to lock and unlock resource, which mean only one thread allow to access the resource (in he is the counter)

//RWMutex -&gt; allow other thread to read together, but if a write request come in, it need to wait
//           after all read thread finish, then write acquire the lock and no any thread can access to the resource


 // HOW TO MAKE SYNC THREAD THAT DEPEND ON OTHER THREAD.
func main() {
        runtime.GOMAXPROCS(100)
        for i := 0; i&lt;10; i++ {

                wg.Add(2)

                rwm.RLock() // we do read lock outside the go routine
                go printCounter()

                rwm.Lock() // we lock outside the go routine
                go incrementCounter()

        }

        // WHAT WE GET ABOVE IS WORSE, it tend to be single thread and even worse perfomance, because we tend to locking and
        // unlocking it. above is only a brief of go routine and mutex

        wg.Wait()

        fmt.Println(&quot;End of Main Thread&quot;)
}

func printCounter()  {
        fmt.Println(&quot;Print Counter which value is incremented from others go routine&quot;, counter)
        rwm.RUnlock() // we release read lock inside the go routine
        wg.Done()
}

func incrementCounter()  {
        counter++
        rwm.Unlock() // we release the lock inside the go routine
        wg.Done()
}


Print Counter which value is incremented from others go routine 0
Print Counter which value is incremented from others go routine 1
Print Counter which value is incremented from others go routine 2
Print Counter which value is incremented from others go routine 3
Print Counter which value is incremented from others go routine 4
Print Counter which value is incremented from others go routine 5
Print Counter which value is incremented from others go routine 6
Print Counter which value is incremented from others go routine 7
Print Counter which value is incremented from others go routine 8
Print Counter which value is incremented from others go routine 9
End of Main Thread</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1675">
<p><strong>What is runtime.GOMAXPROCS(100)</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1679">
<p><span class="image"><img src="image/207.jpeg" alt="207"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1682">
<div class="title">-1 will not change what value previously set</div>
<p><span class="image"><img src="image/208.jpeg" alt="208"></span></p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1684">
<h2 id="_go_race_command">16. GO RACE COMMAND</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1686">
<p><strong>THIS IS IMPORTANT COMMAND WHEN YOU HAVE GO ROUTINE ON YOUR CODE</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1688">
<p><strong>IS TO CHECK HOW YOUR GO ROUTINE RUN AND EASY TO FIND BUGS BEFORE GOING TO PRODUCTION</strong></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1691">
<div class="content">
<pre>go run -race main.go</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1694">
<p><span class="image"><img src="image/209.jpeg" alt="209"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1696">
<p><span class="image"><img src="image/210.jpeg" alt="210"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1698">
<p><span class="image"><img src="image/211.jpeg" alt="211"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1700">
<p><span class="image"><img src="image/212.jpeg" alt="212"></span></p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1704">
<h2 id="_channels">17. CHANNELS</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1706">
<p><span class="image"><img src="image/213.jpeg" alt="213"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1708">
<p><span class="image"><img src="image/214.jpeg" alt="214"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1710">
<p><span class="image"><img src="image/215.jpeg" alt="215"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1712">
<p><span class="image"><img src="image/216.jpeg" alt="216"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1714">
<p><span class="image"><img src="image/217.jpeg" alt="217"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1716">
<p><span class="image"><img src="image/218.jpeg" alt="218"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1718">
<p><span class="image"><img src="image/219.jpeg" alt="219"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1720">
<p><span class="image"><img src="image/220.jpeg" alt="220"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1722">
<p><span class="image"><img src="image/221.jpeg" alt="221"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1725">
<div class="title">resolve previous error to change 1 receiver and 1 sender</div>
<p><span class="image"><img src="image/222.jpeg" alt="222"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1727">
<p>Above so we know the data flow</p>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1729">
<h3 id="_buffered_channels">17.1. BUFFERED CHANNELS</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1731">
<p><span class="image"><img src="image/223.jpeg" alt="223"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1733">
<p><span class="image"><img src="image/224.jpeg" alt="224"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1735">
<p>TO SOLVE WE CAN PUT A BUFFER</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1737">
<p><span class="image"><img src="image/225.jpeg" alt="225"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1739">
<p><span class="image"><img src="image/226.jpeg" alt="226"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1741">
<p>this is not the buffer for, is for example.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1743">
<p><strong>YOU NEED BUFFER WHEN YOUR RECEIVER TAKE TIME TO PROCESS
THEN THERE IS A SPACE FOR PRODUCER KEEP SENDING.</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1746">
<p><strong>ABOVE IS NOT A RIGHT WAY TO HANDLE THIS SITUATION</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1748">
<p><strong>THE RIGHT WAY IS :</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1750">
<p><strong>WE USE FOR RANGE TO CONSUME</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1755">
<div class="title">ERROR 2 PUBLISH 1 RECEIVE</div>
<p><span class="image"><img src="image/223.jpeg" alt="223"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1758">
<p><span class="image"><img src="image/224.jpeg" alt="224"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1760">
<p><span class="image"><img src="image/225.jpeg" alt="225"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1762">
<p><span class="image"><img src="image/226.jpeg" alt="226"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1764">
<p><span class="image"><img src="image/227.jpeg" alt="227"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1766">
<p><span class="image"><img src="image/228.jpeg" alt="228"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1771">
<h2 id="_select_statement">18. SELECT STATEMENT</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1773">
<p>CREATE A GO ROUTINE AND DONT HAVE A OBVIOUS WAY TO CLOSE</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1775">
<p><span class="image"><img src="image/229.jpeg" alt="229"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1777">
<p><span class="image"><img src="image/230.jpeg" alt="230"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1779">
<p><span class="image"><img src="image/231.jpeg" alt="231"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1781">
<p><span class="image"><img src="image/232.jpeg" alt="232"></span></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1786">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;fmt&quot;
        &quot;sync&quot;
        &quot;time&quot;
)

var wg = sync.WaitGroup{}

const (
        logInfo = &quot;INFO&quot;
        logWarning = &quot;WARNING&quot;
        logError = &quot;ERROR&quot;
)

type logEntry struct{
        time time.Time
        severity string
        message string
}

var logCh = make(chan logEntry, 50)

var doneCh  = make(chan struct{})   // struct{} struct empty field in go is unique, is not need memory allocation
                                                                        // you will see this kind of code, the intention is can send any data through
                                                                        // except for the fact message was send or receive
                                                                        // SO THIS IS CALL A SIGNAL ONLY CHANNEL , ZERO MEMORY ALLOCATION REQUIRED IN SEND A MESSAGE
                                                                        // BUT WE DO ABILITY TO LET THE RECEIVING SIDE KNOW THAT THE MESSAGE WAS SEND
                                                                        // THIS IS PRETTY COMMON IN GO, YOUR WILL SEE A LOT

// THING TO REMEMBER, YOU NEED TO CLOSE GO ROUTINE OTHERWISE YOUR WILL FACING MEMORY LEAK.

func main() {

        go logger()

        // FOR THIS SCENARIO YES WE COULD USE DEFER, BUT HERE ARE TO EXPLAIN ANOTHER USE CASE
        // WHICH IS YOU DON'T KNOW WHEN TO CLOSE THE CHANNEL
        // defer func() {
        //        close(logCh)
        //}()

        logCh &lt;- logEntry{time.Now(), logInfo, &quot;App is starting&quot;}

        logCh &lt;- logEntry{time.Now(), logInfo, &quot;App is shutting down&quot;}

        time.Sleep(100 * time.Millisecond)

        //we tell the singal here struct{} is the type , struct{}{} initialize empty struct{}
        doneCh &lt;- struct{}{}
}

func logger()  {
        // WHAT IS THIS:
        // THE LOGIC, INFINITE LOOP WITH SELECT
        // THE SELECT STATEMENT DOES, is THE ENTIRE STATEMENT IN SELECT IS GONNA BLOCK
        // UNTIL A MESSAGE RECEIVED AND ONE OF THE CHANNEL HAS LISTENING FOR
        // SO IN HERE THE SELECT HAVE CASE LISTENING FROM logCh and listeing from doneCh
        // if get meesage from logCh we print log.
        // if received message from doneCh we gonna break the for loop
        for {
                select {
                case entry := &lt;- logCh:
                        fmt.Printf(&quot;%v - [%v]%v\n&quot;, entry.time.Format(&quot;2006-02T15:04:05&quot;), entry.severity, entry.message)
                case &lt;-doneCh:
                        close(logCh)

                        break

                        // default: if you turn this on, then is non blocking select statement
                         // the select will check is it have a message ready on the channel it monitor,
                         // if yes will execute the code path, other wise will execute this default block
                         // this useful when you dont want to be a blocking select statement which is you have default to executed
                         // if you dont have default behaviour, the leave the select statement block until the message comming in

                }
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1868">
<p><span class="image"><img src="image/234.jpeg" alt="234"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1870">
<p><span class="image"><img src="image/235.jpeg" alt="235"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1872">
<p><span class="image"><img src="image/236.jpeg" alt="236"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1874">
<p><span class="image"><img src="image/237.jpeg" alt="237"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1876">
<p><span class="image"><img src="image/238.jpeg" alt="238"></span></p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1890">
<h2 id="_go_second_tutor">19. GO SECOND TUTOR</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1892">
<h3 id="_variable_2">19.1. Variable</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1894">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1894">
<p>Use <strong>var</strong> when you have declare with a zero value</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1896">
<div class="content">
<pre>var fruits [5]string</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1898">
<p>User <strong>:=</strong> when you have pre initialize</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1900">
<div class="content">
<pre>fruits := [5]string{"1,2,3,4"}</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1902">
<p>Go doesn&#8217;t have cast, go using <strong>conversion</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1904">
<h3 id="_struct_2">19.2. Struct</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1906">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1906">
<p>variable in struct reorder from the bigSize type bytes to the small type bytes</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1909">
<p><span class="image"><img src="image/300.jpeg" alt="300"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1912">
<div class="title">use full when you consuming a json and only for 1 time use struct then can use this.</div>
<p><span class="image"><img src="image/301.jpeg" alt="301"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1914">
<p><span class="image"><img src="image/302.jpeg" alt="302"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1916">
<p><span class="image"><img src="image/303.jpeg" alt="303"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1918">
<h3 id="_pointer_pass_by_value">19.3. Pointer (Pass By Value)</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1920">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1920">
<p>Everything in go is pass by value.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1922">
<p>Pass by value, what you seen is what you get</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1924">
<p>In Go Dont have Constructor but we can create a factory function</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1926">
<p><span class="image"><img src="image/304.jpeg" alt="304"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1928">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1928">
<p>Don&#8217;t ever use addresof upon construction. costruction doesn&#8217;t tell you
where is the memory</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1931">
<p><span class="image"><img src="image/305.jpeg" alt="305"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1933">
<p><span class="image"><img src="image/306.jpeg" alt="306"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1935">
<p><span class="image"><img src="image/307.jpeg" alt="307"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1938">
<p><span class="image"><img src="image/308.jpeg" alt="308"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1941">
<h3 id="_constant">19.4. Constant</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1943">
<p><span class="image"><img src="image/309.jpeg" alt="309"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1945">
<p><span class="image"><img src="image/310.jpeg" alt="310"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1947">
<p><span class="image"><img src="image/311.jpeg" alt="311"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1949">
<p><span class="image"><img src="image/310_1.jpeg" alt="310 1"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1951">
<p><span class="image"><img src="image/312.jpeg" alt="312"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1953">
<h3 id="_array_2">19.5. Array</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1955">
<p><strong>BEWARE OF POINTER SEMANTIC AND VALUE SEMANTIC</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1957">
<p><span class="image"><img src="image/313.jpeg" alt="313"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1959">
<p><strong>ABOVE PRINTED</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1961">
<p><strong>POINTER SEMANTIC FOR RANGE</strong></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1963">
<div class="content">
<pre>Bfr : Betty
Aft : Jack</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1966">
<p>We Use pointer semantic on for range.
We change the value which is the <strong>i</strong> as index pointing the array string</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1969">
<p><span class="image"><img src="image/314.jpeg" alt="314"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1972">
<p><strong>VALUE SEMANTIC FOR RANGE</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1974">
<p><span class="image"><img src="image/315.jpeg" alt="315"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1976">
<p>PRINTED</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1978">
<div class="content">
<pre>Bfr : Betty
Aft : Betty</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1981">
<div class="content">
<pre>Even we change the friends[1] = Jack
Since we use value semantic, the v is copy the old array value.</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1984">
<p><span class="image"><img src="image/316.jpeg" alt="316"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1986">
<p><span class="image"><img src="image/318.jpeg" alt="318"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1988">
<p><strong>WHY THIS HAPPEN</strong>
<strong>THE 2ND FOR RANGE IS NOT ITERATED OFFER FRIENDS ARRAY</strong>
<strong>BECAUSE WE USE VALUE SEMANTIC, SO IS ITERATING OF OWN COPY OF THE FRIENDS</strong>
<strong>THIS IS IMPORTANT</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1993">
<p><span class="image"><img src="image/317.jpeg" alt="317"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-1995">
<p><span class="image"><img src="image/319.jpeg" alt="319"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2000">
<h3 id="_slices">19.6. SLICES</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2002">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2002">
<p>Use make when we know what is the data type and how big is the slice</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2004">
<div class="content">
<pre>  mySlice := make([]int, 5)
fmt.Printf("Len %d, Cap %d", len(mySlice), cap(mySlice))</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2007">
<div class="content">
<pre>Len 5, Cap 5</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2009">
<p>What is different beteween Len and Cap</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2011">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2011">
<p>Capacity is the total number elemets exist in the backing array.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2013">
<p>Capacity can be larger than lenght but not the other way arround</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2015">
<p><strong>IN GO TYPE THAT BY REFERENCE</strong></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2017">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2017">
<p>SLICE</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2018">
<p>MAP</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2019">
<p>FUNCTION</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2020">
<p>INTERFACE</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2021">
<p>CHANNEL</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2023">
<p><span class="image"><img src="image/322.jpeg" alt="322"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2025">
<p><span class="image"><img src="image/321.jpeg" alt="321"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2027">
<p>You can see when we passing slice into fmt.Print</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2029">
<p>we passing value semantic, but what go does is using the slice semantic
which is 24bytes (3 word), 1 pointer, 1 len, 1 cap,
this is the slice value semantic it passing in and it between the function and pointing to the same array.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2033">
<p>hence if you change the slice value it will reflected to all function use that slice</p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2035">
<h3 id="_slice_with_capacity_greater_than_len">19.7. SLICE WITH CAPACITY GREATER THAN LEN</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2037">
<p><span class="image"><img src="image/323.jpeg" alt="323"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2039">
<p><strong>WHAT IS CAPACITY FOR? CAPACITY IS FOR GROWTH</strong></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2041">
<h3 id="_appending_slice">19.8. APPENDING SLICE</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2043">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2043">
<p>using append.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2045">
<p>if you know how much the slice could be, use make to declare the capacity
then is more efficient because we have tell the slice have a 100k capacity.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2048">
<p>go will increase capacity by double the size of backend array if not
enough, when reach to 1000 of records, go will increase 25% for the capacity
of the backing array</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2052">
<div class="content">
<pre>//we declare and initialize zero 100k of slice.
//by using this if we loop 100k times and appdend</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2055">
<div class="content">
<pre>myCapSlice := make([]int, 0, 1e5)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2057">
<div class="content">
<pre>myCapSlice = append(myCapSlice, i) // or
myCapSliceo[i] = i</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2062">
<h3 id="_taking_slice_of_slices">19.9. Taking Slice Of Slices</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2064">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2064">
<p><strong>if you use 2 index slice [startIndex:exclusiveIndex]</strong>
then this any of the slice change will impact each other.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2067">
<p><strong>if you use 3 index slice [startIndex:exclusiveIndex:capacity] FOLLOWING WITH APPEND</strong>
then this copy to a new slice, this two slice is independent.</p>
</li>
</ul>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2072">
<div class="content">
<pre>func main() {

	fruits := []string{"Apples", "Bananas", "Cherries", "Dewberries", "Eggfruit"}

	fmt.Println("fruits", fruits )
	fmt.Println("************************************************************************" )

	slice1 := fruits[2:4]
	fmt.Printf("slice1 , expression slice1 := fruits[2:4] %v , cap: %d\n", slice1, cap(slice1))
	slice1[0] = "Watermelon"
	fmt.Println("slice1, expression slice1[0] = Watermelon =&gt; ", slice1)

	fmt.Println("************************************************************************" )
	fmt.Println("fruits", fruits )

	fmt.Println("************************************************************************" )
	fmt.Println("\nEven you appended, you will replaced the real Eggfruit with Guava, becarefull \n" )
	slice1 = append(slice1, "Guava")
	fmt.Printf("slice1 = append(slice1, Guava)  =&gt; %v, cap : %d\n", slice1, cap(slice1))

	fmt.Println("************************************************************************" )
	fmt.Println("fruits", fruits )

	fmt.Println("\n\n\n" )

	fmt.Println("=========================================================================" )
	fmt.Println("SLICE WITH A 3rd Slice Parameter" )
	fmt.Println("Change index value of the slice2 is affected to fruits" )
	fmt.Println("Appended new to slice2 wont affect the fruits" )
	fmt.Println("Reason because slice2 now is pointed to new copy backing array." )
	fmt.Println("=========================================================================" )

	fmt.Println("\n" )
	fruits = []string{"Apples", "Bananas", "Cherries", "Dewberries", "Eggfruit"}

	fmt.Println("fruits", fruits )
	fmt.Println("************************************************************************" )

	slice2 := fruits[2:4:4]
	fmt.Printf("slice2 , expression slice2 := fruits[2:4:4] ==&gt; %v , cap: %d\n", slice2, cap(slice2))
	slice2[0] = "Watermelon"
	fmt.Println("slice2, expression slice2[0] = Watermelon =&gt; ", slice2)

	fmt.Println("************************************************************************" )
	fmt.Println("fruits", fruits )

	fmt.Println("\nAPPEND, By USING 3 Parameter and Append you slice to a new slice any change would not affect each others\n" )
	slice2 = append(slice2, "Guava")
	fmt.Printf("slice2 , expression slice2 = append(slice2, Guava)==&gt; %v , cap: %d\n", slice2, cap(slice2))

	slice2[0] = "Tomato"
	fmt.Println("slice2, expression slice2[0] = Tomato =&gt; ", slice2)

	fmt.Println("************************************************************************" )
	fmt.Println("fruits", fruits )

}


fruits [Apples Bananas Cherries Dewberries Eggfruit]
************************************************************************
slice1 , expression slice1 := fruits[2:4] [Cherries Dewberries] , cap: 3
slice1, expression slice1[0] = Watermelon =&gt;  [Watermelon Dewberries]
************************************************************************
fruits [Apples Bananas Watermelon Dewberries Eggfruit]
************************************************************************

Even you appended, you will replaced the real Eggfruit with Guava, becarefull

slice1 = append(slice1, Guava)  =&gt; [Watermelon Dewberries Guava], cap : 3
************************************************************************
fruits [Apples Bananas Watermelon Dewberries Guava]




=========================================================================
SLICE WITH A 3rd Slice Parameter
Change index value of the slice2 is affected to fruits
Appended new to slice2 wont affect the fruits
Reason because slice2 now is pointed to new copy backing array.
=========================================================================


fruits [Apples Bananas Cherries Dewberries Eggfruit]
************************************************************************
slice2 , expression slice2 := fruits[2:4:4] ==&gt; [Cherries Dewberries] , cap: 2
slice2, expression slice2[0] = Watermelon =&gt;  [Watermelon Dewberries]
************************************************************************
fruits [Apples Bananas Watermelon Dewberries Eggfruit]

APPEND, By USING 3 Parameter and Append you slice to a new slice any change would not affect each others

slice2 , expression slice2 = append(slice2, Guava)==&gt; [Watermelon Dewberries Guava] , cap: 4
slice2, expression slice2[0] = Tomato =&gt;  [Tomato Dewberries Guava]
************************************************************************
fruits [Apples Bananas Watermelon Dewberries Eggfruit]</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2173">
<p>In other word to make a clone of slice from slice,
you can use third parameters + append</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2176">
<div class="content">
<pre>[startIndex : exlusionIndex : capacity]</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2178">
<p>In other word if you slices a slice and append some data to
the sliced slice, in this case both have different backing array.
mean is independent.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2182">
<p>or to Clone a slice by using copy</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2184">
<div class="content">
<pre>slice3 :=  make([]int, len(slice1))
copy(slice3, slice1)</pre>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2188">
<h3 id="_slice_and_references">19.10. Slice and references</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2190">
<p><strong>PLEASE BEWARE OF THIS SIDE EFFECT, YOU WILL CAUSE MEMORY LEAK</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2193">
<p><span class="image"><img src="image/324.jpeg" alt="324"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2195">
<p><strong>IF YOU APPEND TO THE ORIGINAL SLICE, SINCE CAPACITY NOT
ENOUGH GO WILL CREATE NEW ADDRESS FOR BACKING ARRAY
AND DOUBLED THE CAPACITY, SEE THE IMAGE 326
AT HERE YOU shareUse is POINTING TO OLD BACKING ARRAY.</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2200">
<p><strong>THING GONNA GOING BAD</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2203">
<div class="title">326</div>
<p><span class="image"><img src="image/326.jpeg" alt="326"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2205">
<p><strong>IMPORTANT</strong>
The sharuser is stil pointed to old backing array,
now you cause the memory leak, the pointer still pointed to old backing array
and the slice after you append is a new backing array because capacity not enough and growth.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2210">
<p><strong>PLEASE PAY ATTENTION ON ABOVE</strong></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2213">
<h3 id="_string_slice">19.11. String &amp; Slice</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2215">
<p>String in GO is UTF-8</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2217">
<p>UTF-8 have 3 layer character set</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2219">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2219">
<p>Layer 1 Top Level : Character , 1 to multiple code point</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2221">
<p>Layer 2 Mid Level : code point (32 bit) or 4 byte value , any to 4 byte</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2223">
<p>Layer 3 Bottom Level : byte</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2225">
<p>example</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2227">
<div class="content">
<pre>s := "世界 means world" // in total is 18 bytes</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2229">
<div class="content">
<pre>世 = 3 byte
界 = 3 byte
the rest  12 byte</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2233">
<p>when you do for range to a string you are get the code point,</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2236">
<p><span class="image"><img src="image/327.jpeg" alt="327"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2238">
<p><span class="image"><img src="image/328.jpeg" alt="328"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2240">
<p><span class="image"><img src="image/329.jpeg" alt="329"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2242">
<p><span class="image"><img src="image/330.jpeg" alt="330"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2244">
<p><span class="image"><img src="image/331.jpeg" alt="331"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2246">
<p><span class="image"><img src="image/332.jpeg" alt="332"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2249">
<h2 id="_maps_2">20. MAPS</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2251">
<p><span class="image"><img src="image/333.jpeg" alt="333"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2254">
<p><strong>Sort Map</strong> :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2256">
<p><span class="image"><img src="image/334.jpeg" alt="334"></span></p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2260">
<h2 id="_decoupling">21. DECOUPLING</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2263">
<h3 id="_when_to_use_value_semantic_when_to_use_pointer_semantic">21.1. WHEN TO USE VALUE SEMANTIC &amp; WHEN TO USE POINTER SEMANTIC</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2265">
<p>In Go We have 3 major type</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2267">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2267">
<p>built in type&#8201;&#8212;&#8201;String, bool, int, float etc.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2270">
<p>reference type&#8201;&#8212;&#8201;map, slice, interface, function &amp; channel</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2273">
<p>User define type&#8201;&#8212;&#8201;struct</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2276">
<p>RULE :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2278">
<p><strong>1. IF you dealing with built type please use a value semantic</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2280">
<p><strong>in other words don&#8217;t ever use build in type as pointer,
including field in a struct, if is built in type don&#8217;t ever use pointer,
every thing should be value based</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2284">
<p>There only 1 exception when you dealing with SQL data,
and you have a struct to be marshal &amp; unmarshalling data, the concept
is you doesn&#8217;t know there is a exist or non exist data unless is a pointer</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2288">
<p>that why is obviously when you see a struct dealing with relational db schema
you see a pointer.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2293">
<p><strong>2. Use value semantic on all reference type</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2295">
<p>Meaning never type the address of reference type.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2297">
<p>There 1 execption for this however
a slice and a map, you might take address of slice and map
only if sharing down to the call stack and to a function that
either name decode or unmarshal</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2302">
<p>since all map, slice , channel &#8230;&#8203; is pointer there no reason
to take address of the address.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2306">
<p><strong>2. Struct is you defined, you need to decide is a pointer or value semantic</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2308">
<p>If your are not sure what you will use them, you just use pointer semantic.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2310">
<p>if you really sure can be value semantic then use value semantic</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2312">
<p>Example :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2314">
<p><strong>Reference Type</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2316">
<p><span class="image"><img src="image/335.jpeg" alt="335"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2319">
<p>You might think because the Mask is mutation api,
i must use pointer semantic, no, you are wrong,
the Mask it is do mutation, by using the it own copy.
it is a save way mutation, at the end it return a new IP</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2324">
<p><span class="image"><img src="image/336.jpeg" alt="336"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2327">
<div class="title">this method receiver value of type IP return a string,</div>
<p>Why return a string, string built in value type semantic, IP is reference type semantic
<span class="image"><img src="image/337.jpeg" alt="337"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2330">
<p>Above code is standard library code, nothing is randomize, it follow value and pointer semantic to a &lt;T&gt;</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2332">
<p><strong>Struct Type</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2334">
<p><span class="image"><img src="image/338.jpeg" alt="338"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2336">
<p>If you asked to create time api by given above struct, from standard package above
You have to decide what semantic will you use?, before you use.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2339">
<p>So what semantic will you choose?</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2341">
<p>Hints :
Time now vs times 5 seconds ago
it should a value mutated? or is should be a new Value?</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2345">
<p>it should be an new different data, not mutated from previous data.
hence at here value semantic is the perfect choice.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2348">
<p>Haw about User struct ? should you mutated or making a copy?</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2350">
<p>for how to think about this, did a person in the world you can make copy
on it? u should use pointer semantic and change the value.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2354">
<p>if you not sure, just use pointer semantic, because it always
save for the share then make copy , because not all data can be copy.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2359">
<p><span class="image"><img src="image/339.jpeg" alt="339"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2361">
<p>if use some person library or see some person code,
try find out the factory function, what is their return
value or pointer? above the owner of the code is returning a
value , so is a value semantic, it will give you new copy
of time object, then you must play it with value semantic
and return another copy to others.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2369">
<p><span class="image"><img src="image/340.jpeg" alt="340"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2371">
<p>it does mutation, yes it does.
but it mutate on it own copy, and this is the save way. value semantic
so no side effect.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2375">
<p><span class="image"><img src="image/341.jpeg" alt="341"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2377">
<p>guess what? <strong>VALUE SEMANTIC</strong> code has to be consistent and nothing is randomize</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2380">
<p><span class="image"><img src="image/342.jpeg" alt="342"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2382">
<p>Except above, need to turn the value semantic into pointer
is a contract of interfaces, marshal unmarshal, decode
it need to mutate directly.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2386">
<p><span class="image"><img src="image/343.jpeg" alt="343"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2388">
<p><span class="image"><img src="image/344.jpeg" alt="344"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2390">
<p><strong>Pointer semantic example</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2392">
<p><span class="image"><img src="image/345.jpeg" alt="345"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2394">
<p><strong>IMPORTANT</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2396">
<p>above is pointer semantic, it returning a *File pointer
you do not have a right to copy the of the pointer value.
you must only use and do mutate the *File pointer directly.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2400">
<p><span class="image"><img src="image/346.jpeg" alt="346"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2402">
<p>above it doesn&#8217;t mutate the pointer value used for the call, but that type
require pointer semantic. is a semantic contract.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2405">
<p><span class="image"><img src="image/347.jpeg" alt="347"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2407">
<p>same at this because the code and the api have to use pointer semantic.
have to respect the semantic, hence it return and pointer and use pointer semantic.
not the other way around.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2411">
<p><strong>&gt;&gt;&gt;&gt;&gt; We Define the data, we define the type and we define the semantic and we write code</strong></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2414">
<h3 id="_important_semantic_show_case">21.2. @IMPORTANT SEMANTIC SHOW CASE</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2416">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2416">
<p>Mixing semantic can causing huge of issue</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2418">
<p>example :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2420">
<p><span class="image"><img src="image/348.jpeg" alt="348"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2422">
<p>Above we create 2 user using slices of user,
and we loop using value semantic.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2425">
<p>do you know the issue?
your are changing the copy of the slice, to the index of slice
pointed to the user.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2429">
<p>so here you are mixing the semantic.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2431">
<p>slice is a reference type, u must use pointer semantic</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2433">
<div class="content">
<pre>with code :
users[i].email = "xxx" // pointer semantic</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2436">
<p><strong>BEWARE OF ABOVE, is not same as what java DOES,
email will not getting change, and is hard to trace bugs of this kind of code</strong></p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2440">
<h4 id="_method_should_not_exist_by_default">21.2.1. METHOD Should not exist by default.</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2442">
<p>Method exist if the data have behaviour, if not there is no method.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2444">
<p>should use function. not all data have behaviour.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2446">
<p><strong>Setter &amp; Getter is not a API</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2448">
<p>Setter and Getter is a blood of code base. requirement more testing
and really add no more value.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2451">
<p><strong>PLEASE AVOID SETTER AND GETTER IN GO</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2454">
<p><span class="image"><img src="image/349.jpeg" alt="349"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2456">
<p><strong>ABOVE is Really Bad Code.</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2458">
<p>Here is the problem :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2461">
<p><span class="image"><img src="image/350.jpeg" alt="350"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2464">
<div class="title">see actual go do is this, above is syntactic sugar go handle for you.</div>
<p><span class="image"><img src="image/351.jpeg" alt="351"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2466">
<p><strong>IS REALLY UGLY</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2468">
<p><strong>Function in GO all is VALUE TYPE</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2470">
<p>Function is literally type value, that mean we can pass any function
by it name to anywhere in our program as long the type information is a same,
function signature</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2474">
<p><span class="image"><img src="image/352.jpeg" alt="352"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2476">
<p>Above we assign the d.displayName to new variable f1,
HERE we assign the field not the function.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2479">
<p>in line 55 we invoke the function call from variable f1 it self</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2481">
<p><span class="image"><img src="image/353.jpeg" alt="353"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2483">
<p>how ugly is that?</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2485">
<p><span class="image"><img src="image/354.jpeg" alt="354"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2487">
<p><strong>Decoupling have cause indirection and creating new allocation</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2489">
<p><strong>Think about it, if decoupling make new something worth it for you then okay to
take the cost (indirection and new allocate), if no adding new something worth it, just work directly into the data it self</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2492">
<p><strong>IN General the method is to give data behaviour, when a data need behaviour?</strong></p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2495">
<h3 id="_interface_polymorphism">21.3. INTERFACE (Polymorphism)</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2497">
<p>Polymorphism means that the piece of code changing of the behaviour
depending on the concrete data that is operating on</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2500">
<p>So When is data have an behaviour?</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2502">
<p>one good reason is we want to implement polymorphism
and the polymorphism should give us the level of decoupling.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2506">
<p><span class="image"><img src="image/355.jpeg" alt="355"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2508">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2508">
<p>Interface type are not real, are not a concrete type.
interface only define a method contract of the behaviour.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2511">
<p><span class="image"><img src="image/356.jpeg" alt="356"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2513">
<p><strong>In Go everything is convention over configuration</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2515">
<p>Where is the code to know implementation</p>
</div>
<div class="exampleblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2517">
<div class="content">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2519">
<p>Because the code on line 20, We can now say the the concrete file (implement reader)  implementation reading file using value semantic.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2522">
<p>Go is convention over configuration, Interface is not to configure to a concrete type.</p>
</div>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2526">
<p><span class="image"><img src="image/357.jpeg" alt="357"></span></p>
</div>
<div class="exampleblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2528">
<div class="content">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2530">
<p>Because the code on line 37 now the concrete type of PIPE implement the Reader interface using value semantic</p>
</div>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2534">
<p>Now have 2 concrete type have 2 implementation, 2 Type of data have it own behaviour with same signature.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2536">
<p><span class="image"><img src="image/358.jpeg" alt="358"></span></p>
</div>
<div class="exampleblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2538">
<div class="content">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2539">
<p>Function above is polymorphism, because it depend on the reader real concrete type you passing in,
will get different behaviour, either is file or pipe</p>
</div>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2543">
<p><span class="image"><img src="image/359.jpeg" alt="359"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2546">
<p><span class="image"><img src="image/360.jpeg" alt="360"></span></p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2549">
<h4 id="_method_sets_address_of_value">21.3.1. METHOD Sets &amp; Address of Value</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2551">
<p>Contract of interface into method set.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2553">
<p><strong>If you working wit value semantic with Type T then only value receiver belong to the method set of type T</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2555">
<p><strong>If you working with pointer semantic with Type T then al the method set (value semantic or pointer semantic) belong to the Type T</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2559">
<div class="title">if you working with value semantic then all pointer semantic will left out as method set</div>
<p><span class="image"><img src="image/361.jpeg" alt="361"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2562">
<p><strong>WHY Value semantic would not have pointer receiver?</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2564">
<p><span class="image"><img src="image/362.jpeg" alt="362"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2566">
<p><span class="image"><img src="image/363.jpeg" alt="363"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2568">
<p>Because you see above, you will not able to passing integer literal as a pointer or the value dont have address.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2570">
<p>Which is duration is contant of kind int, it not availabe at the compile time.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2572">
<p><span class="image"><img src="image/364.jpeg" alt="364"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2574">
<p><span class="image"><img src="image/365.jpeg" alt="365"></span></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2577">
<h4 id="_storage_by_value">21.3.2. Storage by value</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2580">
<p><span class="image"><img src="image/366.jpeg" alt="366"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2582">
<p><span class="image"><img src="image/367.jpeg" alt="367"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2584">
<p>We crate printer interface and implement using value semantic.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2586">
<p>then we create a slice using construction with index[0] is value semantic and index[1] is pointer semantic</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2588">
<p>then we change the name of the user (u) object.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2590">
<p>then we iterate over the printer slices using value semantic for range.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2593">
<div class="title">this is the slice look like</div>
<p><span class="image"><img src="image/368.jpeg" alt="368"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2595">
<p><span class="image"><img src="image/369.jpeg" alt="369"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2597">
<p>we iterate over the slice and using value semantic, this is not random semantic.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2599">
<p>what is interface, is reference type, reference type is value semantic,</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2601">
<p>don&#8217;t ever get value of the address of the reference type using pointer.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2603">
<p>this is bad, because you get the address of a pointer pointing too.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2605">
<p>hence above iterate using value semantic, but we get the interface reference,
we call print it will get the correct data to do the printer behavior,</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2608">
<p>above interface slice, only the index 1 get changed,</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2610">
<p>because index (0) slice is store the value only.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2612">
<p><span class="image"><img src="image/370.jpeg" alt="370"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2616">
<p><span class="image"><img src="image/371.jpeg" alt="371"></span></p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2618">
<h3 id="_embedding">21.4. EMBEDDING</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2621">
<p><span class="image"><img src="image/372.jpeg" alt="372"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2623">
<p><span class="image"><img src="image/276.jpeg" alt="276"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2625">
<p><span class="image"><img src="image/373.jpeg" alt="373"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2627">
<p>Above is not embedding yet</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2630">
<div class="title">this is embedding, once construction we must use the type</div>
<p><span class="image"><img src="image/374.jpeg" alt="374"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2633">
<p><strong>We Embedding a user value inside the admin value</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2635">
<p>user type is inner type, admin is outher type, everything in inner type
will promoted to outer type, so i can directly access on it.</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2639">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import &quot;fmt&quot;

type user struct {
        name string
        email string
        age uint8
}

// been override by admin, but you can still access using inner type.
func (u *user) notify()  {
        fmt.Printf(&quot;USER, Sending email to user email %s,  name %s\n&quot;, u.email, u.name)
}

type admin struct {
        user
        level string
}

// This one will override the inner type implementation
func (a *admin) notify() {
        fmt.Printf(&quot;ADMIN, Sending email to user email %s,  name %s\n&quot;, a.email, a.name)
}


type notifier interface {
        notify()
}


func main() {

        adm := admin{
                user: user{&quot;atan&quot;, &quot;jonny.marcello@gmail.com&quot;, 12},
                level: &quot;level1&quot;,
        }
        fmt.Println(&quot;admin&quot;, adm)

        adm.user.notify()

        // promoted, this is embedding, and is not inheritance. admin is not user or vice versa.
        adm.notify()


        // send the admin user a notification
        // The embedded inner type is implementation of the
        // interface is &quot;promoted&quot; to the outer type
        sendNotification(&amp;adm)
}

// sendNotification accept values that implement notifier interface
// interface and send notification
func sendNotification(n notifier)  {
        n.notify()
}</code></pre>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2700">
<h3 id="_exporting">21.5. Exporting</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2702">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2702">
<p>package private (lower case)</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2704">
<p>export (using Upper case)</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2706">
<p><span class="image"><img src="image/377.jpeg" alt="377"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2708">
<p><span class="image"><img src="image/378.jpeg" alt="378"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2710">
<p><span class="image"><img src="image/379.jpeg" alt="379"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2714">
<div class="title">in here is not the encapsulation here, please dont do this.</div>
<p><span class="image"><img src="image/380.jpeg" alt="380"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2717">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2717">
<p>Type level encapsulation</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2719">
<p><span class="image"><img src="image/381.jpeg" alt="381"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2721">
<p><span class="image"><img src="image/382.jpeg" alt="382"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2724">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2724">
<p>Another unique show case (common in go because marshal and unmarshal in go only respected to field is exported)</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2726">
<p><span class="image"><img src="image/383.jpeg" alt="383"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2728">
<p><span class="image"><img src="image/384.jpeg" alt="384"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2731">
<h3 id="_composition_design_time">21.6. Composition (Design Time)</h3>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2733">
<h4 id="_grouping_type">21.6.1. Grouping Type</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2735">
<p>In go if you try to group a Animal that is Cat and Dog, then you are run into the trouble.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2737">
<p>In go we group by behaviour not the Cat and Dog as animal.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2739">
<p>Stop thinking about who is Dog or Who is Cat (is Configuration), but think how is Dog and Cat can do (Convention).</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2741">
<p>*GO is Convention over Configuration)</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2743">
<p><span class="image"><img src="image/384.jpeg" alt="384"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2745">
<p><span class="image"><img src="image/385.jpeg" alt="385"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2747">
<p><span class="image"><img src="image/386.jpeg" alt="386"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2749">
<p><span class="image"><img src="image/387.jpeg" alt="387"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2752">
<p><strong>ABOVE WON&#8217;T WORK AT GO</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2754">
<p><span class="image"><img src="image/388.jpeg" alt="388"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2757">
<div class="title">instead of Animal insterface we create Speaker interface as the behaviour of cat and dog</div>
<p><span class="image"><img src="image/390.jpeg" alt="390"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2760">
<div class="title">then we copy common field into dog and cat. different with Java, here better duplication.</div>
<p>more easier to read, more easier to debug.
<span class="image"><img src="image/391.jpeg" alt="391"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2764">
<div class="title">so we can group cat and dog by the behaviour Speaker</div>
<p><span class="image"><img src="image/392.jpeg" alt="392"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2767">
<p><strong>FOLLOW THIS GUIDELINE WHEN YOU SHOULD CREATE A TYPE</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2769">
<p><span class="image"><img src="image/393.jpeg" alt="393"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2771">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2771">
<p>Declare type that represent something new or unique</p>
</li>
</ul>
</div>
<div class="exampleblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2773">
<div class="content">
<div class="olist arabic has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2774">
<ol class="arabic">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2774">
<p>Avoid concept of alliasing.</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2776">
<div class="content">
<pre>type handle int</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2778">
<div class="content">
<pre>this is aliasing, is haldle is something new or unique? is just try to asbtract the handle is int</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2780">
<div class="content">
<pre>if we dont see a set method of this type , can say we do some sort of aliases. don't do this.</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2782">
<div class="content">
<pre>even you add set method</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2784">
<div class="content">
<pre>func foo(h handle)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2786">
<div class="content">
<pre>but this is not possible.</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2788">
<div class="content">
<pre>remember because the constant of a kind can be implicit converted.</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2790">
<div class="content">
<pre>foo(10)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2792">
<div class="content">
<pre>// will be able to compile that, and this is not handle type
// you get a protection is handle type.</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2795">
<div class="content">
<pre>type Duration int64</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2797">
<div class="content">
<pre>// we can use Duration as type on time pakcage, Duration is represent time in nanoseconds. is not repesent as int64.</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2802">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2802">
<p>Validate that a value of any type is created or used on its own.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2805">
<h3 id="_how_composition_work_on_go">21.7. How Composition Work on GO</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2807">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2807">
<p>Solve problem in concrete first</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2808">
<p>Then asking question what can be decoupling.</p>
</li>
</ul>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2811">
<h3 id="_design_api">21.8. Design API</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2813">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2813">
<p>Primitive Layer</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2814">
<p>Lower Level Layer</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2815">
<p>High Level Layer</p>
</li>
</ul>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2820">
<h4 id="_practice">21.8.1. Practice</h4>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2823">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;errors&quot;
        &quot;fmt&quot;
        &quot;io&quot;
        &quot;math/rand&quot;
        &quot;time&quot;
)

func init()  {
        rand.Seed(time.Now().UnixNano())
}

// PRIMITIVE API
// Data is the structure of the data we are copying
type Data struct {
        Line string
}

// Xenia is the system we need to pull out the data
type Xenia struct {
        Host string
        Timeout time.Duration
}

type Pillar struct {
        Host string
        Timeout time.Duration
}

func (*Xenia) Pull(d *Data) error { //method
        switch rand.Intn(10) {
        case 1, 9:
                return io.EOF

        case 5:
                return errors.New(&quot;Error reading data from Xenia&quot;)

        default:
                d.Line = &quot;Data&quot;
                fmt.Println(&quot;In: &quot;, d.Line)
                return nil
        }
}

func (*Pillar) Store(d *Data) error {
        fmt.Println(&quot;Out :&quot;, d.Line)
        return nil
}
// END PRIMITIVE API

// LOWER LEVEL API
type System struct {
        Xenia
        Pillar
}

func pull(x *Xenia, data []Data) (int, error)  {
        for i := range data {
                if err := x.Pull(&amp;data[i]); err != nil { // we pass to primitive layer pull
                        return i, err
                }
        }
        return len(data), nil
}

func store(p *Pillar, data []Data) (int, error) {
        for i := range data {
                if err := p.Store(&amp;data[i]); err != nil {
                        return i, err
                }
        }
        return len(data), nil
}
// END LOWER LEVEL API

// High Level API
func Copy (sys *System, batch int) error {
        data := make([]Data, batch)

        for {
                i, err := pull(&amp;sys.Xenia, data)
                if i &gt; 0 {
                        if _, err := store(&amp;sys.Pillar, data[:i]); err != nil {
                                return err
                        }
                }

                if err != nil {
                        return err
                }
        }
}
// End High Level API

func main() {
        sys := System{
                Xenia{
                        Host:    &quot;localhost:8000&quot;,
                        Timeout: time.Second,
                },
                Pillar{
                        Host:    &quot;localhost:9000&quot;,
                        Timeout: time.Second,
                },
        }

        if err := Copy(&amp;sys, 3); err != io.EOF {
                fmt.Println(err)
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2938">
<p><span class="image"><img src="image/394.jpeg" alt="394"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2941">
<p><strong>We Are Not Done</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2943">
<p>We Need to refactoring, to support feature if let say have bob and allice system</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2945">
<p>to pull and push into the db</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2948">
<p><strong>REFACTOR 1</strong></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-2950">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;errors&quot;
        &quot;fmt&quot;
        &quot;io&quot;
        &quot;math/rand&quot;
        &quot;time&quot;
)

func init()  {
        rand.Seed(time.Now().UnixNano())
}

// Refactor, we add interface later after the concrete.
type Puller interface {
        Pull (d *Data) error
}

type Storer interface {
        Store(d *Data) error
}

// This is interface to replace the System
type PullStorer interface {
        Puller
        Storer
}
//

// PRIMITIVE API
// ===============================================================
// Data is the structure of the data we are copying
type Data struct {
        Line string
}

// Xenia is the system we need to pull out the data
type Xenia struct {
        Host string
        Timeout time.Duration
}

type Pillar struct {
        Host string
        Timeout time.Duration
}

// Concrete Type Xenia
func (*Xenia) Pull(d *Data) error { //method
        switch rand.Intn(10) {
        case 1, 9:
                return io.EOF

        case 5:
                return errors.New(&quot;Error reading data from Xenia&quot;)

        default:
                d.Line = &quot;Data&quot;
                fmt.Println(&quot;In: &quot;, d.Line)
                return nil
        }
}

// Concrete Type Pilar
func (*Pillar) Store(d *Data) error {
        fmt.Println(&quot;Out :&quot;, d.Line)
        return nil
}
// ===============================================================
// END PRIMITIVE API



// LOWER LEVEL API
// ===============================================================
type System struct {
        Xenia
        Pillar
}

// We Change To Puller interface, interface is reference type, must use value semantic
// So We can create multiple concrete type on primitive level, this function work
func pull(p Puller, data []Data) (int, error)  {
        for i := range data {
                if err := p.Pull(&amp;data[i]); err != nil { // we pass to primitive layer pull
                        return i, err
                }
        }
        return len(data), nil
}

// We Change To Storer interface, interface is reference type, must use value semantic
// So We can create multiple concrete type on primitive level, this function work
func store(s Storer, data []Data) (int, error) {
        for i := range data {
                if err := s.Store(&amp;data[i]); err != nil {
                        return i, err
                }
        }
        return len(data), nil
}
// ===============================================================
// END LOWER LEVEL API



// High Level API
// We change to PullStorer interface
// ===============================================================
func Copy (ps PullStorer, batch int) error {
        data := make([]Data, batch)

        for {
                i, err := pull(ps, data)
                if i &gt; 0 {
                        if _, err := store(ps, data[:i]); err != nil {
                                return err
                        }
                }

                if err != nil {
                        return err
                }
        }
}
// ===============================================================
// End High Level API



func main() {
        sys := System{
                Xenia{
                        Host:    &quot;localhost:8000&quot;,
                        Timeout: time.Second,
                },
                Pillar{
                        Host:    &quot;localhost:9000&quot;,
                        Timeout: time.Second,
                },
        }

        if err := Copy(&amp;sys, 3); err != io.EOF {
                fmt.Println(err)
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3102">
<p><strong>The Mechanic</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3104">
<p><span class="image"><img src="image/395.jpeg" alt="395"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3107">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3107">
<p>Interface is value less,</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3109">
<div class="content">
<pre>at Copy is received a PullSrtore interface, give me any pointer or any value
that have same method signature, implement PullSrtore interface</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3112">
<div class="content">
<pre>at pull is Received a Pull interface, give me any pointer or any value
that have same method signature, implement Pull interface</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3115">
<div class="content">
<pre>at store is Received a Store interface, give me any pointer or any value
that have same method signature, implement Store interface</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3118">
<div class="content">
<pre>PullStorer, Pull, and Store is value less is doesn't exist.</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3120">
<div class="content">
<pre>We pass System to Copy, because System is the concrete
data, the implementation of PullStorer, why?
because System promote embedded Xenia &amp; Pillar,
Which is Xenia is implement Puller, and Pillar is implement Strorer</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3125">
<div class="content">
<pre>so System is automatically implement PullStorer</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3127">
<p><strong>REMEMBER :</strong></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3129">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3129">
<p>We are not passing PullStore to pull func</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3130">
<p>We are not passing PullStore to store func</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3132">
<p>PullStore is value less and is not exist.
so what is we passing in ? is the Concrete Data.
What was that, is the System obj, the concrete implementation.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3138">
<p><strong>We are not Done Yet</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3140">
<p><strong>REFACTOR 2</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3142">
<p>System will not able to handle any bob or alice.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3144">
<p>Hence we change system concrete struct to using Puller &amp; Storer
then at main we inject the concrete data into it. brilliant.</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3148">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;errors&quot;
        &quot;fmt&quot;
        &quot;io&quot;
        &quot;math/rand&quot;
        &quot;time&quot;
)

func init()  {
        rand.Seed(time.Now().UnixNano())
}

// Refactor, we add interface later after the concrete.
type Puller interface {
        Pull (d *Data) error
}

type Storer interface {
        Store(d *Data) error
}

// This is interface to replace the System
type PullStorer interface {
        Puller
        Storer
}
//

// PRIMITIVE API
// ===============================================================
// Data is the structure of the data we are copying
type Data struct {
        Line string
}

// Xenia is the system we need to pull out the data
type Xenia struct {
        Host string
        Timeout time.Duration
}

type Pillar struct {
        Host string
        Timeout time.Duration
}

// Concrete Type Xenia, Since here we use method sets with Pointer semantic then at system need to using addressOf
func (*Xenia) Pull(d *Data) error { //method
        switch rand.Intn(10) {
        case 1, 9:
                return io.EOF

        case 5:
                return errors.New(&quot;Error reading data from Xenia&quot;)

        default:
                d.Line = &quot;Data&quot;
                fmt.Println(&quot;In: &quot;, d.Line)
                return nil
        }
}

// Concrete Type Pilar, Since here we use method sets with Pointer semantic then at system need to using addressOf
func (*Pillar) Store(d *Data) error {
        fmt.Println(&quot;Out :&quot;, d.Line)
        return nil
}
// ===============================================================
// END PRIMITIVE API



// LOWER LEVEL API
// ===============================================================
// We change this concrete with Puller &amp; Storer
// The intention we can inject the Puller &amp; Storer with the concrete implementation
type System struct {
        Puller
        Storer
        //Xenia
        //Pillar
}

// We Change To Puller interface, interface is reference type, must use value semantic
// So We can create multiple concrete type on primitive level, this function work
func pull(p Puller, data []Data) (int, error)  {
        for i := range data {
                if err := p.Pull(&amp;data[i]); err != nil { // we pass to primitive layer pull
                        return i, err
                }
        }
        return len(data), nil
}

// We Change To Storer interface, interface is reference type, must use value semantic
// So We can create multiple concrete type on primitive level, this function work
func store(s Storer, data []Data) (int, error) {
        for i := range data {
                if err := s.Store(&amp;data[i]); err != nil {
                        return i, err
                }
        }
        return len(data), nil
}
// ===============================================================
// END LOWER LEVEL API



// High Level API
// We change to PullStorer interface
// ===============================================================
func Copy (ps PullStorer, batch int) error {
        data := make([]Data, batch)

        for {
                i, err := pull(ps, data)
                if i &gt; 0 {
                        if _, err := store(ps, data[:i]); err != nil {
                                return err
                        }
                }

                if err != nil {
                        return err
                }
        }
}
// ===============================================================
// End High Level API


// We Inject here to the system to Puller and Storer with the value is the concrete type,
// Puller = Xenia
// Storer = Pillar
// BOOM Thing DONE ! AMAZING
func main() {
        sys := System{
                Puller: &amp;Xenia{
                        Host:    &quot;localhost:8000&quot;,
                        Timeout: time.Second,
                },
                Storer: &amp;Pillar{
                        Host:    &quot;localhost:9000&quot;,
                        Timeout: time.Second,
                },
                //Xenia: Xenia{
                //        Host:    &quot;localhost:8000&quot;,
                //        Timeout: time.Second,
                //},
                //Pillar: Pillar{
                //        Host:    &quot;localhost:9000&quot;,
                //        Timeout: time.Second,
                //},
        }

        if err := Copy(&amp;sys, 3); err != io.EOF {
                fmt.Println(err)
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3314">
<p><strong>CODE REVIEW</strong></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3316">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3316">
<p>Code Readability Review</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3318">
<p>Mental Model, naming, semantic (value / pointer)</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3320">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3320">
<p>Technical Review</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3322">
<p><strong>If We looking above Code, We even no need the PullStorer interface,
PullStorer interface is interface poluiton so we can remove it :</strong></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3326">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;errors&quot;
        &quot;fmt&quot;
        &quot;io&quot;
        &quot;math/rand&quot;
        &quot;time&quot;
)

func init()  {
        rand.Seed(time.Now().UnixNano())
}

// Refactor, we add interface later after the concrete.
type Puller interface {
        Pull (d *Data) error
}

type Storer interface {
        Store(d *Data) error
}

// This is interface to replace the System
// REMOVE, is interface POLUTION, we don't need this
//type PullStorer interface {
//        Puller
//        Storer
//}
//

// PRIMITIVE API
// ===============================================================
// Data is the structure of the data we are copying
type Data struct {
        Line string
}

// Xenia is the system we need to pull out the data
type Xenia struct {
        Host string
        Timeout time.Duration
}

type Pillar struct {
        Host string
        Timeout time.Duration
}

// Concrete Type Xenia, Since here we use method sets with Pointer semantic then at system need to using addressOf
func (*Xenia) Pull(d *Data) error { //method
        switch rand.Intn(10) {
        case 1, 9:
                return io.EOF

        case 5:
                return errors.New(&quot;Error reading data from Xenia&quot;)

        default:
                d.Line = &quot;Data&quot;
                fmt.Println(&quot;In: &quot;, d.Line)
                return nil
        }
}

// Concrete Type Pilar, Since here we use method sets with Pointer semantic then at system need to using addressOf
func (*Pillar) Store(d *Data) error {
        fmt.Println(&quot;Out :&quot;, d.Line)
        return nil
}
// ===============================================================
// END PRIMITIVE API



// LOWER LEVEL API
// ===============================================================
// We change this concrete with Puller &amp; Storer
// The intention we can inject the Puller &amp; Storer with the concrete implementation
type System struct {
        Puller
        Storer
        //Xenia
        //Pillar
}

// We Change To Puller interface, interface is reference type, must use value semantic
// So We can create multiple concrete type on primitive level, this function work
func pull(p Puller, data []Data) (int, error)  {
        for i := range data {
                if err := p.Pull(&amp;data[i]); err != nil { // we pass to primitive layer pull
                        return i, err
                }
        }
        return len(data), nil
}

// We Change To Storer interface, interface is reference type, must use value semantic
// So We can create multiple concrete type on primitive level, this function work
func store(s Storer, data []Data) (int, error) {
        for i := range data {
                if err := s.Store(&amp;data[i]); err != nil {
                        return i, err
                }
        }
        return len(data), nil
}
// ===============================================================
// END LOWER LEVEL API



// High Level API
// We change to PullStorer interface
// We use back system it self, since PullStorer is interface Polution
// ===============================================================
//func Copy (ps PullStorer, batch int) error {
func Copy (sys *System, batch int) error {
        data := make([]Data, batch)

        for {
                i, err := pull(sys, data)
                if i &gt; 0 {
                        if _, err := store(sys, data[:i]); err != nil {
                                return err
                        }
                }

                if err != nil {
                        return err
                }
        }
}
// ===============================================================
// End High Level API


// We Inject here to the system to Puller and Storer with the value is the concrete type,
// Puller = Xenia
// Storer = Pillar
// BOOM Thing DONE ! AMAZING
func main() {
        sys := System{
                Puller: &amp;Xenia{
                        Host:    &quot;localhost:8000&quot;,
                        Timeout: time.Second,
                },
                Storer: &amp;Pillar{
                        Host:    &quot;localhost:9000&quot;,
                        Timeout: time.Second,
                },
                //Xenia: Xenia{
                //        Host:    &quot;localhost:8000&quot;,
                //        Timeout: time.Second,
                //},
                //Pillar: Pillar{
                //        Host:    &quot;localhost:9000&quot;,
                //        Timeout: time.Second,
                //},
        }

        if err := Copy(&amp;sys, 3); err != io.EOF {
                fmt.Println(err)
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3494">
<p><strong>If We take a look on code readability, even the System is not precise,
because is try to hidding what data need to be pass in</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3497">
<p><strong>We can make it more precise, more easier to found bugs and more easier to test</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3500">
<p><strong>NOW MORE LEAN AND CLEAN AFTER WE REOMVED SYSTEM</strong></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3502">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;errors&quot;
        &quot;fmt&quot;
        &quot;io&quot;
        &quot;math/rand&quot;
        &quot;time&quot;
)

func init()  {
        rand.Seed(time.Now().UnixNano())
}

// Refactor, we add interface later after the concrete.
type Puller interface {
        Pull (d *Data) error
}

type Storer interface {
        Store(d *Data) error
}

// PRIMITIVE API
// ===============================================================
// Data is the structure of the data we are copying
type Data struct {
        Line string
}

// Xenia is the system we need to pull out the data
type Xenia struct {
        Host string
        Timeout time.Duration
}

type Pillar struct {
        Host string
        Timeout time.Duration
}

// Concrete Type Xenia, Since here we use method sets with Pointer semantic then at system need to using addressOf
func (*Xenia) Pull(d *Data) error { //method
        switch rand.Intn(10) {
        case 1, 9:
                return io.EOF

        case 5:
                return errors.New(&quot;Error reading data from Xenia&quot;)

        default:
                d.Line = &quot;Data&quot;
                fmt.Println(&quot;In: &quot;, d.Line)
                return nil
        }
}

// Concrete Type Pilar, Since here we use method sets with Pointer semantic then at system need to using addressOf
func (*Pillar) Store(d *Data) error {
        fmt.Println(&quot;Out :&quot;, d.Line)
        return nil
}
// ===============================================================
// END PRIMITIVE API


// LOWER LEVEL API
// ===============================================================

// We Change To Puller interface, interface is reference type, must use value semantic
// So We can create multiple concrete type on primitive level, this function work
func pull(p Puller, data []Data) (int, error)  {
        for i := range data {
                if err := p.Pull(&amp;data[i]); err != nil { // we pass to primitive layer pull
                        return i, err
                }
        }
        return len(data), nil
}

// We Change To Storer interface, interface is reference type, must use value semantic
// So We can create multiple concrete type on primitive level, this function work
func store(s Storer, data []Data) (int, error) {
        for i := range data {
                if err := s.Store(&amp;data[i]); err != nil {
                        return i, err
                }
        }
        return len(data), nil
}
// ===============================================================
// END LOWER LEVEL API



// High Level API
// We change to PullStorer interface
// We use back system it self, since PullStorer is interface Polution
// ===============================================================
//func Copy (ps PullStorer, batch int) error {
// remove System , is not precise, we make more precise api and more easier to test
// func Copy (sys *System, batch int) error {

func Copy (p Puller, s Storer, batch int) error {
        data := make([]Data, batch)

        for {
                i, err := pull(p, data)
                if i &gt; 0 {
                        if _, err := store(s, data[:i]); err != nil {
                                return err
                        }
                }

                if err != nil {
                        return err
                }
        }
}
// ===============================================================
// End High Level API


// remove System
func main() {

        p := Xenia{
                Host:    &quot;localhost:8000&quot;,
                Timeout: time.Second,
        }

        s := Pillar{
                Host:    &quot;localhost:8000&quot;,
                Timeout: time.Second,
        }

        if err := Copy(&amp;p, &amp;s,3); err != io.EOF {
                fmt.Println(err)
        }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3647">
<h3 id="_conversion_assertion">21.9. Conversion &amp; Assertion</h3>
<div class="listingblock golang has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3650">
<div class="content">
<pre class="CodeRay highlight"><code>package main

import &quot;fmt&quot;

type Mover interface {
        Move()
}

type Locker interface {
        Lock()
        Unlock()
}

type MoverLocker interface {
        Mover
        Locker
}

// Why got this kind, for some reason you might wanna have method base api.
// and there is no state. we took the bike as a namespace.
type bike struct {}

func (bike) Move()  {
        fmt.Println(&quot;Moving the bike&quot;)
}

func (bike) Lock()  {
        fmt.Println(&quot;Lock the bike&quot;)
}

func (bike) Unlock()  {
        fmt.Println(&quot;Unlock the bike&quot;)
}

func main() {
        var ml MoverLocker
        var m Mover

        ml = bike{}

        m = ml // ok

        ml = m //NOT OK, m not implement Locker interface

        fmt.Println(ml)
        fmt.Println(m)

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3701">
<p><span class="image"><img src="image/396.jpeg" alt="396"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3703">
<p><strong>HOWEVER</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3705">
<p>In go have Type Assertion</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3707">
<p><strong>Go allow you to asked a question about the concrete data that is stored
is able to convert or not</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3710">
<p><strong>Remember type Assertion is happen at run-time</strong></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3713">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import &quot;fmt&quot;

type Mover interface {
        Move()
}

type Locker interface {
        Lock()
        Unlock()
}

type MoverLocker interface {
        Mover
        Locker
}

// Why got this kind, for some reason you might wanna have method base api.
// and there is no state. we took the bike as a namespace.
type bike struct {}

func (bike) Move()  {
        fmt.Println(&quot;Moving the bike&quot;)
}

func (bike) Lock()  {
        fmt.Println(&quot;Lock the bike&quot;)
}

func (bike) Unlock()  {
        fmt.Println(&quot;Unlock the bike&quot;)
}

func main() {
        var ml MoverLocker
        var m Mover

        ml = bike{}

        m = ml // ok

        ml = m // nok

    fmt.Println(ml)
        fmt.Println(m)

        //TYPE ASSERTION, as GO is m.(bike) , is concrete value sitting inside m is a bike value?
        // if is true, since we use value semantic then b will be a copy of bike from m
        b, ok := m.(bike)
        if ok {
                fmt.Println(b)
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3770">
<p>Type assertion is powerful. you can take a look into built in
lib from io package.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3775">
<div class="title">Here the package io, it allow to check by type assertion</div>
<p>for user to override the default behaviour.
if the concrete data src also implement WriterTo,
then don&#8217;t execute the default code, mean the default is overrided
by user implementation WriterTo</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3780">
<p><span class="image"><img src="image/397.jpeg" alt="397"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3782">
<p><strong>This is powerful for designing api</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3784">
<p>if the API have default behaviour and by using and interface
can override the default behaviour.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3788">
<p><span class="image"><img src="image/398.jpeg" alt="398"></span></p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3792">
<h4 id="_interface_pollution">21.9.1. Interface Pollution</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3794">
<p><span class="image"><img src="image/399.jpeg" alt="399"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3796">
<p><span class="image"><img src="image/400.jpeg" alt="400"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3798">
<p>To Fix, remove the interface</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3800">
<p><span class="image"><img src="image/401.jpeg" alt="401"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3802">
<p><span class="image"><img src="image/402.jpeg" alt="402"></span></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3805">
<h4 id="_mocking">21.9.2. Mocking</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3807">
<p>Here there no reason we create an interface.
the user who use this api is need to create their own interface for mocking to test</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3811">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

// PubSub provides access to a queue system
type PubSub struct {
        host string
        // ...
}

// factory func
func New(host string) *PubSub  {
        p := PubSub{
                host:&quot;localhost&quot;,
        }
        // ...
        return &amp;p;
}

// publish sends the data for the specified key
func (ps *PubSub) Publish(key string, v interface{}) error {

        //...
        return nil
}


// subscribe sets up an request to receive messages for the specified key
func (ps *PubSub) Subscribe(key string) error {

        //...
        return nil
}


func main() {

}</code></pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3850">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3850">
<p>User who use this API can provide their interface for their test class</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3852">
<p><span class="image"><img src="image/403.jpeg" alt="403"></span></p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3855">
<h3 id="_design_guideline">21.10. Design Guideline</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3857">
<p><span class="image"><img src="image/404.jpeg" alt="404"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3860">
<h3 id="_error_handling">21.11. Error Handling</h3>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3862">
<h4 id="_default_error_values">21.11.1. Default Error Values</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3865">
<div class="title">similar like try catch, follow this pattern don&#8217;t use if else. happy path is at the next block of if.</div>
<p>if have err then err != nill
<span class="image"><img src="image/405.jpeg" alt="405"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3868">
<p>use switch instead of if else</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3870">
<p><span class="image"><img src="image/406.jpeg" alt="406"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3872">
<p><strong>nil in go is the zero value of pointer and reference type only</strong></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3874">
<h4 id="_error_values">21.11.2. Error Values</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3876">
<p><span class="image"><img src="image/407.jpeg" alt="407"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3878">
<p><span class="image"><img src="image/408.jpeg" alt="408"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3881">
<div class="title">handle the error , store it into err, then using switch to check</div>
<p>is this variable or that variable
<span class="image"><img src="image/409.jpeg" alt="409"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3884">
<p>this is the error api does, we must try to use the error interface,
if we force to create our own error because the error string type
cannot provide enough context for we needs.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3888">
<h4 id="_type_as_context">21.11.3. Type as Context</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3890">
<p>customer error type from json package</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3892">
<p><span class="image"><img src="image/410.jpeg" alt="410"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3894">
<p><span class="image"><img src="image/411.jpeg" alt="411"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3896">
<p><span class="image"><img src="image/412.jpeg" alt="412"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3900">
<div class="title">type is context. with type assertion we get the copy what is stored at the interface</div>
<p><span class="image"><img src="image/413.jpeg" alt="413"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3903">
<div class="title">above is super cool, however my causeing cascading side effect change.</div>
<p>because we try to get the thing that have decoupled.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3905">
<p>another good one is using behaviour as context</p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3907">
<h4 id="_behavior_as_context">21.11.4. Behavior as Context</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3910">
<div class="title">Type Context</div>
<p><span class="image"><img src="image/414.jpeg" alt="414"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3912">
<p><span class="image"><img src="image/415.jpeg" alt="415"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3914">
<p><span class="image"><img src="image/416.jpeg" alt="416"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3918">
<div class="title">when like this, is also true all concrete data from net package</div>
<p>that implementing temporary interface also implementing our interface.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3920">
<p><span class="image"><img src="image/417.jpeg" alt="417"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3924">
<div class="title">hence with that above code we can move to 1 case using the behaviour context</div>
<p><span class="image"><img src="image/418.jpeg" alt="418"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3926">
<p><span class="image"><img src="image/419.jpeg" alt="419"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3928">
<p><strong>GENERAL RULE FOR CUSTOM ERRO</strong></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3930">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3930">
<p>if you custom error type can have any 1 of this 4 method
and doesn&#8217;t need to have all of them, just 1 method,
then the custom error type must to be defined as unexported with unexported field.
because you are forcing that your user can&#8217;t never ever from decoupled state to the concrete state</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3935">
<p>What is the 4 method :</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3937">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3937">
<p>Temporary()</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3939">
<p>Timeout()</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3941">
<p>NotFound</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3943">
<p>NotAuthorize()</p>
</li>
</ul>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3946">
<h4 id="_find_a_bug">21.11.5. Find a <strong>Bug</strong></h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3948">
<p><span class="image"><img src="image/420.jpeg" alt="420"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3950">
<p>why ABove fail? we return nil on fail function.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3952">
<p>The reason is :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3954">
<p><span class="image"><img src="image/422.jpeg" alt="422"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3957">
<div class="title">to fix the bug</div>
<p><span class="image"><img src="image/421.jpeg" alt="421"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3960">
<p><strong>PLEASE ALWAYS REMEMBER THIS</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3962">
<p>INTERFACE ARE VALUE LESS, when you passing interface as paramater, you are not
passing the interface, because interface is doesn&#8217;t exits, what you pass is
what is the concrete data inside the interface content.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3966">
<p><strong>HENCE WITH THAT AVOID TO IMPLEMENT VALUE SEMANTIC USING STRUCT</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3968">
<p><span class="image"><img src="image/423.jpeg" alt="423"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3971">
<div class="title">2 new data will never be same address</div>
<p><span class="image"><img src="image/424.jpeg" alt="424"></span></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3975">
<h4 id="_wrapping_error">21.11.6. Wrapping Error</h4>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-3978">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">package main

import (
        &quot;fmt&quot;
        &quot;github.com/pkg/errors&quot;
)

// AppError represents a custom error type.
type AppError struct {
        State int
}

// Error implements the error interface.
func (c *AppError) Error() string {
        return fmt.Sprintf(&quot;App Error, State: %d&quot;, c.State)
}

func main() {

        // Make the function call and validate the error.
        if err := firstCall(10); err != nil {

                // Use type as context to determine cause.
                switch v := errors.Cause(err).(type) {
                case *AppError:

                        // We got our custom error type.
                        fmt.Println(&quot;Custom App Error:&quot;, v.State)

                default:

                        // We did not get any specific error type.
                        fmt.Println(&quot;Default Error&quot;)
                }

                // Display the stack trace for the error.
                fmt.Println(&quot;\nStack Trace\n********************************&quot;)
                fmt.Printf(&quot;%+v\n&quot;, err) // %+v it will print the stack trace.
                fmt.Println(&quot;\nNo Trace\n********************************&quot;)
                fmt.Printf(&quot;%v\n&quot;, err) // without stack trace
        }

}

// firstCall makes a call to a second function and wraps any error.
func firstCall(i int) error {
        if err := secondCall(i); err != nil {
                return errors.Wrapf(err, &quot;firstCall-&gt;secondCall(%d)&quot;, i)
        }
        return nil
}

// secondCall makes a call to a third function and wraps any error.
func secondCall(i int) error {
        if err := thirdCall(); err != nil {
                return errors.Wrap(err, &quot;secondCall-&gt;thirdCall()&quot;)
        }
        return nil
}

// thirdCall create an error value we will validate.
func thirdCall() error {
        return &amp;AppError{99}
}</code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4046">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">Custom App Error: 99

Stack Trace
********************************
App Error, State: 99
secondCall-&gt;thirdCall()
main.secondCall
        /Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/main.go:56
main.firstCall
        /Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/main.go:47
main.main
        /Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/main.go:21
runtime.main
        /usr/local/go/src/runtime/proc.go:225
runtime.goexit
        /usr/local/go/src/runtime/asm_amd64.s:1371
firstCall-&gt;secondCall(10)
main.firstCall
        /Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/main.go:48
main.main
        /Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/main.go:21
runtime.main
        /usr/local/go/src/runtime/proc.go:225
runtime.goexit
        /usr/local/go/src/runtime/asm_amd64.s:1371

No Trace
********************************
firstCall-&gt;secondCall(10): secondCall-&gt;thirdCall(): App Error, State: 99</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4078">
<h3 id="_packaging">21.12. Packaging</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4080">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4080">
<p>Packaging directly conflicts with how we have been taught to organize source code in other languages.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4081">
<p>In other languages, packaging is a feature that you can choose to use or ignore.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4082">
<p>You can think of packaging as applying the idea of microservices on a source tree.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4083">
<p>All packages are "first class," and the only hierarchy is what you define in the source tree for your project.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4084">
<p>There needs to be a way to “open” parts of the package to the outside world.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4085">
<p>Two packages can’t cross-import each other. Imports are a one way street.</p>
</li>
</ul>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4088">
<h3 id="_design_guideline_2">21.13. Design Guideline</h3>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4090">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4090">
<p><strong>To be purposeful</strong>, packages must provide, not contain.</p>
<div class="olist loweralpha has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4091">
<ol class="loweralpha">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4091">
<p>Packages must be named with the intent to describe what it provides.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4092">
<p>Packages must not become a dumping ground of disparate concerns.</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4094">
<div class="content">
<pre>Example package named like model, common , util is a big problem</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4096">
<p><strong>To be usable</strong>, packages must be designed with the user as their focus.</p>
<div class="olist loweralpha has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4098">
<ol class="loweralpha">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4098">
<p>Packages must be intuitive and simple to use.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4099">
<p>Packages must respect their impact on resources and performance.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4100">
<p>Packages must protect the user’s application from cascading changes.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4101">
<p>Packages must prevent the need for type assertions to the concrete.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4102">
<p>Packages must reduce, minimize and simplify its code base.</p>
</li>
</ol>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4104">
<p><strong>To be portable</strong>, packages must be designed with reusability in mind.</p>
<div class="olist loweralpha has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4106">
<ol class="loweralpha">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4106">
<p>Packages must aspire for the highest level of portability.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4107">
<p>Packages must reduce setting policy when it’s reasonable and practical.</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4109">
<div class="content">
<pre>the more pakcage have policy the less package become resuable.</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4111">
<p>Packages must not become a single point of dependency.</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4113">
<div class="content">
<pre>especially package like model</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4116">
<h3 id="_package_oriented_design">21.14. Package Oriented Design</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4119">
<p>refer to te code in folder : service folder</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4122">
<p><span class="image"><img src="image/426.jpeg" alt="426"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4124">
<p><span class="image"><img src="image/427.jpeg" alt="427"></span>
<span class="image"><img src="image/428.jpeg" alt="428"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4127">
<p><span class="image"><img src="image/429.jpeg" alt="429"></span>
<span class="image"><img src="image/430.jpeg" alt="430"></span>
<span class="image"><img src="image/431.jpeg" alt="431"></span>
<span class="image"><img src="image/432.jpeg" alt="432"></span>
<span class="image"><img src="image/433.jpeg" alt="433"></span></p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4133">
<h4 id="_kit_project">21.14.1. Kit project</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4135">
<p>set of the foundational packages / api
that every application you built should use
example:</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4139">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4139">
<p>log packagaes is we are not using standard library</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4140">
<p>config pakcages if your are not using some third-party stuff , web framework , etc..</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4142">
<p>and all kit packages is layout on the top of the code repository</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4144">
<p>and no packages inside the packages.
and all packages must be decoupled from each others.
example there is no log imported config or vice versa.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4148">
<p>this foundational package should not log either.
if this packages have go routines and you wanna log,
then you can ask the handler function and user can implement
what ever then want by implement the handler function
and we call it durent the go routine event. so we don&#8217;t need interfaces
all the time asking function like handler function really  can streamline
everything and then get you logging that you need.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4157">
<p>so kit is own repo, foundational stuff.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4159">
<h4 id="_application">21.14.2. Application</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4161">
<p>Every dev work on application project</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4163">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4163">
<p>cmd/</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4165">
<p>internal/</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4167">
<div class="content">
<pre>platform/</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4169">
<p>vendors/</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4171">
<p>When we talking about vendor folder we gonna be called <strong>dep</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4173">
<p>in dep tools if you type <strong>dep init</strong> dep will ensure
and dep will looking in all dependency package including kit
kit will be thidrparty package and you mantain of all copy of source code
and the version that you need this to own your own source code you need
and once you get largest project as biggest kubernetes you should be be
able to own your source code for this third-library source code that you working with</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4180">
<p>use <strong>DEP</strong></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4182">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4182">
<p>cmd/</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4184">
<p>is were the application are, main.go seat in here.
it can be 1 to many. more than 1 binaries.
example in cmd have <strong>crud</strong> and <strong>sidecar</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4188">
<p><strong>crud</strong> here is web project base and have it main.go and <strong>crud</strong> will be the name of the binaries.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4190">
<p><strong>sidecar</strong> inside the sidecar have two binaries <strong>metric</strong> and <strong>tracer</strong>.
is for microservice to handle tracer and metric for the service
and <strong>tracer</strong> have main.go and <strong>metric</strong> have main.go
so the binaries is <strong>tracer</strong> and <strong>metric</strong>.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4195">
<p>so have 3 binaries we build with 3 main.go</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4197">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4197">
<p>package in crud, is application specific,
example for start, shutdown or maybe some small route for web service.
but not allowed to any business logic, so is like an presentational logic
taking a request and returning a response.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4202">
<p>internal/</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4204">
<p>internal folder is were we put our business logic. business service layer logic</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4206">
<p>it should be resuable to multiple binaries, but only really business service logic.</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4208">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4208">
<p>internal/platform</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4210">
<p>is for foundational packages that not inside of kit.</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4212">
<div class="content">
<pre>e.g :
database support
docker support
test support
flag support
etc ..</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4221">
<p><strong>Don&#8217;t import any package if you only need a type, like importing model</strong> why can you package
have it own model and it own type. why we have to create the dependency binding.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4224">
<p><strong>Minimize imported package on the same level</strong> then more we can decoupled that is the better especially in
internal level*</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4227">
<p>platform is little harder. but internal level should able to maintain decoupled.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4229">
<p>when you maintain to change a line of code that reduce your decoupled on internal level
you can define to hierrchy that packages inside the pakcages that you need to imported</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4232">
<p>rule importing :</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4234">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4234">
<p>any package inside the cmd has ability to import inside the internal and platform
you can always import down, you can&#8217;t import up
mean cmd import &#8594; internal or internal/platform import &#8594; vendors
plaform can&#8217;t import internal and can&#8217;t import cmd</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4239">
<h2 id="_go_routines">22. GO ROUTINES</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4242">
<h3 id="_synchronization_and_orchestration">22.1. Synchronization and Orchestration</h3>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4244">
<h4 id="_waitgroup">22.1.1. Waitgroup</h4>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4247">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">func</span> init() {

        <span style="color:#777">// allocate 1 logical processor for the scheduler to use.</span>
        <span style="color:#777">// p = 1, single threaded</span>
        runtime.GOMAXPROCS(<span style="color:#00D">1</span>)
}

<span style="color:#080;font-weight:bold">func</span> main() {

        <span style="color:#777">//wg is used to manage concurrency</span>
        <span style="color:#777">// tell to create how many go routine,</span>
        <span style="color:#777">// and only after all go routine said Done mean the go routine finish until the counter to zero</span>
        <span style="color:#080;font-weight:bold">var</span> wg sync.WaitGroup
        wg.Add(<span style="color:#00D">2</span>)

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Start Go Routines</span><span style="color:#710">&quot;</span></span>)

        <span style="color:#777">// create go routines from the lowercase function</span>
        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                lowercase()
                wg.Done()
        }()

        <span style="color:#777">// create go routines from the uppercase function</span>
        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                uppercase()
                wg.Done()
        }()

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Waiting process to be done</span><span style="color:#710">&quot;</span></span>)
        <span style="color:#777">// blocking call api.</span>
        wg.Wait()

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">System done processing</span><span style="color:#710">&quot;</span></span>)
}

<span style="color:#080;font-weight:bold">func</span> lowercase() {
        <span style="color:#080;font-weight:bold">for</span> count := <span style="color:#00D">0</span>; count &lt; <span style="color:#00D">3</span>; count++ {
                <span style="color:#080;font-weight:bold">for</span> r := <span style="color:#D20">'a'</span>; r &lt;= <span style="color:#D20">'z'</span>; r++ {
                        fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">%c </span><span style="color:#710">&quot;</span></span>, r)
                }
        }
}

<span style="color:#080;font-weight:bold">func</span> uppercase() {
        <span style="color:#080;font-weight:bold">for</span> count := <span style="color:#00D">0</span>; count &lt; <span style="color:#00D">3</span>; count++ {
                <span style="color:#080;font-weight:bold">for</span> r := <span style="color:#D20">'A'</span>; r &lt;= <span style="color:#D20">'Z'</span>; r++ {
                        fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">%c </span><span style="color:#710">&quot;</span></span>, r)
                }
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4301">
<p><span class="image"><img src="image/434.jpeg" alt="434"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4305">
<div class="title">with 2 P we can see it run parallel.</div>
<p><span class="image"><img src="image/435.jpeg" alt="435"></span></p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4308">
<h3 id="_data_races">22.2. Data Races</h3>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4310">
<h4 id="_cache_coherency_and_false_sharing">22.2.1. Cache Coherency and False Sharing</h4>
<div class="olist arabic has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4312">
<ol class="arabic">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4312">
<p>You cannot access 1 thread read and 1 thread write into same memory address location
this is why synchronization came in.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4315">
<p><span class="image"><img src="image/436.jpeg" alt="436"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4319">
<div class="title">Synchronization issue.</div>
<p><span class="image"><img src="image/437.jpeg" alt="437"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4322">
<div class="title">False sharing in Synchronization issue.</div>
<p><span class="image"><img src="image/438.jpeg" alt="438"></span></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4325">
<h4 id="_synchronization_with_atomic_function">22.2.2. Synchronization with Atomic Function</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4328">
<div class="title">this is issue and is not atomic</div>
<p><span class="image"><img src="image/439.jpeg" alt="439"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4330">
<p><span class="image"><img src="image/440.jpeg" alt="440"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4333">
<div class="title">WHY the adding 1 fmt.println the result is bugs?</div>
<p><span class="image"><img src="image/441.jpeg" alt="441"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4336">
<div class="title">every time system call, is a context switch.</div>
<p><span class="image"><img src="image/442.jpeg" alt="442"></span></p>
</div>
<div class="sect4 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4339">
<h5 id="_solution_1_using_atomic_instruction">Solution 1 , Using atomic instruction</h5>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4341">
<p>but atomic instruction only 8 byte, is suiteable for counter case like this.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4343">
<p><span class="image"><img src="image/443.jpeg" alt="443"></span></p>
</div>
</div>
<div class="sect4 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4347">
<h5 id="_solution21_using_mutex">Solution21 , Using Mutex</h5>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4350">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> main

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sync</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// counter is a variable incremented by all goroutines.</span>
<span style="color:#080;font-weight:bold">var</span> counter <span style="color:#0a8;font-weight:bold">int64</span>

<span style="color:#080;font-weight:bold">var</span> mutex sync.Mutex

<span style="color:#080;font-weight:bold">func</span> main() {
        <span style="color:#777">// Number of goroutines to use.</span>
        <span style="color:#080;font-weight:bold">const</span> grs = <span style="color:#00D">2</span>

        <span style="color:#080;font-weight:bold">var</span> wg sync.WaitGroup
        wg.Add(grs)

        <span style="color:#777">// Create two goroutines.</span>
        <span style="color:#080;font-weight:bold">for</span> g := <span style="color:#00D">0</span>; g &lt; grs; g++ {
                <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; <span style="color:#00D">2</span>; i++ {

                                mutex.Lock()
                                {
                                        <span style="color:#777">// Capture the value of counter.</span>
                                        value := counter

                                        <span style="color:#777">// Increment our local value of counter.</span>
                                        value++

                                        fmt.Println(value)

                                        <span style="color:#777">// Store the value back into counter.</span>
                                        counter = value
                                }
                                mutex.Unlock()

                        }

                        wg.Done()
                }()
        }

        <span style="color:#777">// Wait for the goroutines to finish.</span>
        wg.Wait()

        <span style="color:#777">// Display the final value.</span>
        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Final Counter:</span><span style="color:#710">&quot;</span></span>, counter)
}

printed

<span style="color:#00D">1</span>
<span style="color:#00D">2</span>
<span style="color:#00D">3</span>
<span style="color:#00D">4</span>
Final Counter: <span style="color:#00D">4</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4412">
<p>Above we using mutex, mutex.lock() and mutex.unlock() to be a atomic opration.
we don&#8217;t really use mutex as global variable, <strong>and mostly mutex is some field
can be some struct, and once you have a struct is mutex that struct
can&#8217;t longer be copy</strong> a copy a struct mutex you will get new struct mutex,
is all value semantic here.
make sure we never copy value inside of mutex.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4420">
<p><span class="image"><img src="image/444.jpeg" alt="444"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4422">
<p>this how mutex work, only 1 go routine to execution the line of code, the rest need to wait.
once the go routine finish then the next go routine can come to execute.
need to pay attention on this, you are blocking and have latency concern.
make sure the opration of the block code is really need a atomic operation.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4427">
<p>the line who come in first is manage by go routine scheduler, and is a fair algorithm from the scheduler.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4429">
<p>remember lock and unlock must within in 1 function, cannot 1 function lock call other function to unlock
always be together.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4432">
<p>1 more thing if you do system call inside the mutex, you need to think the latency
remember system call will cause context switch.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4435">
<p><span class="image"><img src="image/445.jpeg" alt="445"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4437">
<p><span class="image"><img src="image/446.jpeg" alt="446"></span></p>
</div>
</div>
<div class="sect4 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4440">
<h5 id="_readwrite_mutex">ReadWrite Mutex</h5>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4442">
<p>For purpose, allow to read same memory but once it write no any go routine can access.</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4445">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">math/rand</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sync</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sync/atomic</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// data is a slice that will be shared.</span>
<span style="color:#080;font-weight:bold">var</span> data []<span style="color:#0a8;font-weight:bold">string</span>

<span style="color:#777">// rwMutex is used to define a critical section of code.</span>
<span style="color:#080;font-weight:bold">var</span> rwMutex sync.RWMutex

<span style="color:#777">// Number of reads occurring at ay given time.</span>
<span style="color:#080;font-weight:bold">var</span> readCount <span style="color:#0a8;font-weight:bold">int64</span>

<span style="color:#777">// init is called prior to main.</span>
<span style="color:#080;font-weight:bold">func</span> init() {
        rand.Seed(time.Now().UnixNano())
}

<span style="color:#080;font-weight:bold">func</span> main() {

        <span style="color:#777">// wg is used to manage concurrency.</span>
        <span style="color:#080;font-weight:bold">var</span> wg sync.WaitGroup
        wg.Add(<span style="color:#00D">1</span>)

        <span style="color:#777">// Create a writer goroutine.</span>
        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; <span style="color:#00D">10</span>; i++ {
                        writer(i)
                }
                wg.Done()
        }()

        <span style="color:#777">// Create eight reader goroutines.</span>
        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; <span style="color:#00D">8</span>; i++ {
                <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>(id <span style="color:#0a8;font-weight:bold">int</span>) {
                        <span style="color:#080;font-weight:bold">for</span> {
                                reader(id)
                        }
                }(i)
        }

        <span style="color:#777">// Wait for the write goroutine to finish.</span>
        wg.Wait()
        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Program Complete</span><span style="color:#710">&quot;</span></span>)
}

<span style="color:#777">// writer adds a new string to the slice in random intervals.</span>
<span style="color:#080;font-weight:bold">func</span> writer(i <span style="color:#0a8;font-weight:bold">int</span>) {

        <span style="color:#777">// Only allow one goroutine to read/write to the slice at a time.</span>
        rwMutex.Lock()
        {
                <span style="color:#777">// Capture the current read count.</span>
                <span style="color:#777">// Keep this safe though we can due without this call.</span>
                rc := atomic.LoadInt64(&amp;readCount)

                <span style="color:#777">// Perform some work since we have a full lock.</span>
                time.Sleep(time.Duration(rand.Intn(<span style="color:#00D">100</span>)) * time.Millisecond)
                fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">****&gt; : Performing Write : RCount[%d]</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>, rc)
                data = <span style="color:#369;font-weight:bold">append</span>(data, fmt.Sprintf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">String: %d</span><span style="color:#710">&quot;</span></span>, i))
        }
        rwMutex.Unlock()
        <span style="color:#777">// Release the lock.</span>
}

<span style="color:#777">// reader wakes up and iterates over the data slice.</span>
<span style="color:#080;font-weight:bold">func</span> reader(id <span style="color:#0a8;font-weight:bold">int</span>) {

        <span style="color:#777">// Any goroutine can read when no write operation is taking place.</span>
        rwMutex.RLock()
        {
                <span style="color:#777">// Increment the read count value by 1.</span>
                rc := atomic.AddInt64(&amp;readCount, <span style="color:#00D">1</span>)

                <span style="color:#777">// Perform some read work and display values.</span>
                time.Sleep(time.Duration(rand.Intn(<span style="color:#00D">10</span>)) * time.Millisecond)
                fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">%d : Performing Read : Length[%d] RCount[%d]</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>, id, <span style="color:#369;font-weight:bold">len</span>(data), rc)

                <span style="color:#777">// Decrement the read count value by 1.</span>
                atomic.AddInt64(&amp;readCount, <span style="color:#00D">-1</span>)
        }
        rwMutex.RUnlock()
        <span style="color:#777">// Release the read lock.</span>
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4536">
<p>What is the sync (read &amp; write) here is the slice &#8594; len() of the slice,</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4538">
<p>RWMutex is more slower compare to Mutex</p>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4541">
<h3 id="_race_detection">22.3. Race Detection</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4544">
<p>this powerful feature from go to check data race.</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4546">
<div class="content">
<pre>go build -race</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4548">
<div class="content">
<pre>go test -race</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4550">
<div class="content">
<pre>go run -race</pre>
</div>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4554">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> main

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sync</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// counter is a variable incremented by all goroutines.</span>
<span style="color:#080;font-weight:bold">var</span> counter <span style="color:#0a8;font-weight:bold">int64</span>


<span style="color:#080;font-weight:bold">func</span> main() {
        <span style="color:#777">// Number of goroutines to use.</span>
        <span style="color:#080;font-weight:bold">const</span> grs = <span style="color:#00D">2</span>

        <span style="color:#080;font-weight:bold">var</span> wg sync.WaitGroup
        wg.Add(grs)

        <span style="color:#777">// Create two goroutines.</span>
        <span style="color:#080;font-weight:bold">for</span> g := <span style="color:#00D">0</span>; g &lt; grs; g++ {
                <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() { <span style="color:#777">//line 21</span>
                        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; <span style="color:#00D">2</span>; i++ {

                                <span style="color:#777">// Capture the value of counter.</span>
                                value := counter <span style="color:#777">//line 25</span>

                                <span style="color:#777">// Increment our local value of counter.</span>
                                value++

                                <span style="color:#777">// Store the value back into counter.</span>
                                counter = value <span style="color:#777">//line 31</span>


                        }

                        wg.Done()
                }()
        }

        <span style="color:#777">// Wait for the goroutines to finish.</span>
        wg.Wait()

        <span style="color:#777">// Display the final value.</span>
        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Final Counter:</span><span style="color:#710">&quot;</span></span>, counter)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4602">
<p>above code is our previous problem code, which if you adding system call
to print the value causing context switch and you get the final result
Final Counter is 2 not 4.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4606">
<p>with</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4608">
<div class="content">
<pre>go run -race</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4611">
<p>You get the stack trace.
How to Read the problem?</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4615">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">==================
WARNING: DATA RACE
Read at 0x00000122ecb0 by goroutine 8:
  main.main.func1()
      /Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/main.go:25 +0x47

Previous write at 0x00000122ecb0 by goroutine 7:
  main.main.func1()
      /Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/main.go:31 +0x64

Goroutine 8 (running) created at:
  main.main()
      /Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/main.go:21 +0xaf

Goroutine 7 (finished) created at:
  main.main()
      /Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/main.go:21 +0xaf
==================
Final Counter: 4
Found 1 data race(s)
exit status 66</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4639">
<p>How To Read the problem :</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4641">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4641">
<p>you created go routine 7 at line 21 and created go routine 8 at line 21</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4643">
<p>and go routine 8 is read at memory 0x00000122ecb0  (line 25) while there is a
go routine 7 do a write to 0x00000122ecb0 (line 31)</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4646">
<p>see the found data race 1 &#8594; this is issue</p>
</li>
</ul>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4649">
<h4 id="_map_data_race">22.3.1. MAP DATA RACE</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4651">
<p><strong>@IMPORTANT</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4653">
<p><strong>Accessing a Map in go is not inheritly synchronous</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4655">
<p>you need to build the synchronize for map</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4657">
<p><strong>See the runtime automactically tell you once you run the application</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4659">
<p><span class="image"><img src="image/447.jpeg" alt="447"></span></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4663">
<h4 id="_interface_base_data_race">22.3.2. Interface base Data RACE</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4665">
<p>This code have syncronize issue (Data race issue)
write</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4669">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> main

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">os</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sync</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">type</span> Speaker <span style="color:#080;font-weight:bold">interface</span> {
        Speak() <span style="color:#0a8;font-weight:bold">bool</span>
}

<span style="color:#080;font-weight:bold">type</span> Ben <span style="color:#080;font-weight:bold">struct</span> {
        name <span style="color:#0a8;font-weight:bold">string</span>
}

<span style="color:#777">// Speak allow ben to say hello,</span>
<span style="color:#777">// it return false if the method is called through the interface value after partial write</span>
<span style="color:#777">// if come here and is not Ben then is data race issue</span>
<span style="color:#080;font-weight:bold">func</span> (b *Ben) Speak() <span style="color:#0a8;font-weight:bold">bool</span> {
        <span style="color:#080;font-weight:bold">if</span> b.name != <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Ben</span><span style="color:#710">&quot;</span></span> {
                fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Ben say, hello </span><span style="color:#b0b">\&quot;</span><span style="color:#D20"> my name is %s</span><span style="color:#b0b">\&quot;</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>, b.name)
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">false</span>
        }

        <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">true</span>
}


<span style="color:#080;font-weight:bold">type</span> Jerry <span style="color:#080;font-weight:bold">struct</span> {
        name <span style="color:#0a8;font-weight:bold">string</span>
}

<span style="color:#777">// Speak allow jerry to say hello,</span>
<span style="color:#777">// it return false if the method is called through the interface value after partial write</span>
<span style="color:#777">// if come here and is not Jerry then is data race issue</span>
<span style="color:#080;font-weight:bold">func</span> (j *Jerry) Speak() <span style="color:#0a8;font-weight:bold">bool</span> {
        <span style="color:#080;font-weight:bold">if</span> j.name != <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Jerry</span><span style="color:#710">&quot;</span></span> {
                fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Jerry say, hello </span><span style="color:#b0b">\&quot;</span><span style="color:#D20"> my name is %s</span><span style="color:#b0b">\&quot;</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>, j.name)
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">false</span>
        }

        <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">true</span>
}

<span style="color:#080;font-weight:bold">func</span> main()  {

        <span style="color:#777">//create value of type Ben &amp; Jerry</span>
        ben := Ben{<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Ben</span><span style="color:#710">&quot;</span></span>}
        jerry := Jerry{<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Jerry</span><span style="color:#710">&quot;</span></span>}

        <span style="color:#777">// Assign the pointer to the Ben value to the interface</span>
        person := Speaker(&amp;ben)


        <span style="color:#777">// have go routines constantly assign</span>
        <span style="color:#777">// the pointer of the Ben value to the interface and then speak</span>
        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                <span style="color:#080;font-weight:bold">for</span> {
                        person = &amp;ben
                        <span style="color:#080;font-weight:bold">if</span>(!person.Speak()) {
                                os.Exit(<span style="color:#00D">1</span>)
                        }
                }
        }()

        <span style="color:#777">// have go routines constantly assign</span>
        <span style="color:#777">// the pointer of the Jerry value to the interface and then speak</span>
        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                <span style="color:#080;font-weight:bold">for</span> {
                        person = &amp;jerry <span style="color:#777">// line 71</span>
                        <span style="color:#080;font-weight:bold">if</span>(!person.Speak()) {
                                os.Exit(<span style="color:#00D">1</span>)
                        }
                }
        }()


        <span style="color:#777">//Just hold the main from returning</span>
        <span style="color:#777">// the data race will cause the program to exit</span>
        <span style="color:#080;font-weight:bold">var</span> wg sync.WaitGroup
        wg.Add(<span style="color:#00D">1</span>)
        wg.Wait()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4757">
<p><span class="image"><img src="image/450.jpeg" alt="450"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4759">
<p><span class="image"><img src="image/448.jpeg" alt="448"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4762">
<p><span class="image"><img src="image/449.jpeg" alt="449"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4764">
<p><span class="image"><img src="image/451.jpeg" alt="451"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4766">
<p>the code illustration :</p>
</div>
<div class="olist arabic has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4768">
<ol class="arabic">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4768">
<p>we use 1 interface person and assign into ben on jerry from 2 go routine.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4769">
<p>remember interface hold a type of the concrete data and 1 pointer pointing to the concrete data value.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4772">
<p>Above why Jerry say his name is BEN.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4774">
<p>*Because we have 2 go routine run on multiple core,
 and the word say "Jerry say"
 at this moment the interface are holding Jerry pointer inside the interface
 but the go routine which previously hold ben haven done call speak,
 so the pointer it still pointing to ben, hence the moment write person to Jerry
 the other go routing call speak which is pointing to ben.</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4781">
<div class="content">
<pre>In other words see the below contain of the interface,
if have a pointer to type of the data and 1 pointer to the concrete data value.
so have 2 operation here,</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4785">
<div class="content">
<pre>1 need to change the concrete data type
2 need to change the pointer pointing to the correct data</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4788">
<div class="content">
<pre>on the half way change to concrete data type Jerry
before go routine call speak() which is the pointer to concrete data is still pointing to ben</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4791">
<div class="content">
<pre>thats why you get *Jerry say my name is ben*.</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4793">
<div class="content">
<pre>*Jerry say my name is*
 =&gt; inerface pointer data type is Jerry</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4796">
<div class="content">
<pre>*ben*
=&gt; the pointer to the concrete data has not done replaced with jerry concrete data,
only halfway done replaced the interface pointer data type,
so it still pointing to ben concret data type, that why become
. *Jerry say my name is ben*</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4803">
<p><strong>THIS IS THE CONTENT of Person (Speak Interface)</strong></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4805">
<div class="content">
<pre>[*J or *B , what type the data inside the interface]
---------------------------------------------------
[J or B, *Pointer to the concrete data]</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4810">
<p>if you run with data race :</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4812">
<div class="content">
<pre>go build -race // build</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4814">
<div class="content">
<pre>./gofirstapp  //run</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4817">
<p><span class="image"><img src="image/451.jpeg" alt="451"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4819">
<p>you will notice data race issue.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4821">
<p>how ever if you build without data race and run using single core you sometimes you will luck no seeing data race issue</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4823">
<div class="content">
<pre>GOMAXPROCS=1 ./gofirstapp</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4825">
<p><span class="image"><img src="image/452.jpeg" alt="452"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4827">
<p>run with 8 core you directly see the data race issue</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4829">
<div class="content">
<pre>GOMAXPROCS=8 ./gofirstapp</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4831">
<p><span class="image"><img src="image/453.jpeg" alt="453"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4833">
<p><strong>So it very important if you use go routine to have a go build -race</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4835">
<p><strong>This data race issue the code doesn&#8217;t blowing up, it will become a very hard to check the bugs</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4837">
<p><strong>no stack trace error and anything, but data will be really messy</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4839">
<p>The code doesnt blow up because the because the Ben and Jery data structur are identical
they have same exactly memory layout nothing will gona cause the code to blow up
incrementing ben will be same incrementing jerry (it will became the name is same for ben and jerry)</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4843">
<p>the data model is the same against the concrete type</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4846">
<h3 id="_channel">22.4. Channel</h3>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4848">
<h4 id="_channel_semantic_behavior">22.4.1. Channel Semantic / Behavior</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4850">
<p><span class="image"><img src="image/454.jpeg" alt="454"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4853">
<p><strong>Signal With or Without Data</strong></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4855">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4855">
<p>When singaling without data can be done 1 go routine to many go routine.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4856">
<p>When signaling with data only can be 1 go routine to 1 go routine.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4858">
<p><span class="image"><img src="image/455.jpeg" alt="455"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4860">
<p>Delayed Guarantee is use 1 buffer size only to reduce the larger amount latency on orchestration
and can identified problem quickly, like buffer &gt; 1 do.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4863">
<p><span class="image"><img src="image/456.jpeg" alt="456"></span></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4865">
<h4 id="_chanel_state">22.4.2. Chanel State</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4867">
<p>Chanel is reference type, must use value semantic.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4869">
<p>Create a chanel zero value is nil, you cannot create chanel with literal construction with data inside.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4871">
<p>chanel in nil state are cannot received or send any signal</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4873">
<p>chanel can create only using make function</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4875">
<p><strong>you don&#8217;t have to close chanel, close chanel doesn&#8217;t do memory clean up</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4877">
<p><strong>close chanel only changing state from open to close, use for singalin without data</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4879">
<p>when chanel is closed there is no way to reopen the same chanel.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4881">
<p>send signal to close chanel will causing panic,
but you can always receive from close chanel because is how we do the signaling without data</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4885">
<p><strong>IMPORTANT BUFFER WILL NOT GONNA HELP FOR PERFORMANCE</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4887">
<p><strong>Keep in mind we must gonna using small buffer that helping us to reduce
orchestration latency just help to get the wheel keep moving</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4890">
<p><strong>Big enough to keep the wheel moving and small enough to be able to identified
when there a problem upstream , so we dont continue to add into it</strong></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4896">
<h4 id="_basic_channel_pattern">22.4.3. Basic Channel Pattern</h4>
<div class="sect4 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4898">
<h5 id="_wait_for_task">Wait For Task</h5>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4900">
<p>is basic pattern like go routine pooling waiting for task</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4902">
<p><strong>Remember there is no another way to put chanel into opening state. the only way is using built in function make()</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4904">
<p><span class="image"><img src="image/457.jpeg" alt="457"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4907">
<p>Example :</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4909">
<div class="content">
<pre>// unbefered chanel.
ch := make(chan string)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4912">
<div class="content">
<pre>// bueffered chanel
ch := make(chan string, 10)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4916">
<div class="content">
<pre>// This code is saying we wanna guarantee (send and receive at the same time, receiver directly get the data and sender know it get the data) and we gonna signal with string data.
ch := make(chan string)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4919">
<div class="content">
<pre>//
ch := make(chan string)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4922">
<div class="content">
<pre>go func() {
	emp := &lt;-ch
	fmt.Printf("type of channel data %T\n", ch)
	fmt.Printf("type of channel data %T\n", emp)
	fmt.Println("Employee : receive a signal", emp)
}()</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4929">
<div class="content">
<pre>emp := &lt;-ch // is a blocking call, we tell employee come here wait for use to tell you what todo
            // how long to wait, unknown, so at here is unknow latency
            // because we wanna guarante this employe here to gonna received the signal</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4933">
<div class="content">
<pre>// receive come firs and wait for the singal to get the data</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4935">
<p><span class="image"><img src="image/458.jpeg" alt="458"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4938">
<p><strong>Remember</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4940">
<p>only at the sender hand over to data to receiver is atomic</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4942">
<p>Sender is 1 go routine, receiver is 1 go routine, they run in parallel.
in waiting state until passing the signal data</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4945">
<p>after that both go routine run independent at own thread from each other
in operating system perspective.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4948">
<p>that mean there is no guarantee the print statement on line 38 is gonna happen first before
the print statement on line 43 or vice versa.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4951">
<p><span class="image"><img src="image/459.jpeg" alt="459"></span></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4954">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> main

<span style="color:#080;font-weight:bold">import</span> (

        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">math/rand</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// waitForTask :</span>
<span style="color:#777">// think like you are a manager and hiring a new employee.</span>
<span style="color:#777">// you want your new employee to perform task but they need to wait until you are ready</span>
<span style="color:#777">// this is because you need to hand them a piece of paper before they start</span>
<span style="color:#080;font-weight:bold">func</span> waitForTask()  {
        ch := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> <span style="color:#0a8;font-weight:bold">string</span>)

        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                emp := &lt;-ch
                <span style="color:#777">//fmt.Printf(&quot;type of channel data %T\n&quot;, ch)</span>
                <span style="color:#777">//fmt.Printf(&quot;type of channel data %T\n&quot;, emp)</span>
                fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Employee : receive a signal</span><span style="color:#710">&quot;</span></span>, emp)
        }()

        time.Sleep(time.Duration(rand.Intn(<span style="color:#00D">500</span>)) * time.Millisecond)


        ch &lt;- <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">paper</span><span style="color:#710">&quot;</span></span>
        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Manager sent a signal</span><span style="color:#710">&quot;</span></span>)

        time.Sleep(time.Second)

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">-------------------------------------------</span><span style="color:#710">&quot;</span></span>)
}

<span style="color:#080;font-weight:bold">func</span> main() {
        waitForTask()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4995">
<div class="title">see there is no guarantee for print statement on line 38 is gonna happen first before the print statement on line 43 or vice versa.</div>
<p><span class="image"><img src="image/460.jpeg" alt="460"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-4998">
<p>received come first then sender come second</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5000">
<p><strong>CONCLUSION, USE THIS TYPE OF PATTERN FOR POOLING</strong></p>
</div>
</div>
<div class="sect4 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5003">
<h5 id="_wait_for_result">Wait For Result</h5>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5005">
<p>The opposite of the wait for task.
is like drop pattern and fan out pattern.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5008">
<p><span class="image"><img src="image/461.jpeg" alt="461"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5010">
<p><span class="image"><img src="image/462.jpeg" alt="462"></span></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5013">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#777">// waitForTask :</span>
<span style="color:#777">// think like you are a manager and hiring a new employee.</span>
<span style="color:#777">// you want your new employee immedietly to perform task and you want the result</span>
<span style="color:#777">// so you must wait until the employee exist and done their task.</span>
<span style="color:#080;font-weight:bold">func</span> waitForResult()  {
        ch := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> <span style="color:#0a8;font-weight:bold">string</span>)

        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                ch &lt;- <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">paper</span><span style="color:#710">&quot;</span></span>

                fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Employee : send a signal</span><span style="color:#710">&quot;</span></span>)
        }()

        time.Sleep(time.Duration(rand.Intn(<span style="color:#00D">500</span>)) * time.Millisecond)

        manager := &lt;-ch

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Manager received a signal</span><span style="color:#710">&quot;</span></span>, manager)

        time.Sleep(time.Second)

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">-------------------------------------------</span><span style="color:#710">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5039">
<p>Employee already know how to do and the manager are waiting for the result.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5041">
<p>received came first sender come second.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5044">
<h5 id="_wait_for_finished">Wait For Finished</h5>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5046">
<p>is for how we can signal without data.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5048">
<p>What showing here is better to using waitGroup,</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5050">
<p><strong>Waitgroup</strong> is a way kindly doing signalling without data for the type of orchestration.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5053">
<p>When you saw code like this is signaling without data.</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5055">
<div class="content">
<pre>ch := make(chan struct{})</pre>
</div>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5058">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">func</span> waitForFinish()  {
        ch := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> <span style="color:#080;font-weight:bold">struct</span>{})

        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                time.Sleep(time.Duration(rand.Intn(<span style="color:#00D">500</span>)) * time.Millisecond)
                <span style="color:#369;font-weight:bold">close</span>(ch)
                fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Employee : send a signal</span><span style="color:#710">&quot;</span></span>)
        }()


        _, wd := &lt;-ch

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Manager received a signal</span><span style="color:#710">&quot;</span></span>, wd)

        time.Sleep(time.Second)
        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">-------------------------------------------</span><span style="color:#710">&quot;</span></span>)
}

<span style="color:#080;font-weight:bold">func</span> main() {
        waitForFinish()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5082">
<p>for this line of code, because the chanel is without data, we get the second value which is boolean, wd = with data</p>
</div>
<div class="exampleblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5084">
<div class="content">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5085">
<p><strong>if wd is false = we received because the chanel is close (light off),</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5087">
<p><strong>if wd = true then have data, chanel is not close</strong></p>
</div>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5090">
<div class="content">
<pre>_, wd := &lt;-ch</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5092">
<p>if we have data from the chanel we can get using the variable value of the data , flag of the signal</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5094">
<div class="content">
<pre>v, wd := &lt;-ch</pre>
</div>
</div>
<div class="exampleblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5097">
<div class="content">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5098">
<p><strong>if wd is false = we received because the chanel is close (light off),</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5100">
<p><strong>if wd = true then have data, chanel is not close</strong></p>
</div>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5103">
<p><span class="image"><img src="image/463.jpeg" alt="463"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5105">
<p><span class="image"><img src="image/464.jpeg" alt="464"></span></p>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5108">
<h3 id="_pooling_pattern">22.5. Pooling Pattern</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5110">
<p><strong>NOTE When you are *for range a chanel</strong> mean you are create a waiting chanel receive*</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5112">
<div class="content">
<pre>ch := make(chan string)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5114">
<div class="content">
<pre>const emps = 2 // 2 workers
for e := 0; e &lt; emps; e++  {
	go func(emp int) {
		for p := range  ch {
			fmt.Printf("employee %d received a signal %s\n", emp, p)
		}</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5121">
<div class="content">
<pre>		fmt.Printf("employee %d received a shutdown signal\n",  emp)
	}(e)
}</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5125">
<p><strong>Your create 2 Go routine which is waiting to received signal from chanel &#8592;ch</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5127">
<p>mean it will block and wait.</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5129">
<div class="content">
<pre>g1 := &lt;- ch
g2 := &lt;- ch</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5132">
<p><strong>Then how is the fo range terminate</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5134">
<p>it terminate once the <strong>chanel is closed</strong>.</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5137">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">func</span> pooling()  {
        ch := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> <span style="color:#0a8;font-weight:bold">string</span>)

        <span style="color:#080;font-weight:bold">const</span> emps = <span style="color:#00D">2</span> <span style="color:#777">// 2 workers</span>
        <span style="color:#080;font-weight:bold">for</span> e := <span style="color:#00D">0</span>; e &lt; emps; e++  {
                <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>(emp <span style="color:#0a8;font-weight:bold">int</span>) {
                        <span style="color:#080;font-weight:bold">for</span> p := <span style="color:#080;font-weight:bold">range</span>  ch {
                                fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">employee %d received a signal %s</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>, emp, p)
                        }

                        fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">employee %d received a shutdown signal</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>,  emp)
                }(e)
        }

        <span style="color:#080;font-weight:bold">const</span> works = <span style="color:#00D">10</span> <span style="color:#777">// 10 works</span>
        <span style="color:#080;font-weight:bold">for</span> w := <span style="color:#00D">0</span>; w &lt; works; w++ {
                ch &lt;- <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">paper-for-work-number &lt;- </span><span style="color:#710">&quot;</span></span> + strconv.Itoa(w)
                fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Manager send paper-for-work-number &lt;-</span><span style="color:#710">&quot;</span></span>,  w)
        }

        <span style="color:#369;font-weight:bold">close</span>(ch)

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Manager sent shutdown signal</span><span style="color:#710">&quot;</span></span>)

        time.Sleep(time.Second)

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">----------------------------------</span><span style="color:#710">&quot;</span></span>)
}

<span style="color:#080;font-weight:bold">func</span> main() {
pooling()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5174">
<p><span class="image"><img src="image/465.jpeg" alt="465"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5176">
<p><span class="image"><img src="image/466.jpeg" alt="466"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5180">
<p>When the 2 worker are busy , the sender need to wait/block until the 2 worker are free
sender send to the pool, scheduler will asign worker to do the task.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5184">
<div class="title">third will block until 2 worker go routine are free</div>
<p><span class="image"><img src="image/467.jpeg" alt="467"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5186">
<p>until the worker are free the third task get received and process
<span class="image"><img src="image/468.jpeg" alt="468"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5190">
<p><strong>The best idea, we must implement time out for the send chanel to the pool</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5192">
<p>like above case, ideally we must not stuck there until unknown time to wait the worker
on the chanel send.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5195">
<p>after chanel close close(ch) we send a chanel singal that it close and all receiver chanel is now shuting down.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5198">
<h3 id="_fan_out_pattern">22.6. Fan out pattern</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5200">
<p>Take a piece of work and distributed across n number of go routines that can run in parallel</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5202">
<p>suiteable for background task like cron job</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5204">
<p>Fan out pattern might be trouble if suddenly a go routine fan out an another n number of go routines</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5206">
<p>this can multiply very quickly, so get avoided fan out pattern in like long running apps like web services
but fan out is good for background application like a cron job.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5209">
<p><span class="image"><img src="image/469.jpeg" alt="469"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5211">
<p><strong>look at line 20</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5213">
<p>We are now using buffered chanel, which is 20</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5215">
<p>the number 20 is not a magic number suddenly come in</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5217">
<p>NOTE using buffer doesn&#8217;t inscreased any performance,</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5219">
<p>if you might think because use buffer we can avoid sender to wait
then you are wrong, there is a latency on the receiver to process.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5222">
<p><strong>keep in mind, like you throw away box by box to a worker and don&#8217;t care
when is the worker finish the job, all box you just throw into the buffer until full
the sender gonna wait.</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5227">
<p><strong>any time you use a buffer chanel the number cannot be random</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5229">
<p>it must represent something major.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5231">
<p>In example in our code, why is <strong>20</strong>, what is our intention here?</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5233">
<p>in this example we gonna to launch 20 go routines in our fan out</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5235">
<p>means number 20 is gonna to be represent that we gonna add a buffer
for every go routines we gonna fan out, that is the real very major number</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5238">
<p>When you use buffer you need to think</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5240">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5240">
<p>can the sender go routine on this channel ever block?</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5241">
<p>can the buffer ever get full?</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5242">
<p>in fan out pattern we size it, no signaling on the send side could ever block, because we have 1 to 1</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5243">
<p>any time a buffer chanel can get full you need to ask your self, what happen when the signaling on the send block? if you can&#8217;t you really put your service in a bad place</p>
</li>
</ul>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5247">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">math/rand</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">strconv</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">func</span> fanOut()  {
        emps := <span style="color:#00D">20</span>

        ch := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> <span style="color:#0a8;font-weight:bold">string</span>, emps) <span style="color:#777">// using a buffered channel</span>

        <span style="color:#080;font-weight:bold">for</span> e := <span style="color:#00D">0</span>; e &lt; emps; e++  { <span style="color:#777">// 20 worker sending a tasks</span>
                <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>(emp <span style="color:#0a8;font-weight:bold">int</span>) {
                        time.Sleep(time.Duration(rand.Intn(<span style="color:#00D">200</span>)) * time.Millisecond)
                        task := <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">paper-task-</span><span style="color:#710">&quot;</span></span> + strconv.Itoa(emp)
                        ch &lt;- task
                        fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">employee %d send a signal task %s </span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>, emp, task)
                }(e)
        }

        <span style="color:#080;font-weight:bold">for</span> emps &gt; <span style="color:#00D">0</span> {
                p := &lt;-ch
                fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">manager %d received a signal, task %s</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>, emps, p)
                emps--
        }

        time.Sleep(time.Second)

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">----------------------------------</span><span style="color:#710">&quot;</span></span>)
}

<span style="color:#080;font-weight:bold">func</span> main() {
        fanOut()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5285">
<p><span class="image"><img src="image/470.jpeg" alt="470"></span></p>
</div>
<div class="olist arabic has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5288">
<ol class="arabic">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5288">
<p>line 130 we create a 20 go routines</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5289">
<p>line 131 simulate like wait for result pattern</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5290">
<p>we setup a buffer chanel of 20, which is when the work is done by the 20 go routine every one have 1 room of the buffer which is on line 132 the signaling with data every one of the go routine has the own slot in the buffer
so there is no latency between the send and the receive,
remember block is the receive but is wait when any data come into the buffer on line 138
we pull it out so there is no latency between the send and the receive.
because the send happen before the receive.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5296">
<p><span class="image"><img src="image/471.jpeg" alt="471"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5302">
<div class="title">then it will block, because at chanel only allowed 1 send upon a time</div>
<p><span class="image"><img src="image/472.jpeg" alt="472"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5306">
<div class="title">so on this pattern more over the blocking is on the multiple send at the same time.</div>
<p><span class="image"><img src="image/473.jpeg" alt="473"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5309">
<div class="title">here is wait, similar java thread.get()</div>
<p><span class="image"><img src="image/474.jpeg" alt="474"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5313">
<h3 id="_fan_out_pattern_fan_out_semaphore">22.7. Fan out pattern (Fan out semaphore)</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5315">
<p>Let fan out a number of go routines but we don&#8217;t necessary want all the
go routines to be run at the same time. like how many go routine
in a dynamic pool created can literally run with the same time</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5319">
<p><strong>This is another way to be able to reduce latency in term of go routines creation
but the same time limit the impact this go routines will having on the another resource</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5322">
<p><span class="image"><img src="image/475.jpeg" alt="475"></span></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5324">
<div class="content">
<pre> sem := make(chan bool, cap)
 sem &lt;- true
{
             ...
             ...
             ...
         }
&lt;-sem</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5333">
<p>We only want 5 go routines to actually executed at the same time</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5335">
<p>by mean save latency we need to create 20 go routines at the front
there is a cost of go routines creation which we gonna limiting
how many go routines can literally executing at the same times in runnable state</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5341">
<div class="title">line 162, is a channel send, this call will cause block all go routines, and this send will only complete if enough room of buffer which is  5 slot (semaphore)</div>
<p><span class="image"><img src="image/476.jpeg" alt="476"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5344">
<div class="title">in the moment the sem buffer is no room, all go routines is block</div>
<p><span class="image"><img src="image/477.jpeg" alt="477"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5349">
<div class="title">the line 168 get call, which is chanel received, &#8592;sem, what it does is pull out the data out of that sem channel, which is pull out from the sem buffer so is have more room and the rest go routine can move</div>
<p><span class="image"><img src="image/478.jpeg" alt="478"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5351">
<p>We might use this pattern if we have limited resources,
we might hit into problem if running 20 go routine at once, but fine if running 5 go routine at once.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5354">
<p>but remember this pattern here adding extra latency cost to everything that what we doin</p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5357">
<h4 id="_drop_pattern">22.7.1. Drop Pattern</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5359">
<p>Drop pattern helping to reduce back preassure when thing is going bad
Helping us to indentified when thing is going bad</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5362">
<p>Example Write for DNS Server</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5365">
<p>Huge request and not enough capacity then say no.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5367">
<p>Drop pattern is powerfull to indentified failure quickly, helping stop the bleeding
and move forward when the bleeding has been healed like circuit breaker</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5371">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">strconv</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">func</span> drop()  {
         <span style="color:#080;font-weight:bold">const</span> <span style="color:#369;font-weight:bold">cap</span> = <span style="color:#00D">5</span>
         ch := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> <span style="color:#0a8;font-weight:bold">string</span>, <span style="color:#369;font-weight:bold">cap</span>)

         <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                 <span style="color:#080;font-weight:bold">for</span> p := <span style="color:#080;font-weight:bold">range</span> ch {
                         fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Employee : received signal :</span><span style="color:#710">&quot;</span></span>, p)
                 }
         }()

        <span style="color:#080;font-weight:bold">const</span> works = <span style="color:#00D">20</span>
        <span style="color:#080;font-weight:bold">for</span> w := <span style="color:#00D">0</span>; w &lt; works; w++  {
                <span style="color:#080;font-weight:bold">select</span> {
                <span style="color:#080;font-weight:bold">case</span> ch &lt;- <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">paper-</span><span style="color:#710">&quot;</span></span> + strconv.Itoa(w) :
                        fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Manager : sent a singnal : %s</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">paper-</span><span style="color:#710">&quot;</span></span> + strconv.Itoa(w))
                <span style="color:#080;font-weight:bold">default</span>:
                        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Manager : dropped data : </span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">paper-</span><span style="color:#710">&quot;</span></span> + strconv.Itoa(w))
                }
        }

        <span style="color:#369;font-weight:bold">close</span>(ch)

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">manager sent shutdown signal</span><span style="color:#710">&quot;</span></span>)

        time.Sleep(time.Second)

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">------------------------------</span><span style="color:#710">&quot;</span></span>)
}

<span style="color:#080;font-weight:bold">func</span> main() {
        drop()
}</code></pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5414">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5414">
<p>We have  bufered chanel capacity is 5</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5415">
<p>Mean When we have 5 pending in the buffer we are out of capcity, we are no gonna to six, at that point we gonna drop the work on the floor we are not gonna take it</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5417">
<p><span class="image"><img src="image/479.jpeg" alt="479"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5419">
<p>Here is the idea.</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5421">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5421">
<p>Imagine we read data from a network,</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5422">
<p>every time read going to chanel buffer (max 5 slot)</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5423">
<p>the go routine receipt will process</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5424">
<p>in case the buffer is full, we drop the read data</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5425">
<p>in case the receipt go routine having problem and never comeback and buffer is full then all is fail fast because read directly drop</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5426">
<p>so the problem was identified fast.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5428">
<p><strong>The use of Select statement</strong></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5431">
<div class="content">
<pre>select {
case ch &lt;- "paper-" + strconv.Itoa(w) :
    fmt.Printf("Manager : sent a singnal : %s\n", "paper-" + strconv.Itoa(w))
default:
    fmt.Println("Manager : dropped data : ", "paper-" + strconv.Itoa(w))
}</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5438">
<p><strong>select allowed single go routine to handle multiple chanel operations
whether they send and receive, at the exactly the same time</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5441">
<p><strong>So you can create like the advance loop here, which is how we can do cancellation
in deadline</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5444">
<p><strong>The drop pattern like very much like a cancellation</strong></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5446">
<div class="content">
<pre>for w := 0; w &lt; works; w++  {
 select {
    case ch &lt;- "paper-" + strconv.Itoa(w) :</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5450">
<p>Here in for loop we try performing the send, if every tok buffer have capacity
then going to send again</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5453">
<div class="content">
<pre>select {
case ch &lt;- "paper-" + strconv.Itoa(w) :
    fmt.Printf("Manager : sent a singnal : %s\n", "paper-" + strconv.Itoa(w))
default:
    fmt.Println("Manager : dropped data : ", "paper-" + strconv.Itoa(w))
}</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5460">
<p>if the send going to block because buffer is full, then don&#8217;t block</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5462">
<p>move on by going to default case.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5464">
<p>so if the buffer keep full and keep drop for processing, then this is strong
indication our system have problem in our sever.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5468">
<h4 id="_cancellation_pattern">22.7.2. Cancellation Pattern</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5470">
<p>Cancellation deadline are critical to software because a task go request cannot take forever</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5472">
<p>We gonna use context package part from standard library.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5474">
<p>but ideally we never to use the code shown bellow to production , we must use context package to the production</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5477">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">func</span> cancelation()  {

         ch := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> <span style="color:#0a8;font-weight:bold">string</span>, <span style="color:#00D">1</span>)

         <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                 time.Sleep(time.Duration(rand.Intn(<span style="color:#00D">200</span>)) * time.Millisecond)

                 ch &lt;- <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">paper</span><span style="color:#710">&quot;</span></span>

                 fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Employee : send signal : </span><span style="color:#710">&quot;</span></span>)
         }()

        tc := time.After(time.Duration(<span style="color:#00D">100</span>) * time.Millisecond)

        <span style="color:#080;font-weight:bold">select</span> {
        <span style="color:#080;font-weight:bold">case</span> p := &lt;-ch:
                fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Manager : receive signal : </span><span style="color:#710">&quot;</span></span>, p)
        <span style="color:#080;font-weight:bold">case</span> t := &lt;-tc:
                fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Manager : timeout : </span><span style="color:#710">&quot;</span></span>, t)
        }

        time.Sleep(time.Second)

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">------------------------------</span><span style="color:#710">&quot;</span></span>)
}

<span style="color:#080;font-weight:bold">func</span> main() {
        cancelation()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5509">
<p><span class="image"><img src="image/480.jpeg" alt="480"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5516">
<div class="title">We can monitor how work going and then tell the worker go routine to cancel.</div>
<p><span class="image"><img src="image/481.jpeg" alt="481"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5526">
<div class="title">2nd case chanel receive a timer,</div>
<p><span class="image"><img src="image/482.jpeg" alt="482"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5529">
<p>so we have to chanel in select waiting for receive</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5531">
<p>and this line call what it return is a chanel, that the chanel the runtime will add current time to after the duration of 100 millisecond in this case is complete</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5533">
<div class="content">
<pre>tc := time.After(time.Duration(100) * time.Millisecond)</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5535">
<p>so the runtime will coming in an timer and performing send for us in 100ms</p>
</div>
<div class="exampleblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5539">
<div class="content">
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5540">
<div class="content">
<pre> go func() {
time.Sleep(time.Duration(rand.Intn(200)) * time.Millisecond)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5543">
<div class="content">
<pre>ch &lt;- "paper"</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5545">
<div class="content">
<pre> fmt.Println("Employee : send signal : ")
}()</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5548">
<div class="content">
<pre>tc := time.After(time.Duration(100) * time.Millisecond)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5550">
<div class="content">
<pre>select {
case p := &lt;-ch:
	fmt.Println("Manager : receive signal : ", p)
case t := &lt;-tc:
	fmt.Println("Manager : timeout : ", t)
}</pre>
</div>
</div>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5559">
<p>So how to read this code is, if the execution time in go routine (the worker) send within the  100ms
we will executing code in select statement to receive the data from buffer</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5562">
<div class="content">
<pre>case p := &lt;-ch:</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5564">
<p>if the  time in go routine (the worker) after 100ms then will executed the received the timer chanel</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5566">
<div class="content">
<pre>case t := &lt;-tc:</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5568">
<p>so either way we have a guarantee we gonna to move on within 100ms or less.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5570">
<p><strong>REMEMBER BUT We will have a big problem or BUGS if we not using buffered channel</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5573">
<p>if we change without buffer
     ch := make(chan string)</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5576">
<p><strong>Remember the select is 2 chanel waiting fro receive at the select</strong>
- 1st is waiting for the go routine to finish
- 2nd is waiting to receive the runtime timer chanel</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5580">
<p>imagine the go routine finish after 100ms, then the select will received a timer chanel from the runtime go routine.
then it go continue, then our 1st received chanel no longer exist,
in this case the worker go routine have finish do the job and is going to send, but there is no go routine
can received. hence with that the send at the worker go routine will block forever.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5585">
<p><span class="image"><img src="image/482.jpeg" alt="482"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5587">
<p><strong>THIS IS WHAT IT CALL GO ROUTINE LEAK, LEAKING MEMORY</strong></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5590">
<div class="title">so we must use buffer chanel, ch := make(chan string, 1), so the send will went to buffer. and not blocking.</div>
<p><span class="image"><img src="image/483.jpeg" alt="483"></span></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5594">
<h2 id="_starting_concurrency">23. Starting Concurrency</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5596">
<h3 id="_context">23.1. Context</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5598">
<p>Context packaging package in go is very important. where we can implementing cancellation and deadline</p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5601">
<h4 id="_context_with_value">23.1.1. Context With Value</h4>
<div class="sect4 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5603">
<h5 id="_value_back_context">Value Back Context</h5>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5605">
<p>Context is Generic</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5607">
<div class="content">
<pre>// For The parent Context have default function :
context.Background()
context.TODO()</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5611">
<div class="content">
<pre>   // Store the traceID value inside the context with value of zero for the key type
ctx := context.WithValue(context.Background(), traceIDKey, traceID)</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5614">
<div class="content">
<pre>When we use one with another :</pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5616">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5616">
<p>When you need a context but your are not sure where is gonna come from
or how could it be initially initialize then use <strong>TODO()</strong>
is a marker in your code to say, I got comeback here todo this.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5620">
<p>Background is your base parent context, you can think the background is empty context</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5622">
<p>Context use value semantic, pass in to context and get it from context.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5624">
<p><span class="image"><img src="image/486.jpeg" alt="486"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5626">
<p>Remember is value semantic, you get back a copy</p>
</div>
</div>
<div class="sect4 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5629">
<h5 id="_withtimeout">WithTimeOut</h5>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5632">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">context</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">type</span> data <span style="color:#080;font-weight:bold">struct</span> {
        UserID <span style="color:#0a8;font-weight:bold">string</span>
}

<span style="color:#080;font-weight:bold">func</span> main() {

        <span style="color:#777">// Set a duration to wait the job get done</span>
        duration := <span style="color:#00D">150</span> * time.Millisecond

        <span style="color:#777">// Create a context that is both manually cancellable and will signal</span>
        <span style="color:#777">// a cancel at the specified duration.</span>
        ctx, cancel := context.WithTimeout(context.Background(), duration)
        <span style="color:#080;font-weight:bold">defer</span> cancel()

        <span style="color:#777">// Create a channel to received a signal that work is done.</span>
        ch := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> data, <span style="color:#00D">1</span>)

        <span style="color:#777">// Ask the goroutine to do some work for us.</span>
        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {

                <span style="color:#777">// Simulate work.</span>
                time.Sleep(<span style="color:#00D">50</span> * time.Millisecond)

                <span style="color:#777">// Report the work is done.</span>
                ch &lt;- data{<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">123</span><span style="color:#710">&quot;</span></span>}
        }()

        <span style="color:#777">// Wait for the work to finish. If it takes too long move on.</span>
        <span style="color:#080;font-weight:bold">select</span> {
        <span style="color:#080;font-weight:bold">case</span> d := &lt;-ch:
                fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">work complete</span><span style="color:#710">&quot;</span></span>, d)

        <span style="color:#080;font-weight:bold">case</span> &lt;-ctx.Done():
                fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">work cancelled</span><span style="color:#710">&quot;</span></span>)
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5677">
<p><strong>IMPORTANT</strong></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5679">
<div class="content">
<pre>// we get back context and 1 handlerFunction
ctx, cancel := context.WithTimeout(context.Background(), duration)
defer cancel()</pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5683">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5683">
<p>at this line of code we create  a with timeout context.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5685">
<p>context have api,</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5687">
<div class="content">
<pre>context.WithValue()</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5689">
<div class="content">
<pre>context.WithTimeout()</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5691">
<div class="content">
<pre>context.WithCancel()</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5693">
<div class="content">
<pre>context.WithDeadline()</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5695">
<p>for context.WithTimeout(), context.WithCancel(), context.WithDeadline()</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5697">
<p><strong>you must call cancel() function or you gonna have memory leak</strong></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5699">
<div class="content">
<pre>// is critical, never forget to call thsi cancel function
defer cancel()</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5702">
<p>and is okay for cancel() to be call twice</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5704">
<p>and any time you called cancel() you are immediately time out the context, we are not gonna wait for default timeout value in the context</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5706">
<p><span class="image"><img src="image/487.jpeg" alt="487"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5708">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5708">
<p>this how the thing wok</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5710">
<p>we have ctx timeout 150ms,</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5712">
<p>1 buffered chanel go routine worker sender</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5714">
<p>select statement, which is can execute multiple channel send and receive at the same time.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5716">
<p>if the go routine sender take time more than 150ms, then the context.Done() channel is received first</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5718">
<p>mean is timeout</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5721">
<p><span class="image"><img src="image/488.jpeg" alt="488"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5723">
<p><span class="image"><img src="image/489.jpeg" alt="489"></span></p>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5725">
<h3 id="_context_real_case_of_use">23.2. Context Real Case of Use</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5727">
<p><strong>In this code if we use main go routine to perform the request, then we are not able to canceled it</strong></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5731">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">func</span> main() {

        <span style="color:#777">//Create a new request</span>
        request, e := http.NewRequest(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">GET</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://dummy.restapiexample.com/api/v1/employees</span><span style="color:#710">&quot;</span></span>, <span style="color:#069">nil</span>)
        <span style="color:#080;font-weight:bold">if</span> e != <span style="color:#069">nil</span> {
                log.Println(e)
                <span style="color:#080;font-weight:bold">return</span>
        }

        <span style="color:#777">// create context with timout 50 milliseconds</span>
        ctx, cancelFunc := context.WithTimeout(request.Context(), <span style="color:#00D">50</span> * time.Millisecond)
        <span style="color:#080;font-weight:bold">defer</span> cancelFunc()

        <span style="color:#777">// Bind the new context into the request.</span>
        <span style="color:#777">//request = request.WithContext(ctx)</span>

        <span style="color:#777">//  pool of socket connetion to the host of https://www.ardanlabs.com/blog/post/index.html</span>
        <span style="color:#777">// Declare a new transport and client for the call</span>
        tr := http.Transport{
                Proxy: http.ProxyFromEnvironment,
                DialContext: (&amp;net.Dialer{
                        Timeout: <span style="color:#00D">30</span> * time.Second,
                        KeepAlive: <span style="color:#00D">30</span> * time.Second,
                        <span style="color:#777">//DualStack: true, /deprecated</span>
                }).DialContext,
                MaxIdleConns: <span style="color:#00D">100</span>,
                IdleConnTimeout: <span style="color:#00D">90</span> * time.Second,
                TLSHandshakeTimeout: <span style="color:#00D">10</span> * time.Second,
                ExpectContinueTimeout: <span style="color:#00D">1</span> * time.Second,
        }

        client := http.Client{
                Transport: &amp;tr,
        }

        <span style="color:#777">// Make the web call in separate go routine so it can be canceled</span>
        ch := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> <span style="color:#0a8;font-weight:bold">error</span>, <span style="color:#00D">1</span>)
        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {
                log.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Starting Request</span><span style="color:#710">&quot;</span></span>)

                <span style="color:#777">// make a web call and return any error</span>
                resp, err := client.Do(request)
                <span style="color:#080;font-weight:bold">if</span> err != <span style="color:#069">nil</span> {
                        ch &lt;- err
                        <span style="color:#080;font-weight:bold">return</span>
                }

                <span style="color:#777">// Close the response body on the return</span>
                <span style="color:#777">// always need to close response body to prevent resource leak connection</span>
                <span style="color:#080;font-weight:bold">defer</span> resp.Body.Close()

                <span style="color:#777">//Write the copy to stdout</span>
                io.Copy(os.Stdout, resp.Body)
                ch &lt;- <span style="color:#069">nil</span>
        }()

        <span style="color:#777">// Wait the request or timeout</span>
        <span style="color:#080;font-weight:bold">select</span> {

        <span style="color:#080;font-weight:bold">case</span>  &lt;-ctx.Done() :
                log.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Timeout, cancel work..</span><span style="color:#710">&quot;</span></span>)

                <span style="color:#777">//Cancel the request and wait for it to complete</span>
                tr.CancelRequest(request) <span style="color:#777">// HERE IT DOES DIRECTLY SHUTDOWN THE GO ROUTINE</span>
                log.Println(&lt;-ch) <span style="color:#777">// TO CHECK IS HAS BEEN SHUTDOWN</span>

        <span style="color:#080;font-weight:bold">case</span> err := &lt;-ch :
                <span style="color:#080;font-weight:bold">if</span> err != <span style="color:#069">nil</span> {
                        log.Println(err)
                }
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5808">
<p><span class="image"><img src="image/490.jpeg" alt="490"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5810">
<p><strong>How To Read The Code</strong></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5812">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5812">
<p>We initialite a http request and 1 context with timeout 50 milliseconds</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5813">
<p>We use go routine instead of go routine main so we able to cancel it by the given time.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5814">
<p>We created 1 HTTP Transport as a socket connection to the host</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5815">
<p>We create a http client and wrap the transport into it</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5816">
<p>We use the http client into the go routine to perform the task by using cleint DO</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5817">
<p>Client.DO will open socket connetion and so the go routine can stream the data.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5818">
<p>we stream the data and put it into stdout console</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5819">
<p>*if not error at the client.Do we must close response body to prevent resource memory leak.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5820">
<p>if the client.Do resulting error go routine immediately send to chanel buffer</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5821">
<p>select statement we defined two case</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5822">
<p>the context, case we starting the clock, if the sender of go routine requesting data not done in 50 millisecond ctx.Done() mean we say as time out</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5823">
<p>once timeout we use transport.CancelRequest(request), remember at the go routine the request still on going, since we say time out, this call transport.CancelRequest(request) will immediately shutdown the go routine to stop do any request and release all resources.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5824">
<p>if we print the ch after transport.CancelRequest(request) you wil mesaage printed request has canceled.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5825">
<p>&#8592;ch case is to received signal from go routine , if have any error received from the buffer chanel we print it, ini this case calling request in the go routine is not time out</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5828">
<p><span class="image"><img src="image/491.jpeg" alt="491"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5830">
<p><span class="image"><img src="image/492.jpeg" alt="492"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5832">
<p><span class="image"><img src="image/493.jpeg" alt="493"></span></p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5836">
<h4 id="_failure_detection">23.2.1. Failure Detection</h4>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5839">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> main

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">log</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">os</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">os/signal</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// device allow us to mock a device we write to log to.</span>
<span style="color:#080;font-weight:bold">type</span> device <span style="color:#080;font-weight:bold">struct</span> {
        problem <span style="color:#0a8;font-weight:bold">bool</span>
}

<span style="color:#777">// write implement the io.Writer interface</span>

<span style="color:#080;font-weight:bold">func</span> (d *device) Write(p []<span style="color:#0a8;font-weight:bold">byte</span>) (n <span style="color:#0a8;font-weight:bold">int</span>, err <span style="color:#0a8;font-weight:bold">error</span>)  {
        <span style="color:#080;font-weight:bold">for</span> d.problem {

                <span style="color:#777">// simulate disk problem</span>
                time.Sleep(time.Second)
        }

        fmt.Println(<span style="color:#0a8;font-weight:bold">string</span>(p))
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#369;font-weight:bold">len</span>(p), <span style="color:#069">nil</span>
}

<span style="color:#080;font-weight:bold">func</span> main() {

        <span style="color:#777">// assuming we stream 10k of videos and write into the log</span>
        <span style="color:#777">// numbers of go routines that will be writing log</span>
        <span style="color:#080;font-weight:bold">const</span> grs = <span style="color:#00D">10</span>

        <span style="color:#777">// create a logger with a buffer of capacity for each go routine that will be logging</span>
        <span style="color:#080;font-weight:bold">var</span> d device
        l := log.New(&amp;d, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prefix</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">0</span>)

        <span style="color:#777">//generate go routines, each writing to disk</span>
        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; grs; i++  {
                <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>(id <span style="color:#0a8;font-weight:bold">int</span>) {
                        <span style="color:#080;font-weight:bold">for</span> {
                                l.Println(fmt.Sprintf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">%d: log data</span><span style="color:#710">&quot;</span></span>, id))
                                time.Sleep(<span style="color:#00D">10</span> * time.Millisecond)
                        }
                }(i)
        }

        <span style="color:#777">// We want to simulate the disk blocking,</span>
        <span style="color:#777">// Capture internal signal to toggle device issue,</span>
        <span style="color:#777">// use Ctrl+Z to kill the program</span>
        sigChan := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> os.Signal, <span style="color:#00D">1</span>)
        signal.Notify(sigChan, os.Interrupt) <span style="color:#777">// to simulate bind to os and get signal if we hit CTRL+C</span>

        <span style="color:#080;font-weight:bold">for</span> {
                <span style="color:#777">// every CTRL+C we will receive sigChan</span>
                &lt;-sigChan

                <span style="color:#777">// I appreciate have a data race here with the Write method</span>
                <span style="color:#777">// Let's keep thing simple to show the mechanic</span>
                <span style="color:#777">// because here is write, and at the method Write is read.</span>
                <span style="color:#777">// the Write method is implement io.Writer and we passing it into log.New</span>
                <span style="color:#777">// this where the Write method get executed.</span>
                d.problem = !d.problem
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5909">
<p>Above is problem code.
Imagine you have a 10 user streaming world cup video
and you write log for this 10 user.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5913">
<p>run the go app and hit control+c the entire go routine is block
and all video steraming is gone.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5916">
<p>the problem we try to solve is, if can&#8217;t write log just continue move on
so the streaming video from 10 user keep going.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5919">
<p>to exit the app hit ctrl+z</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5922">
<p>So we will use drop pattern to solve the code.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5925">
<p><span class="image"><img src="image/494.jpeg" alt="494"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5927">
<p><strong>RESOLVED CODE</strong></p>
</div>
<div class="olist arabic has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5929">
<ol class="arabic">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5929">
<p>We create new package logger</p>
</li>
</ol>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-5932">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> logger

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">io</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sync</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// We need two core type</span>
<span style="color:#777">// 1. is the buffer chanel</span>
<span style="color:#777">// 2. go routine who perform write to the DISK</span>
<span style="color:#080;font-weight:bold">type</span> Logger <span style="color:#080;font-weight:bold">struct</span> {
        ch <span style="color:#080;font-weight:bold">chan</span> <span style="color:#0a8;font-weight:bold">string</span> <span style="color:#777">// default value of channel is nil, map is nill, slice is nil, need construction</span>

        <span style="color:#777">// for caller to get ability not just only started the go routine but also to terminate the go routine</span>
        <span style="color:#777">// remember you cannot just create a go routine unless you know how and when to terminated.</span>
        wg sync.WaitGroup <span style="color:#777">// is struct it already have zero value</span>
}

<span style="color:#777">// Any Time you create a type you need to have a Factory Function</span>
<span style="color:#777">// and should be used pointer semantic because you can't make copy any more to the Logger</span>
<span style="color:#777">// because we cannot make a copy of waitGroup that will created different waitGroup</span>
<span style="color:#777">// plus there is 1 logger, we only need 1 logger and we are not gonna making copy of the logger</span>

<span style="color:#080;font-weight:bold">func</span> New(w io.Writer, <span style="color:#369;font-weight:bold">cap</span> <span style="color:#0a8;font-weight:bold">int</span>) *Logger  {
        l := Logger{
                ch: <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> <span style="color:#0a8;font-weight:bold">string</span>, <span style="color:#369;font-weight:bold">cap</span>),

        }

        l.wg.Add(<span style="color:#00D">1</span>) <span style="color:#777">// 1 go routine on this package create</span>

        <span style="color:#777">// We create go routine here for performing write to disk</span>
        <span style="color:#777">// this go routine using the buffer channel.</span>
        <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>() {

                <span style="color:#777">// and every go routine finish we signal wait group done to decremented to terminated the go routine</span>
                <span style="color:#080;font-weight:bold">defer</span> l.wg.Done()

                <span style="color:#777">// we receive a buffer chanel from func Printlnthis same as value := &lt;-ch, which is in here the value is string</span>
                <span style="color:#080;font-weight:bold">for</span> chValue := <span style="color:#080;font-weight:bold">range</span> l.ch {
                        fmt.Fprintln(w, chValue)
                }
        }()

        <span style="color:#777">// *REMEMBER Any time you crate a go routine, you need to provide mechanism for able to being terminated the go routine</span>
        <span style="color:#777">// Especially for the api (the caller to able to manage the concurrency the way down)</span>
        <span style="color:#080;font-weight:bold">return</span> &amp;l
}

<span style="color:#777">// mechanism for caller api to be able to shutdown the go routine</span>
<span style="color:#080;font-weight:bold">func</span> (l *Logger) Close()  {
        <span style="color:#777">// In order to shutdown the go routine is to close the channel</span>
        <span style="color:#777">// this close will terminate the for range loop on go routine above</span>
        <span style="color:#369;font-weight:bold">close</span>(l.ch)

        <span style="color:#777">// why here is wait, see line 36, in go routine function at the end it tell waitGroup it has done.</span>
        <span style="color:#777">// here is sync call, we wait until above say done.</span>
        <span style="color:#777">// since we close the channel the entire for loop chanel is shutdown, and it defer wg.done, then wg.wait receive the signal</span>
        <span style="color:#777">// then this function finish</span>
        l.wg.Wait()
}

<span style="color:#777">// this to write log</span>
<span style="color:#080;font-weight:bold">func</span> (l *Logger) Println(v <span style="color:#0a8;font-weight:bold">string</span>)  {
        <span style="color:#777">// this must use drop pattern, because we want to solve.</span>
        <span style="color:#777">// if channel buffer is full, don't block(wait) just drop and continue get the log</span>
        <span style="color:#777">// guess what, you will need select statement</span>
        <span style="color:#080;font-weight:bold">select</span> {

        <span style="color:#777">// Mean if the main go routine success signal data into the buffer,</span>
        <span style="color:#777">// we receive data from buffer then processed in go routine as a receiver</span>
        <span style="color:#777">// line 73</span>
        <span style="color:#080;font-weight:bold">case</span> l.ch &lt;- v:

        <span style="color:#080;font-weight:bold">default</span>:
                <span style="color:#777">// or if line 73 is gonna block (there no room in the buffer)</span>
                <span style="color:#777">// then we wanna drop. so the go routine can continue</span>
                fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">DROP, l.ch &lt;- v , buffer is full</span><span style="color:#710">&quot;</span></span>)
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6016">
<p>and Change a little bit on main.go</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6019">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> main

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="color:#777">//&quot;log&quot;</span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">os</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">os/signal</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time</span><span style="color:#710">&quot;</span></span>

        log <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">github.com/jonnyGit81/gofirstapp/logger</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// device allow us to mock a device we write to log to.</span>
<span style="color:#080;font-weight:bold">type</span> device <span style="color:#080;font-weight:bold">struct</span> {
        problem <span style="color:#0a8;font-weight:bold">bool</span>
}

<span style="color:#777">// write implement the io.Writer interface</span>

<span style="color:#080;font-weight:bold">func</span> (d *device) Write(p []<span style="color:#0a8;font-weight:bold">byte</span>) (n <span style="color:#0a8;font-weight:bold">int</span>, err <span style="color:#0a8;font-weight:bold">error</span>)  {
        <span style="color:#080;font-weight:bold">for</span> d.problem {

                <span style="color:#777">// simulate disk problem</span>
                time.Sleep(time.Second)
        }

        fmt.Println(<span style="color:#0a8;font-weight:bold">string</span>(p))
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#369;font-weight:bold">len</span>(p), <span style="color:#069">nil</span>
}

<span style="color:#080;font-weight:bold">func</span> main() {

        <span style="color:#777">// assuming we stream 10k of videos and write into the log</span>
        <span style="color:#777">// numbers of go routines that will be writing log</span>
        <span style="color:#080;font-weight:bold">const</span> grs = <span style="color:#00D">10</span>

        <span style="color:#777">// create a logger with a buffer of capacity for each go routine that will be logging</span>
        <span style="color:#080;font-weight:bold">var</span> d device

        <span style="color:#777">// we replace with our log</span>
        <span style="color:#777">//l := log.New(&amp;d, &quot;prefix&quot;, 0)</span>
        l := log.New(&amp;d, grs)

        <span style="color:#777">//generate go routines, each writing to disk</span>
        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; grs; i++  {
                <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>(id <span style="color:#0a8;font-weight:bold">int</span>) {
                        <span style="color:#080;font-weight:bold">for</span> {
                                l.Println(fmt.Sprintf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">%d: log data</span><span style="color:#710">&quot;</span></span>, id))
                                time.Sleep(<span style="color:#00D">10</span> * time.Millisecond)
                        }
                }(i)
        }

        <span style="color:#777">// We want to simulate the disk blocking,</span>
        <span style="color:#777">// Capture internal signal to toggle device issue,</span>
        <span style="color:#777">// use Ctrl+Z to kill the program</span>
        sigChan := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> os.Signal, <span style="color:#00D">1</span>)
        signal.Notify(sigChan, os.Interrupt) <span style="color:#777">// to simulate bind to os and get signal if we hit CTRL+C</span>

        <span style="color:#080;font-weight:bold">for</span> {
                <span style="color:#777">// every CTRL+C we will receive sigChan</span>
                &lt;-sigChan

                <span style="color:#777">// I appreciate have a data race here with the Write method</span>
                <span style="color:#777">// Let's keep thing simple to show the mechanic</span>
                <span style="color:#777">// because here is write, and at the method Write is read.</span>
                <span style="color:#777">// the Write method is implement io.Writer and we passing it into log.New</span>
                <span style="color:#777">// this where the Write method get executed.</span>
                d.problem = !d.problem
        }
}</code></pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6093">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6093">
<p>Now to try build the main.go</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6095">
<div class="content">
<pre>go build main.go</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6097">
<div class="content">
<pre>./main</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6099">
<p><span class="image"><img src="image/495.jpeg" alt="495"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6101">
<p>Then Type Control+C to simulate disk full, you will see DROP but fo routine still continue</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6105">
<p><span class="image"><img src="image/496.jpeg" alt="496"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6108">
<p>Then type Control+C to pretend disk have same space then you will see log printed again.</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6110">
<p><span class="image"><img src="image/497.jpeg" alt="497"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6113">
<p>Cool right. :D (Control Z to exit)</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6116">
<h3 id="_testing">23.3. TESTING</h3>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6118">
<h4 id="_basic_unit_test">23.3.1. Basic Unit Test</h4>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6120">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6120">
<p>Package name for test</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6122">
<div class="content">
<pre>if you are testing un-exported api,
the test file must resist in the same directory with same pakcage name</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6125">
<p><span class="image"><img src="image/498.jpeg" alt="498"></span></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6127">
<div class="content">
<pre>if you are testing api to tell to the user for how to use your api
the test file must resist in the same directory with same pakcage _test</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6130">
<div class="content">
<pre>go allowd _test package even is in same folder.</pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6133">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6133">
<p>All test function must be Exported start with <strong>Test</strong>+<strong>YourTestFunctionName</strong></p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6135">
<div class="content">
<pre>Example</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6137">
<div class="content">
<pre>TestDownload</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6139">
<div class="content">
<pre>Testdownload // will not gonna work</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6141">
<p>And must have t pointer at the function test</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6143">
<div class="content">
<pre>func TestDownload(t *testing.T) {</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6145">
<div class="content">
<pre>}</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6147">
<p>t pointer have an api we can use</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6149">
<p><span class="image"><img src="image/500.jpeg" alt="500"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6152">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6152">
<p>t.Fatalf to stop the test, no gonna to continue any test, need to check why fatal.</p>
</li>
</ul>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6155">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">net/http</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testing</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">const</span> succeed = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u2713</span><span style="color:#710">&quot;</span></span> <span style="color:#777">// Check</span>
<span style="color:#080;font-weight:bold">const</span> failed = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u2717</span><span style="color:#710">&quot;</span></span>  <span style="color:#777">// X</span>

<span style="color:#777">// TestDownload validates the http Get function can download content.</span>
<span style="color:#080;font-weight:bold">func</span> TestDownload(t *testing.T)  {
        url := <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://www.google.com/</span><span style="color:#710">&quot;</span></span>
        statusCode := <span style="color:#00D">200</span>

        t.Log(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Given the need to test downloading content</span><span style="color:#710">&quot;</span></span>)
        {
                testID := <span style="color:#00D">0</span>
                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">when checking %s for the status code %d</span><span style="color:#710">&quot;</span></span>, testID, url, statusCode)
                {
                        resp, err := http.Get(url)
                        <span style="color:#080;font-weight:bold">if</span> err != <span style="color:#069">nil</span> {
                                t.Fatalf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, err)
                        }

                        t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call.</span><span style="color:#710">&quot;</span></span>, succeed, testID)
                        <span style="color:#080;font-weight:bold">defer</span> resp.Body.Close()

                        <span style="color:#080;font-weight:bold">if</span> resp.StatusCode == statusCode {
                                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code.</span><span style="color:#710">&quot;</span></span>, succeed, testID, statusCode)
                        } <span style="color:#080;font-weight:bold">else</span> {
                                t.Errorf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code : %d</span><span style="color:#710">&quot;</span></span>, failed, testID, statusCode, resp.StatusCode)
                        }
                }
        }
}</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6192">
<h4 id="_go_test_tool">23.3.2. Go Test Tool</h4>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6194">
<div class="content">
<pre>go test</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6196">
<div class="content">
<pre>go test -v</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6199">
<div class="content">
<pre>.test specific function, filter specific function, if you have test case Start with Down will get executed
go test -run Down</pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6203">
<h4 id="_table_unit_testing">23.3.3. Table Unit Testing</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6205">
<p>This is cool feature, you have 1 function test
with table of different input and output</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6210">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> main

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="color:#777">//&quot;log&quot;</span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">os</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">os/signal</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time</span><span style="color:#710">&quot;</span></span>

        log <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">github.com/jonnyGit81/gofirstapp/logger</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// device allow us to mock a device we write to log to.</span>
<span style="color:#080;font-weight:bold">type</span> device <span style="color:#080;font-weight:bold">struct</span> {
        problem <span style="color:#0a8;font-weight:bold">bool</span>
}

<span style="color:#777">// write implement the io.Writer interface</span>

<span style="color:#080;font-weight:bold">func</span> (d *device) Write(p []<span style="color:#0a8;font-weight:bold">byte</span>) (n <span style="color:#0a8;font-weight:bold">int</span>, err <span style="color:#0a8;font-weight:bold">error</span>) {
        <span style="color:#080;font-weight:bold">for</span> d.problem {

                <span style="color:#777">// simulate disk problem</span>
                time.Sleep(time.Second)
        }

        fmt.Println(<span style="color:#0a8;font-weight:bold">string</span>(p))
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#369;font-weight:bold">len</span>(p), <span style="color:#069">nil</span>
}

<span style="color:#080;font-weight:bold">func</span> main() {

        <span style="color:#777">// assuming we stream 10k of videos and write into the log</span>
        <span style="color:#777">// numbers of go routines that will be writing log</span>
        <span style="color:#080;font-weight:bold">const</span> grs = <span style="color:#00D">10</span>

        <span style="color:#777">// create a logger with a buffer of capacity for each go routine that will be logging</span>
        <span style="color:#080;font-weight:bold">var</span> d device

        <span style="color:#777">// we replace with our log</span>
        <span style="color:#777">//l := log.New(&amp;d, &quot;prefix&quot;, 0)</span>
        l := log.New(&amp;d, grs)

        <span style="color:#777">//generate go routines, each writing to disk</span>
        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; grs; i++ {
                <span style="color:#080;font-weight:bold">go</span> <span style="color:#080;font-weight:bold">func</span>(id <span style="color:#0a8;font-weight:bold">int</span>) {
                        <span style="color:#080;font-weight:bold">for</span> {
                                l.Println(fmt.Sprintf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">%d: log data</span><span style="color:#710">&quot;</span></span>, id))
                                time.Sleep(<span style="color:#00D">10</span> * time.Millisecond)
                        }
                }(i)
        }

        <span style="color:#777">// We want to simulate the disk blocking,</span>
        <span style="color:#777">// Capture internal signal to toggle device issue,</span>
        <span style="color:#777">// use Ctrl+Z to kill the program</span>
        sigChan := <span style="color:#369;font-weight:bold">make</span>(<span style="color:#080;font-weight:bold">chan</span> os.Signal, <span style="color:#00D">1</span>)
        signal.Notify(sigChan, os.Interrupt) <span style="color:#777">// to simulate bind to os and get signal if we hit CTRL+C</span>

        <span style="color:#080;font-weight:bold">for</span> {
                <span style="color:#777">// every CTRL+C we will receive sigChan</span>
                &lt;-sigChan

                <span style="color:#777">// I appreciate have a data race here with the Write method</span>
                <span style="color:#777">// Let's keep thing simple to show the mechanic</span>
                <span style="color:#777">// because here is write, and at the method Write is read.</span>
                <span style="color:#777">// the Write method is implement io.Writer and we passing it into log.New</span>
                <span style="color:#777">// this where the Write method get executed.</span>
                d.problem = !d.problem
        }
}</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6284">
<h4 id="_mocking_2">23.3.4. Mocking</h4>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6286">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6286">
<p>Mocking is for third-party call using httptest</p>
</li>
</ul>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6290">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> example2

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">encoding/xml</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">net/http</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">net/http/httptest</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testing</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">const</span> succeed = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u2713</span><span style="color:#710">&quot;</span></span>
<span style="color:#080;font-weight:bold">const</span> failed = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u2717</span><span style="color:#710">&quot;</span></span>

<span style="color:#777">// feed is mocking the XML document we expect to receive.</span>
<span style="color:#080;font-weight:bold">var</span> feed = <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;rss&gt;
&lt;channel&gt;
    &lt;title&gt;Going Go Programming&lt;/title&gt;
    &lt;description&gt;Golang : https://github.com/goinggo&lt;/description&gt;
    &lt;link&gt;http://www.goinggo.net/&lt;/link&gt;
    &lt;item&gt;
        &lt;pubDate&gt;Sun, 15 Mar 2015 15:04:00 +0000&lt;/pubDate&gt;
        &lt;title&gt;Object Oriented Programming Mechanics&lt;/title&gt;
        &lt;description&gt;Go is an object oriented language.&lt;/description&gt;
        &lt;link&gt;http://www.goinggo.net/2015/03/object-oriented&lt;/link&gt;
    &lt;/item&gt;
&lt;/channel&gt;
&lt;/rss&gt;</span><span style="color:#161">`</span></span>

<span style="color:#777">// Item defines the fields associated with the item tag in</span>
<span style="color:#777">// the buoy RSS document.</span>
<span style="color:#080;font-weight:bold">type</span> Item <span style="color:#080;font-weight:bold">struct</span> {
        XMLName     xml.Name <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;item&quot;</span><span style="color:#161">`</span></span>
        Title       <span style="color:#0a8;font-weight:bold">string</span>   <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;title&quot;</span><span style="color:#161">`</span></span>
        Description <span style="color:#0a8;font-weight:bold">string</span>   <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;description&quot;</span><span style="color:#161">`</span></span>
        Link        <span style="color:#0a8;font-weight:bold">string</span>   <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;link&quot;</span><span style="color:#161">`</span></span>
}

<span style="color:#777">// Channel defines the fields associated with the channel tag in</span>
<span style="color:#777">// the buoy RSS document.</span>
<span style="color:#080;font-weight:bold">type</span> Channel <span style="color:#080;font-weight:bold">struct</span> {
        XMLName     xml.Name <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;channel&quot;</span><span style="color:#161">`</span></span>
        Title       <span style="color:#0a8;font-weight:bold">string</span>   <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;title&quot;</span><span style="color:#161">`</span></span>
        Description <span style="color:#0a8;font-weight:bold">string</span>   <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;description&quot;</span><span style="color:#161">`</span></span>
        Link        <span style="color:#0a8;font-weight:bold">string</span>   <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;link&quot;</span><span style="color:#161">`</span></span>
        PubDate     <span style="color:#0a8;font-weight:bold">string</span>   <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;pubDate&quot;</span><span style="color:#161">`</span></span>
        Items       []Item   <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;item&quot;</span><span style="color:#161">`</span></span>
}

<span style="color:#777">// Document defines the fields associated with the buoy RSS document.</span>
<span style="color:#080;font-weight:bold">type</span> Document <span style="color:#080;font-weight:bold">struct</span> {
        XMLName xml.Name <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;rss&quot;</span><span style="color:#161">`</span></span>
        Channel Channel  <span style="background-color:hsla(120,100%,50%,0.06)"><span style="color:#161">`</span><span style="color:#2B2">xml:&quot;channel&quot;</span><span style="color:#161">`</span></span>
        URI     <span style="color:#0a8;font-weight:bold">string</span>
}

<span style="color:#777">// mockServer returns a pointer to a server to handle the mock get call.</span>
<span style="color:#080;font-weight:bold">func</span> mockServer() *httptest.Server {
        f := <span style="color:#080;font-weight:bold">func</span>(w http.ResponseWriter, r *http.Request) {
                w.WriteHeader(<span style="color:#00D">200</span>)
                w.Header().Set(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Content-Type</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">application/xml</span><span style="color:#710">&quot;</span></span>)
                fmt.Fprintln(w, feed)
        }

        <span style="color:#080;font-weight:bold">return</span> httptest.NewServer(http.HandlerFunc(f))
}

<span style="color:#777">// TestDownload validates the http Get function can download content and</span>
<span style="color:#777">// the content can be unmarshaled and clean.</span>
<span style="color:#080;font-weight:bold">func</span> TestDownload(t *testing.T) {
        statusCode := http.StatusOK

        server := mockServer()
        <span style="color:#080;font-weight:bold">defer</span> server.Close()

        t.Log(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Given the need to test downloading content.</span><span style="color:#710">&quot;</span></span>)
        {
                testID := <span style="color:#00D">0</span>
                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">When checking %q for status code %d</span><span style="color:#710">&quot;</span></span>, testID, server.URL, statusCode)
                {
                        resp, err := http.Get(server.URL)
                        <span style="color:#080;font-weight:bold">if</span> err != <span style="color:#069">nil</span> {
                                t.Fatalf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, err)
                        }
                        t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call.</span><span style="color:#710">&quot;</span></span>, succeed, testID)

                        <span style="color:#080;font-weight:bold">defer</span> resp.Body.Close()

                        <span style="color:#080;font-weight:bold">if</span> resp.StatusCode != statusCode {
                                t.Fatalf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, statusCode, resp.StatusCode)
                        }
                        t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code.</span><span style="color:#710">&quot;</span></span>, succeed, testID, statusCode)

                        <span style="color:#080;font-weight:bold">var</span> d Document
                        <span style="color:#080;font-weight:bold">if</span> err := xml.NewDecoder(resp.Body).Decode(&amp;d); err != <span style="color:#069">nil</span> {
                                t.Fatalf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to unmarshal the response : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, err)
                        }
                        t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to unmarshal the response.</span><span style="color:#710">&quot;</span></span>, succeed, testID)

                        <span style="color:#080;font-weight:bold">if</span> <span style="color:#369;font-weight:bold">len</span>(d.Channel.Items) == <span style="color:#00D">1</span> {
                                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should have 1 item in the feed.</span><span style="color:#710">&quot;</span></span>, succeed, testID)
                        } <span style="color:#080;font-weight:bold">else</span> {
                                t.Errorf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should have 1 item in the feed : %d</span><span style="color:#710">&quot;</span></span>, failed, testID, <span style="color:#369;font-weight:bold">len</span>(d.Channel.Items))
                        }
                }
        }
}</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6400">
<h4 id="_testing_internal_endpoint">23.3.5. Testing Internal Endpoint</h4>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6402">
<p>To Simulate this we create a file structure :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6404">
<p><span class="image"><img src="image/501.jpeg" alt="501"></span></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6407">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> example3

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">github.com/jonnyGit81/gofirstapp/testing/example3/handlers</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">log</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">net/http</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// equal to spring bootstrap class</span>
<span style="color:#080;font-weight:bold">func</span> main() {
        handlers.Routes()

        log.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">listener : Started : Listening on: http://localhost:4000</span><span style="color:#710">&quot;</span></span>)
        http.ListenAndServe(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">:4000</span><span style="color:#710">&quot;</span></span>, <span style="color:#069">nil</span>)
}

---

- <span style="color:#080;font-weight:bold">if</span> you build this <span style="color:#080;font-weight:bold">go</span> and run you able to get request from browser localhots:<span style="color:#00D">4000</span>/sendjson

[source,<span style="color:#080;font-weight:bold">go</span>]</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6430">
<p>package handlers</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6432">
<p>import (
"encoding/json"
"net/http"
)</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6438">
<p>func Routes() {
http.HandleFunc("/sendjson", SendJSON)
}</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6443">
<p>func SendJSON(rw http.ResponseWriter, r *http.Request) {
u := struct {
Name  string
Email string
}{
Name:  "Bill",
Email: "<a href="mailto:bill@ardanlabs.com">bill@ardanlabs.com</a>",
}</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6452">
<div class="content">
<pre>	rw.Header().Set("Content-Type", "application/json")
	rw.WriteHeader(200)
	json.NewEncoder(rw).Encode(&amp;u)
}</pre>
</div>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6456">
<div class="content">
<pre>- above is example web service that we want to test

[source,go]
---
package handlers_test

import (
"encoding/json"
"github.com/jonnyGit81/gofirstapp/testing/example3/handlers"
"net/http"
"net/http/httptest"
"testing"
)

const succeed = "\u2713"
const failed = "\u2717"

// this is critical, we need to init this to be mock of all our endpoint
// in here which is /sendjson
func init() {
handlers.Routes()
}


// TestSendJSON testing the sendjson internal endpoint.
func TestSendJSON(t *testing.T) {
url := "/sendjson"
statusCode := 200

	t.Log("Given the need to test the SendJSON endpoint.")
	{
		r := httptest.NewRequest("GET", url, nil)
		w := httptest.NewRecorder() // encoder already implement ResponseWriter
		http.DefaultServeMux.ServeHTTP(w, r)

		testID := 0
		t.Logf("\tTest %d:\tWhen checking %q for status code %d", testID, url, statusCode)
		{
			if w.Code != 200 {
				t.Fatalf("\t%s\tTest %d:\tShould receive a status code of %d for the response. Received[%d].", failed, testID, statusCode, w.Code)
			}
			t.Logf("\t%s\tTest %d:\tShould receive a status code of %d for the response.", succeed, testID, statusCode)

			var u struct {
				Name  string
				Email string
			}

			if err := json.NewDecoder(w.Body).Decode(&amp;u); err != nil {
				t.Fatalf("\t%s\tTest %d:\tShould be able to decode the response.", failed, testID)
			}
			t.Logf("\t%s\tTest %d:\tShould be able to decode the response.", succeed, testID)

			if u.Name == "Bill" {
				t.Logf("\t%s\tTest %d:\tShould have \"Bill\" for Name in the response.", succeed, testID)
			} else {
				t.Errorf("\t%s\tTest %d:\tShould have \"Bill\" for Name in the response : %q", failed, testID, u.Name)
			}

			if u.Email == "bill@ardanlabs.com" {
				t.Logf("\t%s\tTest %d:\tShould have \"bill@ardanlabs.com\" for Email in the response.", succeed, testID)
			} else {
				t.Errorf("\t%s\tTest %d:\tShould have \"bill@ardanlabs.com\" for Email in the response : %q", failed, testID, u.Email)
			}
		}
	}
}</pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6527">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6527">
<p>Above is our test class</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6529">
<p>run the test with coverage</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6531">
<p><span class="image"><img src="image/502.jpeg" alt="502"></span></p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6535">
<h3 id="_example_test">23.4. Example Test</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6537">
<p>This is not example code of test</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6539">
<p>Is a terminology in go Example Test</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6541">
<p>this is serve 2 purposes :</p>
</div>
<div class="olist arabic has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6543">
<ol class="arabic">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6543">
<p>Help to providing example in the go documents</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6545">
<p>and for test</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6547">
<p><span class="image"><img src="image/503.jpeg" alt="503"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6550">
<p>You can open your go doc from you local</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6553">
<div class="content">
<pre>godoc -http :3000</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6555">
<p><span class="image"><img src="image/504.jpeg" alt="504"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6559">
<div class="title">then you can find the example here in the documentation</div>
<p><span class="image"><img src="image/505.jpeg" alt="505"></span></p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6563">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> handlers_test

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">encoding/json</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">log</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">net/http</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">net/http/httptest</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// ExampleSendJSON provides a basic example example.</span>
<span style="color:#080;font-weight:bold">func</span> ExampleSendJSON() {
        r := httptest.NewRequest(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">GET</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/sendjson</span><span style="color:#710">&quot;</span></span>, <span style="color:#069">nil</span>)
        w := httptest.NewRecorder()
        http.DefaultServeMux.ServeHTTP(w, r)

        <span style="color:#080;font-weight:bold">var</span> u <span style="color:#080;font-weight:bold">struct</span> {
                Name  <span style="color:#0a8;font-weight:bold">string</span>
                Email <span style="color:#0a8;font-weight:bold">string</span>
        }

        <span style="color:#080;font-weight:bold">if</span> err := json.NewDecoder(w.Body).Decode(&amp;u); err != <span style="color:#069">nil</span> {
                log.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ERROR:</span><span style="color:#710">&quot;</span></span>, err)
        }

        fmt.Println(u)
        <span style="color:#777">// Output:</span>
        <span style="color:#777">// {Bill bill@ardanlabs.com}</span>
}</code></pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6596">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6596">
<p>this line of code is important</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6598">
<div class="content">
<pre>fmt.Println(u)
// Output:
// {Bill bill@ardanlabs.com}</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6602">
<p>the line after Println is stdout in the doc
also if you run the example_test the stdout must same result from the handler return value</p>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6606">
<h4 id="_sub_tests">23.4.1. Sub Tests</h4>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6608">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6608">
<p>make a test function into variable and execute it</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6610">
<p>sub test allow us to filter peace of data and put it into command line level</p>
</li>
</ul>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6613">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#777">// All material is licensed under the Apache License Version 2.0, January 2004</span>
<span style="color:#777">// http://www.apache.org/licenses/LICENSE-2.0</span>

<span style="color:#777">// go test -v</span>
<span style="color:#777">// go test -run TestDownload/statusok -v</span>
<span style="color:#777">// go test -run TestDownload/statusnotfound -v</span>
<span style="color:#777">// go test -run TestParallelize -v</span>

<span style="color:#777">// Sample test to show how to write a basic sub unit table test.</span>
<span style="color:#080;font-weight:bold">package</span> example2

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">net/http</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testing</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">const</span> succeed = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u2713</span><span style="color:#710">&quot;</span></span>
<span style="color:#080;font-weight:bold">const</span> failed = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u2717</span><span style="color:#710">&quot;</span></span>

<span style="color:#777">// TestDownload validates the http Get function can download content and</span>
<span style="color:#777">// handles different status conditions properly.</span>
<span style="color:#080;font-weight:bold">func</span> TestDownload(t *testing.T) {
        tt := []<span style="color:#080;font-weight:bold">struct</span> {
                name       <span style="color:#0a8;font-weight:bold">string</span>
                url        <span style="color:#0a8;font-weight:bold">string</span>
                statusCode <span style="color:#0a8;font-weight:bold">int</span>
        }{
                {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">statusok</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://www.ardanlabs.com/blog/index.xml</span><span style="color:#710">&quot;</span></span>, http.StatusOK},
                {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">statusnotfound</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://rss.cnn.com/rss/cnn_topstorie.rss</span><span style="color:#710">&quot;</span></span>, http.StatusNotFound},
        }

        t.Log(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Given the need to test downloading different content.</span><span style="color:#710">&quot;</span></span>)
        {
                <span style="color:#080;font-weight:bold">for</span> testID, test := <span style="color:#080;font-weight:bold">range</span> tt {

                        tf := <span style="color:#080;font-weight:bold">func</span>(t *testing.T) {
                                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">When checking %q for status code %d</span><span style="color:#710">&quot;</span></span>, testID, test.url, test.statusCode)
                                {
                                        resp, err := http.Get(test.url)
                                        <span style="color:#080;font-weight:bold">if</span> err != <span style="color:#069">nil</span> {
                                                t.Fatalf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, err)
                                        }
                                        t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call.</span><span style="color:#710">&quot;</span></span>, succeed, testID)

                                        <span style="color:#080;font-weight:bold">defer</span> resp.Body.Close()

                                        <span style="color:#080;font-weight:bold">if</span> resp.StatusCode == test.statusCode {
                                                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code.</span><span style="color:#710">&quot;</span></span>, succeed, testID, test.statusCode)
                                        } <span style="color:#080;font-weight:bold">else</span> {
                                                t.Errorf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, test.statusCode, resp.StatusCode)
                                        }
                                }
                        }

                        t.Run(test.name, tf)
                }
        }
}

<span style="color:#777">// TestParallelize validates the http Get function can download content and</span>
<span style="color:#777">// handles different status conditions properly but runs the tests in parallel.</span>
<span style="color:#080;font-weight:bold">func</span> TestParallelize(t *testing.T) {
        <span style="color:#080;font-weight:bold">type</span> tableTest <span style="color:#080;font-weight:bold">struct</span> {
                name       <span style="color:#0a8;font-weight:bold">string</span>
                url        <span style="color:#0a8;font-weight:bold">string</span>
                statusCode <span style="color:#0a8;font-weight:bold">int</span>
        }

        tt := []tableTest{
                {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">statusok</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://www.ardanlabs.com/blog/index.xml</span><span style="color:#710">&quot;</span></span>, http.StatusOK},
                {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">statusnotfound</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://rss.cnn.com/rss/cnn_topstorie.rss</span><span style="color:#710">&quot;</span></span>, http.StatusNotFound},
        }

        t.Log(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Given the need to test downloading different content.</span><span style="color:#710">&quot;</span></span>)
        {
                <span style="color:#080;font-weight:bold">for</span> testID, test := <span style="color:#080;font-weight:bold">range</span> tt {
                        testID, test := testID, test
                        tf := <span style="color:#080;font-weight:bold">func</span>(t *testing.T) {
                                t.Parallel()

                                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">When checking %q for status code %d</span><span style="color:#710">&quot;</span></span>, testID, test.url, test.statusCode)
                                {
                                        resp, err := http.Get(test.url)
                                        <span style="color:#080;font-weight:bold">if</span> err != <span style="color:#069">nil</span> {
                                                t.Fatalf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, err)
                                        }
                                        t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call.</span><span style="color:#710">&quot;</span></span>, succeed, testID)

                                        <span style="color:#080;font-weight:bold">defer</span> resp.Body.Close()

                                        <span style="color:#080;font-weight:bold">if</span> resp.StatusCode == test.statusCode {
                                                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code.</span><span style="color:#710">&quot;</span></span>, succeed, testID, test.statusCode)
                                        } <span style="color:#080;font-weight:bold">else</span> {
                                                t.Errorf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, test.statusCode, resp.StatusCode)
                                        }
                                }
                        }
                        t.Run(test.name, tf)
                }
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6717">
<p>How To Use Subtest in commandline</p>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6720">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">net/http</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testing</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">const</span> succeed = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u2713</span><span style="color:#710">&quot;</span></span>
<span style="color:#080;font-weight:bold">const</span> failed = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u2717</span><span style="color:#710">&quot;</span></span>

<span style="color:#777">// TestDownload validates the http Get function can download content and</span>
<span style="color:#777">// handles different status conditions properly.</span>
<span style="color:#080;font-weight:bold">func</span> TestDownload(t *testing.T) {
        tt := []<span style="color:#080;font-weight:bold">struct</span> {
                name       <span style="color:#0a8;font-weight:bold">string</span>
                url        <span style="color:#0a8;font-weight:bold">string</span>
                statusCode <span style="color:#0a8;font-weight:bold">int</span>
        }{
                {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">statusok</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://google.com</span><span style="color:#710">&quot;</span></span>, http.StatusOK},
                {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">statusnotfound</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://rss.cnn.com/rss/cnn_topstorie.rss</span><span style="color:#710">&quot;</span></span>, http.StatusNotFound},
        }

        t.Log(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Given the need to test downloading different content.</span><span style="color:#710">&quot;</span></span>)
        {
                <span style="color:#080;font-weight:bold">for</span> testID, test := <span style="color:#080;font-weight:bold">range</span> tt {

                        tf := <span style="color:#080;font-weight:bold">func</span>(t *testing.T) {
                                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">When checking %q for status code %d</span><span style="color:#710">&quot;</span></span>, testID, test.url, test.statusCode)
                                {
                                        resp, err := http.Get(test.url)
                                        <span style="color:#080;font-weight:bold">if</span> err != <span style="color:#069">nil</span> {
                                                t.Fatalf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, err)
                                        }
                                        t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call.</span><span style="color:#710">&quot;</span></span>, succeed, testID)

                                        <span style="color:#080;font-weight:bold">defer</span> resp.Body.Close()

                                        <span style="color:#080;font-weight:bold">if</span> resp.StatusCode == test.statusCode {
                                                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code.</span><span style="color:#710">&quot;</span></span>, succeed, testID, test.statusCode)
                                        } <span style="color:#080;font-weight:bold">else</span> {
                                                t.Errorf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, test.statusCode, resp.StatusCode)
                                        }
                                }
                        }

                        <span style="color:#777">//here is the key of subtest</span>
                        <span style="color:#777">// name and the function to execute</span>
                        t.Run(test.name, tf)
                }
        }
}</code></pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6773">
<div class="content">
<pre>cd testing/example4</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6775">
<div class="content">
<pre>go test -run TestDownload -v</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6777">
<p><span class="image"><img src="image/506.jpeg" alt="506"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6779">
<p>you will see we have 3 subtest based on the name of our table test</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6782">
<p>Hence with that you can specified with data you want to test based on the name. the cool part</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6784">
<div class="content">
<pre>go test -run TestDownload/statusok -v</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6786">
<p><span class="image"><img src="image/507.jpeg" alt="507"></span></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6789">
<h4 id="_test_subtest_run_in_paralel">23.4.2. Test subtest run in paralel</h4>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6794">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> example5

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">net/http</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testing</span><span style="color:#710">&quot;</span></span>
)


<span style="color:#080;font-weight:bold">const</span> succeed = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u2713</span><span style="color:#710">&quot;</span></span>
<span style="color:#080;font-weight:bold">const</span> failed = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u2717</span><span style="color:#710">&quot;</span></span>

<span style="color:#777">// TestParallelize validates the http Get function can download content and</span>
<span style="color:#777">// handles different status conditions properly but runs the tests in parallel.</span>
<span style="color:#080;font-weight:bold">func</span> TestParallelize(t *testing.T) {
        <span style="color:#080;font-weight:bold">type</span> tableTest <span style="color:#080;font-weight:bold">struct</span> {
                name       <span style="color:#0a8;font-weight:bold">string</span>
                url        <span style="color:#0a8;font-weight:bold">string</span>
                statusCode <span style="color:#0a8;font-weight:bold">int</span>
        }

        tt := []tableTest{
                {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">statusok</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://www.ardanlabs.com/blog/index.xml</span><span style="color:#710">&quot;</span></span>, http.StatusOK},
                {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">statusnotfound</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://rss.cnn.com/rss/cnn_topstorie.rss</span><span style="color:#710">&quot;</span></span>, http.StatusNotFound},
        }

        t.Log(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Given the need to test downloading different content.</span><span style="color:#710">&quot;</span></span>)
        {
                <span style="color:#080;font-weight:bold">for</span> testID, test := <span style="color:#080;font-weight:bold">range</span> tt {
                        <span style="color:#777">//testID, test := testID, test</span>
                        tf := <span style="color:#080;font-weight:bold">func</span>(t *testing.T) {
                                t.Parallel() <span style="color:#777">// line 31</span>

                                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">When checking %q for status code %d</span><span style="color:#710">&quot;</span></span>, testID, test.url, test.statusCode)
                                {
                                        resp, err := http.Get(test.url)
                                        <span style="color:#080;font-weight:bold">if</span> err != <span style="color:#069">nil</span> {
                                                t.Fatalf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, err)
                                        }
                                        t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should be able to make the Get call.</span><span style="color:#710">&quot;</span></span>, succeed, testID)

                                        <span style="color:#080;font-weight:bold">defer</span> resp.Body.Close()

                                        <span style="color:#080;font-weight:bold">if</span> resp.StatusCode == test.statusCode {
                                                t.Logf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code.</span><span style="color:#710">&quot;</span></span>, succeed, testID, test.statusCode)
                                        } <span style="color:#080;font-weight:bold">else</span> {
                                                t.Errorf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\t</span><span style="color:#D20">%s</span><span style="color:#b0b">\t</span><span style="color:#D20">Test %d:</span><span style="color:#b0b">\t</span><span style="color:#D20">Should receive a %d status code : %v</span><span style="color:#710">&quot;</span></span>, failed, testID, test.statusCode, resp.StatusCode)
                                        }
                                }
                        }
                        t.Run(test.name, tf)
                }
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6851">
<p>Look at line 31 we call t.Parallel()</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6853">
<p>This t.Parallel() tell to run every subtest in it own go routine, run separately</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6855">
<p>This is to speed up test time</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6857">
<p><span class="image"><img src="image/509.jpeg" alt="509"></span></p>
</div>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6860">
<h4 id="_code_coverage">23.4.3. Code Coverage</h4>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6862">
<div class="content">
<pre>go test -cover</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6865">
<p><span class="image"><img src="image/510.jpeg" alt="510"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6868">
<p>Using go tools to show coverage in html</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6870">
<div class="content">
<pre>go test -coverprofile c.out</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6872">
<div class="content">
<pre>go tool cover -html c.out</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6875">
<p><span class="image"><img src="image/511.jpeg" alt="511"></span></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6878">
<h2 id="_benchmarking">24. Benchmarking</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6880">
<h3 id="_cpu_and_memory_for_performance">24.1. CPU and Memory for performance</h3>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6883">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> benchmarking

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testing</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">var</span> gs <span style="color:#0a8;font-weight:bold">string</span>

<span style="color:#777">// BenchmarkSprint tests the performance of using Sprint</span>
<span style="color:#080;font-weight:bold">func</span> BenchmarkSprint(b *testing.B)  {
        <span style="color:#080;font-weight:bold">var</span> s <span style="color:#0a8;font-weight:bold">string</span>

        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i&lt;b.N ; i++  {
                s = fmt.Sprint(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">hello</span><span style="color:#710">&quot;</span></span>)
        }
        gs = s;
}

<span style="color:#777">// BenchmarkSprint tests the performance of using Sprintf</span>
<span style="color:#080;font-weight:bold">func</span> BenchmarkSprintf(b *testing.B)  {
        <span style="color:#080;font-weight:bold">var</span> s <span style="color:#0a8;font-weight:bold">string</span>

        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i&lt;b.N ; i++  {
                s = fmt.Sprintf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">hello</span><span style="color:#710">&quot;</span></span>)
        }
        gs = s;
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6914">
<p>Create a benchmarking_test.go</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6916">
<p>in order to capture cpu and memory usage you need to capture the output of Sprint or Sprintf</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6918">
<p>if you take a look you might guess Sprint more faster compare than Sprintf</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6920">
<p>in the Code b.N is 1 and then i gonna increase b.N overtime
by default the test will run 1 sec we try test 3 seconds, N is bench time</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6924">
<p>run command :</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6926">
<div class="content">
<pre>cd benchmarking</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6929">
<p>by default go test will looking test function, since we wan to do benchmarking we use prefix go test none</p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6931">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6931">
<p>none &#8658; exclude</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6932">
<p>-bench . &#8658; everything benchmark</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6934">
<div class="content">
<pre>go test -run none -bench . -benchtime 3s</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6937">
<p><span class="image"><img src="image/512.jpeg" alt="512"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6939">
<p>the Sprintf is more faster</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6942">
<p>To See memory alcoation from stack to heap</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6944">
<div class="content">
<pre>go test -run none -bench . -benchtime 3s -benchmem</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6947">
<p><span class="image"><img src="image/513.jpeg" alt="513"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6950">
<h3 id="_create_sub_benchmark">24.2. Create Sub Benchmark</h3>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6953">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#080;font-weight:bold">package</span> subbenchmark

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testing</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">var</span> gs <span style="color:#0a8;font-weight:bold">string</span>

<span style="color:#777">// BenchmarkSprint tests all the Sprint related benchmarks as</span>
<span style="color:#777">// sub benchmarks.</span>
<span style="color:#080;font-weight:bold">func</span> BenchmarkSprint(b *testing.B) {
        b.Run(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">none</span><span style="color:#710">&quot;</span></span>, benchSprint)
        b.Run(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">format</span><span style="color:#710">&quot;</span></span>, benchSprintf)
}

<span style="color:#777">// benchSprint tests the performance of using Sprint.</span>
<span style="color:#080;font-weight:bold">func</span> benchSprint(b *testing.B) {
        <span style="color:#080;font-weight:bold">var</span> s <span style="color:#0a8;font-weight:bold">string</span>

        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; b.N; i++ {
                s = fmt.Sprint(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">hello</span><span style="color:#710">&quot;</span></span>)
        }

        gs = s
}

<span style="color:#777">// benchSprintf tests the performance of using Sprintf.</span>
<span style="color:#080;font-weight:bold">func</span> benchSprintf(b *testing.B) {
        <span style="color:#080;font-weight:bold">var</span> s <span style="color:#0a8;font-weight:bold">string</span>

        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; b.N; i++ {
                s = fmt.Sprintf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">hello</span><span style="color:#710">&quot;</span></span>)
        }

        gs = s
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6995">
<p><span class="image"><img src="image/514.jpeg" alt="514"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-6998">
<h2 id="_profiling_and_tracing">25. Profiling and Tracing</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7000">
<h3 id="_profiling_guideline">25.1. Profiling Guideline</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7002">
<p><span class="image"><img src="image/515.jpeg" alt="515"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7004">
<p>or you can use <strong>ngrok</strong></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7007">
<h3 id="_stack_trace">25.2. Stack Trace</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7009">
<p>how to read stack trace</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7011">
<p><span class="image"><img src="image/516.jpeg" alt="516"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7013">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7013">
<p>you have slice which is sice is 3 word : pointer, len , cap</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7015">
<p>you have string which is 2 word : pointer, len</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7017">
<p>you have integer which 1 word : int value</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7019">
<p>in total you have 6 word in the parameter :</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7021">
<p><span class="image"><img src="image/517.jpeg" alt="517"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7023">
<p><span class="image"><img src="image/518.jpeg" alt="518"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7026">
<p><span class="image"><img src="image/521.jpeg" alt="521"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7028">
<p><span class="image"><img src="image/520.jpeg" alt="520"></span>
<span class="image"><img src="image/519.jpeg" alt="519"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7032">
<p><span class="image"><img src="image/520.jpeg" alt="520"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7034">
<p><span class="image"><img src="image/521.jpeg" alt="521"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7036">
<p><span class="image"><img src="image/523.jpeg" alt="523"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7038">
<p><span class="image"><img src="image/524.jpeg" alt="524"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7040">
<p><span class="image"><img src="image/525.jpeg" alt="525"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7043">
<h3 id="_dump_the_go_routine">25.3. dump the go routine</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7045">
<p><span class="image"><img src="image/526.jpeg" alt="526"></span></p>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7048">
<h3 id="_micro_level_optimization">25.4. Micro Level Optimization</h3>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7050">
<h4 id="_memcpu">25.4.1. MemCpu</h4>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/profiling/memcpu/stream.go-0">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#777">// All material is licensed under the Apache License Version 2.0, January 2004</span>
<span style="color:#777">// http://www.apache.org/licenses/LICENSE-2.0</span>

<span style="color:#777">// Sample program that takes a stream of bytes and looks for the bytes</span>
<span style="color:#777">// “elvis” and when they are found, replace them with “Elvis”. The code</span>
<span style="color:#777">// cannot assume that there are any line feeds or other delimiters in the</span>
<span style="color:#777">// stream and the code must assume that the stream is of any arbitrary length.</span>
<span style="color:#777">// The solution cannot meaningfully buffer to the end of the stream and</span>
<span style="color:#777">// then process the replacement.</span>
<span style="color:#080;font-weight:bold">package</span> main

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bytes</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fmt</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">io</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#777">// data represents a table of input and expected output.</span>
<span style="color:#080;font-weight:bold">var</span> data = []<span style="color:#080;font-weight:bold">struct</span> {
        input  []<span style="color:#0a8;font-weight:bold">byte</span>
        output []<span style="color:#0a8;font-weight:bold">byte</span>
}{
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">abc</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">abc</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">elvis</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Elvis</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aElvis</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aElvis</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">abcelvis</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">abcElvis</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">eelvis</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">eElvis</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aelvis</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aElvis</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aabeeeelvis</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aabeeeElvis</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">e l v i s</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">e l v i s</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aa bb e l v i saa</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aa bb e l v i saa</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20"> elvi s</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20"> elvi s</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">elvielvis</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">elviElvis</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">elvielvielviselvi1</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">elvielviElviselvi1</span><span style="color:#710">&quot;</span></span>)},
        {[]<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">elvielviselvis</span><span style="color:#710">&quot;</span></span>), []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">elviElvisElvis</span><span style="color:#710">&quot;</span></span>)},
}

<span style="color:#777">// assembleInputStream combines all the input into a</span>
<span style="color:#777">// single stream for processing.</span>
<span style="color:#080;font-weight:bold">func</span> assembleInputStream() []<span style="color:#0a8;font-weight:bold">byte</span> {
        <span style="color:#080;font-weight:bold">var</span> in []<span style="color:#0a8;font-weight:bold">byte</span>
        <span style="color:#080;font-weight:bold">for</span> _, d := <span style="color:#080;font-weight:bold">range</span> data {
                in = <span style="color:#369;font-weight:bold">append</span>(in, d.input...)
        }
        <span style="color:#080;font-weight:bold">return</span> in
}

<span style="color:#777">// assembleOutputStream combines all the output into a</span>
<span style="color:#777">// single stream for comparing.</span>
<span style="color:#080;font-weight:bold">func</span> assembleOutputStream() []<span style="color:#0a8;font-weight:bold">byte</span> {
        <span style="color:#080;font-weight:bold">var</span> out []<span style="color:#0a8;font-weight:bold">byte</span>
        <span style="color:#080;font-weight:bold">for</span> _, d := <span style="color:#080;font-weight:bold">range</span> data {
                out = <span style="color:#369;font-weight:bold">append</span>(out, d.output...)
        }
        <span style="color:#080;font-weight:bold">return</span> out
}

<span style="color:#080;font-weight:bold">func</span> main() {
        <span style="color:#080;font-weight:bold">var</span> output bytes.Buffer
        in := assembleInputStream()
        out := assembleOutputStream()

        find := []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">elvis</span><span style="color:#710">&quot;</span></span>)
        repl := []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Elvis</span><span style="color:#710">&quot;</span></span>)

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">=======================================</span><span style="color:#b0b">\n</span><span style="color:#D20">Running Algorithm One</span><span style="color:#710">&quot;</span></span>)
        output.Reset()
        algOne(in, find, repl, &amp;output)
        matched := bytes.Compare(out, output.Bytes())
        fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Matched: %v</span><span style="color:#b0b">\n</span><span style="color:#D20">Inp: [%s]</span><span style="color:#b0b">\n</span><span style="color:#D20">Exp: [%s]</span><span style="color:#b0b">\n</span><span style="color:#D20">Got: [%s]</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>, matched == <span style="color:#00D">0</span>, in, out, output.Bytes())

        fmt.Println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">=======================================</span><span style="color:#b0b">\n</span><span style="color:#D20">Running Algorithm Two</span><span style="color:#710">&quot;</span></span>)
        output.Reset()
        algTwo(in, find, repl, &amp;output)
        matched = bytes.Compare(out, output.Bytes())
        fmt.Printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Matched: %v</span><span style="color:#b0b">\n</span><span style="color:#D20">Inp: [%s]</span><span style="color:#b0b">\n</span><span style="color:#D20">Exp: [%s]</span><span style="color:#b0b">\n</span><span style="color:#D20">Got: [%s]</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>, matched == <span style="color:#00D">0</span>, in, out, output.Bytes())
}

<span style="color:#777">// algOne is one way to solve the problem.</span>
<span style="color:#080;font-weight:bold">func</span> algOne(data []<span style="color:#0a8;font-weight:bold">byte</span>, find []<span style="color:#0a8;font-weight:bold">byte</span>, repl []<span style="color:#0a8;font-weight:bold">byte</span>, output *bytes.Buffer) {

        <span style="color:#777">// Use a bytes Buffer to provide a stream to process.</span>
        input := bytes.NewBuffer(data)

        <span style="color:#777">// The number of bytes we are looking for.</span>
        size := <span style="color:#369;font-weight:bold">len</span>(find)

        <span style="color:#777">// Declare the buffers we need to process the stream.</span>
        buf := <span style="color:#369;font-weight:bold">make</span>([]<span style="color:#0a8;font-weight:bold">byte</span>, size)
        end := size - <span style="color:#00D">1</span>

        <span style="color:#777">// Read in an initial number of bytes we need to get started.</span>
        <span style="color:#080;font-weight:bold">if</span> n, err := io.ReadFull(input, buf[:end]); err != <span style="color:#069">nil</span> {
                output.Write(buf[:n])
                <span style="color:#080;font-weight:bold">return</span>
        }

        <span style="color:#080;font-weight:bold">for</span> {

                <span style="color:#777">// Read in one byte from the input stream.</span>
                <span style="color:#080;font-weight:bold">if</span> _, err := io.ReadFull(input, buf[end:]); err != <span style="color:#069">nil</span> {

                        <span style="color:#777">// Flush the reset of the bytes we have.</span>
                        output.Write(buf[:end])
                        <span style="color:#080;font-weight:bold">return</span>
                }

                <span style="color:#777">// If we have a match, replace the bytes.</span>
                <span style="color:#080;font-weight:bold">if</span> bytes.Equal(buf, find) {
                        output.Write(repl)

                        <span style="color:#777">// Read a new initial number of bytes.</span>
                        <span style="color:#080;font-weight:bold">if</span> n, err := io.ReadFull(input, buf[:end]); err != <span style="color:#069">nil</span> {
                                output.Write(buf[:n])
                                <span style="color:#080;font-weight:bold">return</span>
                        }

                        <span style="color:#080;font-weight:bold">continue</span>
                }

                <span style="color:#777">// Write the front byte since it has been compared.</span>
                output.WriteByte(buf[<span style="color:#00D">0</span>])

                <span style="color:#777">// Slice that front byte out.</span>
                <span style="color:#369;font-weight:bold">copy</span>(buf, buf[<span style="color:#00D">1</span>:])
        }
}

<span style="color:#777">// algTwo is a second way to solve the problem.</span>
<span style="color:#777">// Provided by Tyler Stillwater https://twitter.com/TylerStillwater</span>
<span style="color:#080;font-weight:bold">func</span> algTwo(data []<span style="color:#0a8;font-weight:bold">byte</span>, find []<span style="color:#0a8;font-weight:bold">byte</span>, repl []<span style="color:#0a8;font-weight:bold">byte</span>, output *bytes.Buffer) {

        <span style="color:#777">// Use the bytes Reader to provide a stream to process.</span>
        input := bytes.NewReader(data)

        <span style="color:#777">// The number of bytes we are looking for.</span>
        size := <span style="color:#369;font-weight:bold">len</span>(find)

        <span style="color:#777">// Create an index variable to match bytes.</span>
        idx := <span style="color:#00D">0</span>

        <span style="color:#080;font-weight:bold">for</span> {

                <span style="color:#777">// Read a single byte from our input.</span>
                b, err := input.ReadByte()
                <span style="color:#080;font-weight:bold">if</span> err != <span style="color:#069">nil</span> {
                        <span style="color:#080;font-weight:bold">break</span>
                }

                <span style="color:#777">// Does this byte match the byte at this offset?</span>
                <span style="color:#080;font-weight:bold">if</span> b == find[idx] {

                        <span style="color:#777">// It matches so increment the index position.</span>
                        idx++

                        <span style="color:#777">// If every byte has been matched, write</span>
                        <span style="color:#777">// out the replacement.</span>
                        <span style="color:#080;font-weight:bold">if</span> idx == size {
                                output.Write(repl)
                                idx = <span style="color:#00D">0</span>
                        }

                        <span style="color:#080;font-weight:bold">continue</span>
                }

                <span style="color:#777">// Did we have any sort of match on any given byte?</span>
                <span style="color:#080;font-weight:bold">if</span> idx != <span style="color:#00D">0</span> {

                        <span style="color:#777">// Write what we've matched up to this point.</span>
                        output.Write(find[:idx])

                        <span style="color:#777">// Unread the unmatched byte so it can be processed again.</span>
                        input.UnreadByte()

                        <span style="color:#777">// Reset the offset to start matching from the beginning.</span>
                        idx = <span style="color:#00D">0</span>

                        <span style="color:#080;font-weight:bold">continue</span>
                }

                <span style="color:#777">// There was no previous match. Write byte and reset.</span>
                output.WriteByte(b)
                idx = <span style="color:#00D">0</span>
        }
}</code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/profiling/memcpu/stream_test.go-0">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="go"><span style="color:#777">// All material is licensed under the Apache License Version 2.0, January 2004</span>
<span style="color:#777">// http://www.apache.org/licenses/LICENSE-2.0</span>

<span style="color:#777">// go test -bench . -benchmem -memprofile p.out -gcflags &quot;-newescape=false -m=2&quot;</span>

<span style="color:#777">// Tests to see how each algorithm compare.</span>
<span style="color:#080;font-weight:bold">package</span> main

<span style="color:#080;font-weight:bold">import</span> (
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bytes</span><span style="color:#710">&quot;</span></span>
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testing</span><span style="color:#710">&quot;</span></span>
)

<span style="color:#080;font-weight:bold">var</span> output bytes.Buffer
<span style="color:#080;font-weight:bold">var</span> in = assembleInputStream()
<span style="color:#080;font-weight:bold">var</span> find = []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">elvis</span><span style="color:#710">&quot;</span></span>)
<span style="color:#080;font-weight:bold">var</span> repl = []<span style="color:#0a8;font-weight:bold">byte</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Elvis</span><span style="color:#710">&quot;</span></span>)

<span style="color:#777">// Capture the time it takes to execute algorithm one.</span>
<span style="color:#080;font-weight:bold">func</span> BenchmarkAlgorithmOne(b *testing.B) {
        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; b.N; i++ {
                output.Reset()
                algOne(in, find, repl, &amp;output)
        }
}

<span style="color:#777">// Capture the time it takes to execute algorithm two.</span>
<span style="color:#080;font-weight:bold">func</span> BenchmarkAlgorithmTwo(b *testing.B) {
        <span style="color:#080;font-weight:bold">for</span> i := <span style="color:#00D">0</span>; i &lt; b.N; i++ {
                output.Reset()
                algTwo(in, find, repl, &amp;output)
        }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7063">
<div class="title">to generate memory profile</div>
<p><span class="image"><img src="image/527.jpeg" alt="527"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7066">
<div class="title">step-how to use it</div>
<p><span class="image"><img src="image/528.jpeg" alt="528"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7069">
<div class="title">unfortunenatelly it doesnt tell why</div>
<p><span class="image"><img src="image/529.jpeg" alt="529"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7072">
<div class="title">to know why we do this,  after that repeat on step-how to use it</div>
<p><span class="image"><img src="image/531.jpeg" alt="531"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7076">
<p><strong>For Check CPU Profil</strong>
<span class="image"><img src="image/534.jpeg" alt="534"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7079">
<p><span class="image"><img src="image/535.jpeg" alt="535"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7082">
<div class="title">to speed up must change this line of code</div>
<p><span class="image"><img src="image/536.jpeg" alt="536"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7085">
<div class="title">show cpu profile at ui</div>
<p><span class="image"><img src="image/537.jpeg" alt="537"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7087">
<p><span class="image"><img src="image/538.jpeg" alt="538"></span></p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7090">
<h3 id="_macro_level_optimization_godebug_tracing">25.5. Macro Level Optimization : GODEBUG Tracing</h3>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7092">
<p>Refer to code inside profiling/project/</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7094">
<p>this is web ready application for search feeds</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7096">
<div class="content">
<pre>localhost:5000/search</pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7098">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7098">
<p>We wanna make sure this is healthy and there is no go routine leak</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7100">
<p>we can do that using GODEBUG</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7102">
<div class="content">
<pre>tell go to generate scheduler trace on every 1 seconds.
normally anything write to stdout kindly disappear, so in order to have the godebug stdout to stand ever</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7105">
<div class="content">
<pre>we use stdout &gt; /dev/null // stdout to null device</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7107">
<div class="content">
<pre>cd /Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/profiling/project</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7109">
<div class="content">
<pre>go build .</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7111">
<div class="content">
<pre>GODEBUG=schedtrace=1000 ./project &gt; /dev/null</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7114">
<p><span class="image"><img src="image/539.jpeg" alt="539"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7116">
<p><span class="image"><img src="image/540.jpeg" alt="540"></span></p>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7119">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7119">
<p>You can see every second we get the scheduling trace.</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7121">
<p>this all is going to show, go routine is executing or in  runable state , go routine that in waiting disappear</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7123">
<div class="content">
<pre>SCHED 277649ms: gomaxprocs=4 idleprocs=4 threads=10 spinningthreads=0 idlethreads=4 runqueue=0 [0 0 0 0]</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7125">
<p>4 core machine</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7127">
<p>number of core is 4</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7128">
<p>number of core iddle is 4</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7129">
<p>numberof thread we have</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7130">
<p>spinning thread for stielling work</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7131">
<p>global run que</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7132">
<p>in the array is local run que per p, we have 4 core so is 4 p</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7134">
<p>now we put some load into the system</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7136">
<p>install hey</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7138">
<div class="content">
<pre>go get -u github.com/rakyll/hey</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7140">
<p>then</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7142">
<p>using hey to make a call over 100 concurrent connection, in million times</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7144">
<div class="content">
<pre>hey -m POST -c 100 -n 1000000 "http://localhost:5000/search?term=trump&amp;cnn=on&amp;bbc=on&amp;nyt=on"</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7147">
<p><span class="image"><img src="image/541.jpeg" alt="541"></span></p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7149">
<div class="content">
<pre>SCHED 1060225ms: gomaxprocs=4 idleprocs=0 threads=15 spinningthreads=0 idlethreads=6 runqueue=58 [3 5 13 18]</pre>
</div>
</div>
<div class="ulist has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7151">
<ul>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7151">
<p>we can see all proc now is not idle</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7152">
<p>nothing spining , so all busy</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7153">
<p>we have 58 thread in the global runque</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7154">
<p>[3 5 13 18] distribution go routine in the runable state</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7156">
<p>if you have go routine leaking, you will see global run que and local run que growth more and more</p>
</li>
</ul>
</div>
<div class="sect3 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7159">
<h4 id="_get_the_gc_trace_garbage_collection_trace">25.5.1. GET the GC Trace, garbage collection trace</h4>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7161">
<div class="content">
<pre>GODEBUG=gctrace=1 ./project &gt; /dev/null</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7163">
<p>then open browser and search</p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7165">
<p><span class="image"><img src="image/542.jpeg" alt="542"></span></p>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7167">
<p><span class="image"><img src="image/543.jpeg" alt="543"></span></p>
</div>
<div class="olist arabic has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7169">
<ol class="arabic">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7169">
<p>we can see have 3 gc happen</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7171">
<p>@2.826s how many we are in the trace happen</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7173">
<p>0%: how many cpu / what percent of cpu that gc to get to use to run down, 0% is very2 fast</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7175">
<p>0.020+1.4+0.031 ms clock, world clock , it show 3 aspect of the gc
0.020+1.4 start world time, 0.031 the clean up , this might happen more than 100 microsecond when it growing into the heap
but overral should more than 100 microsecond</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7179">
<p>4&#8594;4&#8594;0 MB heap information , if you think have memory leak this is the place you can go
4&#8594; size before gc
4&#8594; size after gc
0 MB is the live heap</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7184">
<p>5 MB goal, fgoal for next run</p>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7186">
<p>4 P logical processor we have</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7189">
<p>Try put some load</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7191">
<div class="content">
<pre>hey -m POST -c 100 -n 10000 "http://localhost:5000/search?term=trump&amp;cnn=on&amp;bbc=on&amp;nyt=on"</pre>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7193">
<h3 id="_macro_level_optimize_memory_performance">25.6. Macro Level Optimize memory performance</h3>

</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7206">
<h2 id="_benchmarking_go">26. Benchmarking Go</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7208">
<p>Using go test tool to run benchmarking</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7210">
<div class="content">
<pre>// will tell none, can be regex,  mean we dont want to test any  function</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7212">
<div class="content">
<pre>// instead, we want becnhmarking the whole code. increase benchtime to 3s</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7214">
<div class="content">
<pre>cd /Users/jonny/go/go_code_from_book/gotraining/topics/go/testing/benchmarks/caching</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7216">
<div class="content">
<pre>go test -run none -bench . -benchtime 3s</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7219">
<div class="content">
<pre>Elements in the link list 16777216
Elements in the matrix 16777216
goos: darwin
goarch: amd64
pkg: github.com/ardanlabs/gotraining/topics/go/testing/benchmarks/caching
cpu: Intel(R) Core(TM) i5-5350U CPU @ 1.80GHz
BenchmarkLinkListTraverse-4   	     100	  33565728 ns/op
BenchmarkColumnTraverse-4     	      15	 219004728 ns/op
BenchmarkRowTraverse-4        	     184	  21249353 ns/op
PASS
ok  	github.com/ardanlabs/gotraining/topics/go/testing/benchmarks/caching	20.453s</pre>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7231">
<h2 id="_go_tutorial">27. GO Tutorial</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7233">
<p><a href="https://github.com/ardanlabs/gotraining" class="bare">https://github.com/ardanlabs/gotraining</a></p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7255">
<h2 id="_linux_less_command">28. LINUX LESS COMMAND</h2>
<div class="sectionbody">
<div class="olist arabic has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7257">
<ol class="arabic">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7257">
<p>Less Command – Search Navigation
Once you’ve opened a log file (or any file) using less file-name, use the following keys to search. Please note that the match will be highlighted automatically by default.</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7260">
<div class="content">
<pre>Forward Search
/ – search for a pattern which will take you to the next occurrence.
n – for next match in forward
N – for previous match in backward</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7265">
<div class="content">
<pre>Backward Search
? – search for a pattern which will take you to the previous occurrence.
n – for next match in backward direction
N – for previous match in forward direction</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7270">
<p>Tip: If you dont bother about which direction the search is happening, and you want to search file path, or URL, such as “/home/ramesh/”, you can use backward search (?pattern) which will be handy as you don’t want to escape slashes each time.</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7272">
<div class="content">
<pre>Search Path
In forward: /\/home\/ramesh\/
In backward: ?/home/ramesh/</pre>
</div>
</div>
<div class="olist arabic has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7276">
<ol class="arabic">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7276">
<p>Less Command – Screen Navigation
Use the following screen navigation commands while viewing large log files.</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7279">
<div class="content">
<pre>CTRL+F – forward one window
CTRL+B – backward one window
CTRL+D – forward half window
CTRL+U – backward half window</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7284">
<p>Less Command – Line navigation
In a smaller chunk of data, where you want to locate particular error, you may want to navigate line by line using these keys:</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7287">
<div class="content">
<pre>j – navigate forward by one line
k – navigate backward by one line</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7290">
<p>Less Command – Other Navigations</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7292">
<div class="content">
<pre>G – go to the end of file
g – go to the start of file
q or ZZ – exit the less pager</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7296">
<p>Simulate tail -f inside less pager – Press F</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7298">
<div class="content">
<pre>Once you’ve opened a file using less command, any content that is appended to the file after that will not be displayed automatically. However, you can press F less command will show the status ‘waiting for data‘. This is as similar to ‘tail -f’.</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7300">
<p>Less Command – Count magic</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7302">
<p>Similar to Vim editor navigation command, you can give 10j to scroll 10 lines down, or 10k to go up by 10 lines.</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7304">
<div class="content">
<pre>10j – 10 lines forward.
10k – 10 lines backward.
CTRL+G – show the current file name along with line, byte and percentage statistics.</pre>
</div>
</div>
<div class="olist arabic has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7308">
<ol class="arabic">
<li class="has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7308">
<p>Other useful Less Command Operations</p>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7310">
<div class="content">
<pre>v – using the configured editor edit the current file.
h – summary of less commands
&amp;pattern – display only the matching lines, not all.</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7315">
<p>Navigation across files: When you opened more than two files ( for e.g – less * ), use the following keys to navigate between files.</p>
</div>
<div class="literalblock has-source-line data-line-/Users/jonny/go/code/src/github.com/jonnyGit81/gofirstapp/document/golang.adoc-7317">
<div class="content">
<pre>:n – go to the next file.
:p – go to the previous file.</pre>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
 2021-07-25 15:06:22 +0700
</div>
</div>
</body>
</html>